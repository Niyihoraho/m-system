(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,10133,e=>{"use strict";e.s(["default",()=>G],10133);var t=e.i(43476),a=e.i(71645),s=e.i(81949),r=e.i(55436),l=e.i(16715),n=e.i(7233),i=e.i(87316),d=e.i(61911),c=e.i(69638);let o=(0,e.i(75254).default)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);var m=e.i(40160),u=e.i(63209),x=e.i(55749),h=e.i(60313),p=e.i(9956),g=e.i(89737),j=e.i(1968),v=e.i(46897),f=e.i(7486),b=e.i(32095);function S(e){let{onScopeChange:s}=e,[r,l]=a.useState([]),[n,i]=a.useState([]),[c,o]=a.useState([]),[m,u]=a.useState([]),[x,h]=a.useState(""),[S,N]=a.useState(""),[y,w]=a.useState(""),[C,I]=a.useState("");a.useEffect(()=>{F()},[]),a.useEffect(()=>{x?(k(Number(x)),A(Number(x))):(i([]),u([]),N(""),I(""))},[x]),a.useEffect(()=>{S?E(Number(S)):(o([]),w(""))},[S]),a.useEffect(()=>{s({regionId:x,universityId:S,smallGroupId:y,alumniGroupId:C})},[x,S,y,C,s]);let F=async()=>{try{let e=await fetch("/api/regions"),t=await e.json();l(t)}catch(e){console.error("Error fetching regions:",e)}},k=async e=>{try{let t=await fetch("/api/universities?regionId=".concat(e)),a=await t.json();i(a)}catch(e){console.error("Error fetching universities:",e)}},E=async e=>{try{let t=await fetch("/api/small-groups?universityId=".concat(e)),a=await t.json();o(a)}catch(e){console.error("Error fetching small groups:",e)}},A=async e=>{try{let t=await fetch("/api/alumni-small-groups?regionId=".concat(e)),a=await t.json();u(a)}catch(e){console.error("Error fetching alumni groups:",e)}};return(0,t.jsxs)(p.Card,{className:"mb-6",children:[(0,t.jsx)(p.CardHeader,{className:"pb-4",children:(0,t.jsx)(p.CardTitle,{className:"text-lg font-semibold text-foreground",children:"Super Admin Scope Selection"})}),(0,t.jsx)(p.CardContent,{children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(j.Label,{htmlFor:"region",className:"text-sm font-medium flex items-center gap-2",children:[(0,t.jsx)(v.MapPin,{className:"h-4 w-4"}),"Filter by Region"]}),(0,t.jsxs)(g.Select,{value:x,onValueChange:e=>{h(e),N(""),w(""),I("")},children:[(0,t.jsx)(g.SelectTrigger,{className:"h-11",children:(0,t.jsx)(g.SelectValue,{placeholder:"Select region"})}),(0,t.jsx)(g.SelectContent,{children:r.map(e=>(0,t.jsx)(g.SelectItem,{value:e.id.toString(),children:e.name},e.id))})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(j.Label,{htmlFor:"university",className:"text-sm font-medium flex items-center gap-2",children:[(0,t.jsx)(f.Building2,{className:"h-4 w-4"}),"Filter by University"]}),(0,t.jsxs)(g.Select,{value:S,onValueChange:e=>{N(e),w("")},disabled:!x,children:[(0,t.jsx)(g.SelectTrigger,{className:"h-11",children:(0,t.jsx)(g.SelectValue,{placeholder:x?"Select university":"Select region first"})}),(0,t.jsx)(g.SelectContent,{children:n.map(e=>(0,t.jsx)(g.SelectItem,{value:e.id.toString(),children:e.name},e.id))})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(j.Label,{htmlFor:"smallGroup",className:"text-sm font-medium flex items-center gap-2",children:[(0,t.jsx)(d.Users,{className:"h-4 w-4"}),"Filter by Small Group"]}),(0,t.jsxs)(g.Select,{value:y,onValueChange:e=>{w(e)},disabled:!S,children:[(0,t.jsx)(g.SelectTrigger,{className:"h-11",children:(0,t.jsx)(g.SelectValue,{placeholder:S?"Select small group":"Select university first"})}),(0,t.jsx)(g.SelectContent,{children:c.map(e=>(0,t.jsx)(g.SelectItem,{value:e.id.toString(),children:e.name},e.id))})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(j.Label,{htmlFor:"alumniGroup",className:"text-sm font-medium flex items-center gap-2",children:[(0,t.jsx)(b.GraduationCap,{className:"h-4 w-4"}),"Filter by Alumni Group"]}),(0,t.jsxs)(g.Select,{value:C,onValueChange:e=>{I(e)},disabled:!x,children:[(0,t.jsx)(g.SelectTrigger,{className:"h-11",children:(0,t.jsx)(g.SelectValue,{placeholder:x?"Select alumni group":"Select region first"})}),(0,t.jsx)(g.SelectContent,{children:m.map(e=>(0,t.jsx)(g.SelectItem,{value:e.id.toString(),children:e.name},e.id))})]})]})]})})]})}var N=e.i(70665),y=e.i(75117),w=e.i(69035),C=e.i(11522),I=e.i(70065),F=e.i(23750),k=e.i(10708),E=e.i(62870),A=e.i(67881),T=e.i(63415);function G(){let[e,p]=(0,a.useState)("mark"),{userScope:g,loading:j,getDefaultValues:v}=(0,N.useUserScope)(),[f,b]=(0,a.useState)(""),[G,L]=(0,a.useState)(""),[B,R]=(0,a.useState)(""),[D,V]=(0,a.useState)(""),[M,z]=(0,a.useState)(""),[P,U]=(0,a.useState)([]),[O,H]=(0,a.useState)([]),[K,W]=(0,a.useState)({}),[q,J]=(0,a.useState)(!1),[Q,X]=(0,a.useState)(null),[Y,Z]=(0,a.useState)(null),[$,_]=(0,a.useState)(null),[ee,et]=(0,a.useState)([]),[ea,es]=(0,a.useState)(!0),[er,el]=(0,a.useState)(null),[en,ei]=(0,a.useState)(""),[ed,ec]=(0,a.useState)(""),[eo,em]=(0,a.useState)(""),[eu,ex]=(0,a.useState)(""),[eh,ep]=(0,a.useState)(""),[eg,ej]=(0,a.useState)(null),[ev,ef]=(0,a.useState)(""),[eb,eS]=(0,a.useState)(null),[eN,ey]=(0,a.useState)(null),[ew,eC]=(0,a.useState)(!1),[eI,eF]=(0,a.useState)(!1),[ek,eE]=(0,a.useState)([]),[eA,eT]=(0,a.useState)([]),[eG,eL]=(0,a.useState)([]),[eB,eR]=(0,a.useState)([]),[eD,eV]=(0,a.useState)(""),[eM,ez]=(0,a.useState)(""),[eP,eU]=(0,a.useState)(""),[eO,eH]=(0,a.useState)(""),eK=[{value:"present",label:"Present"},{value:"absent",label:"Absent"},{value:"excused",label:"Excused"}];(0,a.useEffect)(()=>{if(g&&!j){let e=v();b(e.regionId||""),L(e.universityId||""),R(e.smallGroupId||""),V(e.alumniGroupId||"")}},[g,j,v]),(0,a.useEffect)(()=>{j||eW()},[j,f,G,B,D,eW]),(0,a.useEffect)(()=>{eq()},[]),(0,a.useEffect)(()=>{eD?(eJ(Number(eD)),eX(Number(eD))):(eT([]),eR([]),ez(""),eH(""))},[eD]),(0,a.useEffect)(()=>{eM?eQ(Number(eM)):(eL([]),eU(""))},[eM]),(0,a.useEffect)(()=>{M?eY():(H([]),W({}))},[M,f,G,B,D,eY]),(0,a.useEffect)(()=>{"view"===e&&eZ()},[e,ed,eo,eu,eh,f,G,B,D,eD,eM,eP,eO,eZ]);let eW=async()=>{try{let e="/api/events",t=new URLSearchParams;f&&t.append("regionId",f),G&&t.append("universityId",G),B&&t.append("smallGroupId",B),D&&t.append("alumniGroupId",D),t.toString()&&(e+="?"+t.toString());let a=await s.default.get(e);U(a.data)}catch(e){console.error("Error fetching events:",e)}},eq=async()=>{try{let e=await s.default.get("/api/regions");eE(e.data)}catch(e){console.error("Error fetching regions:",e)}},eJ=async e=>{try{let t=await s.default.get("/api/universities?regionId=".concat(e));eT(t.data)}catch(e){console.error("Error fetching universities:",e)}},eQ=async e=>{try{let t=await s.default.get("/api/small-groups?universityId=".concat(e));eL(t.data)}catch(e){console.error("Error fetching small groups:",e)}},eX=async e=>{try{let t=await s.default.get("/api/alumni-small-groups?regionId=".concat(e));eR(t.data)}catch(e){console.error("Error fetching alumni groups:",e)}},eY=async()=>{J(!0),H([]),W({}),X(null);try{let e="/api/members",t=new URLSearchParams;B?t.append("smallGroupId",B):D?t.append("alumniGroupId",D):G?t.append("universityId",G):f&&t.append("regionId",f),t.toString()&&(e+="?"+t.toString());let a=await s.default.get(e),r=a.data.members||a.data;if(Array.isArray(r)){H(r);let e={};r.forEach(t=>{e[t.id]="present"}),W(e)}}catch(e){console.error("Error fetching members:",e),X("Failed to load members")}finally{J(!1)}},eZ=async()=>{try{es(!0),el(null);let e=new URLSearchParams;ed&&e.append("eventId",ed),eo&&e.append("status",eo),eu&&e.append("dateFrom",eu),eh&&e.append("dateTo",eh),eD&&e.append("regionId",eD),eM&&e.append("universityId",eM),eP&&e.append("smallGroupId",eP),eO&&e.append("alumniGroupId",eO),f&&e.append("regionId",f),G&&e.append("universityId",G),B&&e.append("smallGroupId",B),D&&e.append("alumniGroupId",D);let t=await s.default.get("/api/attendance?".concat(e.toString()));et(t.data)}catch(e){console.error("Error fetching attendance records:",e),el("Failed to fetch attendance records. Please try again.")}finally{es(!1)}},e$=async e=>{if(e.preventDefault(),Z(null),_(null),!M)return void _("Please select an event to mark attendance for.");if(0===O.length)return void _("No members found for the selected criteria.");let t=O.map(e=>({memberId:e.id,status:K[e.id]||"present",permanentEventId:parseInt(M)}));try{var a,r,l,n,i;let e=await s.default.post("/api/attendance",t);if(201===e.status&&(null==(a=e.data.results)?void 0:a.every(e=>e.success))){let e=(null==(r=P.find(e=>e.id.toString()===M))?void 0:r.name)||"the selected event",t=O.length;Z("Attendance for ".concat(t,' member(s) at "').concat(e,'" has been saved successfully!')),_(null),W({}),H([]),z("")}else{let t=(null==(i=e.data.results)||null==(n=i.filter(e=>!e.success))||null==(l=n.map(e=>"object"==typeof e.error?Object.values(e.error).flat().join(", "):e.error))?void 0:l.join(", "))||"Some attendance records could not be saved.";_(t)}}catch(e){_("Failed to save attendance. "+(e.message||""))}},e_=()=>{ej(null),ef(""),eS(null),ey(null)},e0=async e=>{eS(null),ey(null);try{let t=await s.default.put("/api/attendance?id=".concat(e.id),{status:ev});200===t.status?(eS("Attendance updated successfully!"),ej(null),ef(""),eZ()):ey(t.data.error||"Failed to update attendance.")}catch(e){ey("Failed to update attendance. "+(e.message||""))}},e1=(0,a.useMemo)(()=>{if(!en)return ee;let e=en.toLowerCase();return ee.filter(t=>{var a,s,r,l,n,i,d,c,o,m,u,x;return null!=(o=null==(s=t.member)||null==(a=s.firstname)?void 0:a.toLowerCase().includes(e))&&o||null!=(m=null==(l=t.member)||null==(r=l.secondname)?void 0:r.toLowerCase().includes(e))&&m||null!=(u=null==(i=t.permanentministryevent)||null==(n=i.name)?void 0:n.toLowerCase().includes(e))&&u||null!=(x=null==(c=t.trainings)||null==(d=c.name)?void 0:d.toLowerCase().includes(e))&&x})},[ee,en]),e2=(0,a.useMemo)(()=>e1.length?e1.reduce((e,t)=>(e.total++,"present"===t.status?e.present++:"absent"===t.status?e.absent++:"excused"===t.status&&e.excused++,e),{total:0,present:0,absent:0,excused:0}):{total:0,present:0,absent:0,excused:0},[e1]),e4=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all";try{let t=new URLSearchParams;return ed&&t.append("eventId",ed),eu&&t.append("dateFrom",eu),eh&&t.append("dateTo",eh),f&&t.append("regionId",f),G&&t.append("universityId",G),B&&t.append("smallGroupId",B),D&&t.append("alumniGroupId",D),eD&&t.append("regionId",eD),eM&&t.append("universityId",eM),eP&&t.append("smallGroupId",eP),eO&&t.append("alumniGroupId",eO),"all"!==e&&t.append("status",e),(await s.default.get("/api/attendance/export-details?".concat(t.toString()))).data}catch(e){throw console.error("Error fetching attendance export details:",e),e}},e5=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all";eC(!0);try{let{attendanceDetails:t,totalCount:a,appliedFilters:s}=await e4(e),r=new x.default("p","mm","a4"),l=r.internal.pageSize.getWidth(),n=r.internal.pageSize.getHeight();if(r.setFontSize(20),r.setFont("helvetica","bold"),r.text("Ministry Management System",l/2,20,{align:"center"}),r.setFontSize(16),r.setFont("helvetica","normal"),r.text("Attendance Records Report",l/2,30,{align:"center"}),r.setFontSize(10),r.text("Generated on: ".concat(new Date().toLocaleDateString()),20,45),r.text("Total Records: ".concat(a),20,50),"all"!==e&&r.text("Status Filter: ".concat(e.charAt(0).toUpperCase()+e.slice(1)),20,55),s.dateFrom||s.dateTo){let t="".concat(s.dateFrom||"Start"," to ").concat(s.dateTo||"End");r.text("Date Range: ".concat(t),20,"all"!==e?60:55)}if(t.length>0){let e=t.reduce((e,t)=>(e.total++,"present"===t.attendanceStatus?e.present++:"absent"===t.attendanceStatus?e.absent++:"excused"===t.attendanceStatus&&e.excused++,e),{total:0,present:0,absent:0,excused:0}),a=s.dateFrom||s.dateTo?70:65;if(r.setFontSize(12),r.setFont("helvetica","bold"),r.text("Summary Statistics",20,a),r.setFontSize(10),r.setFont("helvetica","normal"),r.text("Total Records: ".concat(e.total),20,a+8),r.text("Present: ".concat(e.present),20,a+13),r.text("Absent: ".concat(e.absent),20,a+18),r.text("Excused: ".concat(e.excused),20,a+23),e.total>0){let t=Math.round(e.present/e.total*100);r.text("Attendance Rate: ".concat(t,"%"),20,a+28)}}if(t.length>0){let e=s.dateFrom||s.dateTo?110:100;r.setFontSize(10),r.setFont("helvetica","bold"),r.text("Member Name",20,e),r.text("Event",60,e),r.text("Status",100,e),r.text("Date",130,e),r.text("Region",160,e),r.line(20,e+2,190,e+2),e+=8,r.setFont("helvetica","normal"),r.setFontSize(8),t.forEach((t,a)=>{e>n-20&&(r.addPage(),e=20);let s=t.memberName.length>25?t.memberName.substring(0,22)+"...":t.memberName,l=t.eventName.length>20?t.eventName.substring(0,17)+"...":t.eventName,i=t.region.length>15?t.region.substring(0,12)+"...":t.region;r.text(s,20,e),r.text(l,60,e),r.text(t.attendanceStatus.charAt(0).toUpperCase()+t.attendanceStatus.slice(1),100,e),r.text(new Date(t.recordedAt).toLocaleDateString(),130,e),r.text(i,160,e),e+=5})}else r.setFontSize(12),r.setFont("helvetica","normal"),r.text("No attendance records found for the selected criteria.",20,80);let i="attendance-records-".concat(e,"-").concat(new Date().toISOString().split("T")[0],".pdf");r.save(i)}catch(e){console.error("Error exporting attendance records:",e),alert("Failed to export attendance records. Please try again.")}finally{eC(!1),eF(!1)}};return(0,t.jsxs)(C.SidebarProvider,{children:[(0,t.jsx)(h.AppSidebar,{}),(0,t.jsxs)(C.SidebarInset,{children:[(0,t.jsx)("header",{className:"flex h-16 shrink-0 items-center gap-2 transition-[width,height] ease-linear group-has-data-[collapsible=icon]/sidebar-wrapper:h-12",children:(0,t.jsxs)("div",{className:"flex items-center gap-2 px-4",children:[(0,t.jsx)(C.SidebarTrigger,{className:"-ml-1"}),(0,t.jsx)(w.Separator,{orientation:"vertical",className:"mr-2 data-[orientation=vertical]:h-4"}),(0,t.jsx)(y.Breadcrumb,{children:(0,t.jsxs)(y.BreadcrumbList,{children:[(0,t.jsx)(y.BreadcrumbItem,{className:"hidden md:block",children:(0,t.jsx)(y.BreadcrumbLink,{href:"/dashboard",children:"Dashboard"})}),(0,t.jsx)(y.BreadcrumbSeparator,{className:"hidden md:block"}),(0,t.jsx)(y.BreadcrumbItem,{children:(0,t.jsx)(y.BreadcrumbLink,{href:"/links/activities",children:"Activities"})}),(0,t.jsx)(y.BreadcrumbSeparator,{}),(0,t.jsx)(y.BreadcrumbItem,{children:(0,t.jsx)(y.BreadcrumbPage,{children:"Attendance Tracking"})})]})})]})}),(0,t.jsx)("div",{className:"flex flex-1 flex-col gap-4 p-2 sm:p-4 pt-0",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto w-full",children:[(0,t.jsxs)("div",{className:"mb-4 sm:mb-6 lg:mb-8",children:[(0,t.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-foreground mb-1 sm:mb-2",children:"Attendance Tracking"}),(0,t.jsx)("p",{className:"text-sm sm:text-base text-muted-foreground",children:"Manage attendance records and mark attendance for events"})]}),(0,t.jsxs)("div",{className:"flex gap-2 mb-6",children:[(0,t.jsxs)(A.Button,{variant:"mark"===e?"default":"outline",onClick:()=>p("mark"),className:"flex items-center gap-2",children:[(0,t.jsx)(n.Plus,{className:"w-4 h-4"}),"Mark Attendance"]}),(0,t.jsxs)(A.Button,{variant:"view"===e?"default":"outline",onClick:()=>p("view"),className:"flex items-center gap-2",children:[(0,t.jsx)(i.Calendar,{className:"w-4 h-4"}),"View Attendance Records"]})]}),(null==g?void 0:g.scope)==="superadmin"&&(0,t.jsx)(S,{onScopeChange:e=>{b(e.regionId||""),L(e.universityId||""),R(e.smallGroupId||""),V(e.alumniGroupId||"")}}),g&&"superadmin"!==g.scope&&!j&&(0,t.jsx)(I.Card,{className:"mb-4",children:(0,t.jsx)(I.CardContent,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,t.jsx)("span",{children:"Current Scope:"}),(0,t.jsx)("span",{className:"font-medium text-foreground capitalize",children:g.scope}),g.region&&(0,t.jsxs)("span",{children:["• ",g.region.name]}),g.university&&(0,t.jsxs)("span",{children:["• ",g.university.name]}),g.smallGroup&&(0,t.jsxs)("span",{children:["• ",g.smallGroup.name]}),g.alumniGroup&&(0,t.jsxs)("span",{children:["• ",g.alumniGroup.name]})]})})}),j&&(0,t.jsx)(I.Card,{className:"mb-4",children:(0,t.jsx)(I.CardContent,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground",children:[(0,t.jsx)(l.RefreshCw,{className:"w-4 h-4 animate-spin"}),(0,t.jsx)("span",{children:"Loading user scope..."})]})})}),"mark"===e&&!j&&(0,t.jsxs)(I.Card,{children:[(0,t.jsx)(I.CardHeader,{children:(0,t.jsxs)(I.CardTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(d.Users,{className:"w-5 h-5"}),"Mark Attendance"]})}),(0,t.jsx)(I.CardContent,{children:(0,t.jsxs)("form",{onSubmit:e$,className:"space-y-6",children:[(0,t.jsx)("div",{className:"flex flex-wrap gap-4 items-end mb-4",children:(0,t.jsxs)("div",{className:"flex-1 min-w-[180px]",children:[(0,t.jsx)(k.Label,{htmlFor:"eventId",children:"Event *"}),(0,t.jsxs)(E.Select,{value:M,onValueChange:z,children:[(0,t.jsx)(E.SelectTrigger,{className:"h-11",children:(0,t.jsx)(E.SelectValue,{placeholder:"Select event"})}),(0,t.jsx)(E.SelectContent,{children:P.map(e=>(0,t.jsx)(E.SelectItem,{value:e.id.toString(),children:e.name},e.id))})]})]})}),Y&&(0,t.jsx)("div",{className:"mb-4 p-4 bg-green-50 border border-green-200 rounded-lg",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(c.CheckCircle,{className:"h-5 w-5 text-green-400 mr-3"}),(0,t.jsx)("p",{className:"text-sm font-medium text-green-800",children:Y})]}),(0,t.jsx)(A.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>{Z(null),z("")},children:"Mark Another Attendance"})]})}),$&&(0,t.jsx)("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(o,{className:"h-5 w-5 text-red-400 mr-3"}),(0,t.jsx)("p",{className:"text-sm font-medium text-red-800",children:$})]})}),q?(0,t.jsxs)("div",{className:"mt-8 p-4 bg-muted/50 border rounded text-muted-foreground text-center",children:[(0,t.jsx)(l.RefreshCw,{className:"w-4 h-4 animate-spin mx-auto mb-2"}),"Loading members..."]}):O.length>0?(0,t.jsxs)("div",{className:"overflow-x-auto mt-8",children:[(0,t.jsxs)("table",{className:"min-w-full divide-y divide-border",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-muted-foreground uppercase",children:"Member"}),(0,t.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-muted-foreground uppercase",children:"Attendance"})]})}),(0,t.jsx)("tbody",{className:"divide-y divide-border",children:O.map(e=>(0,t.jsxs)("tr",{children:[(0,t.jsxs)("td",{className:"px-4 py-2 text-foreground",children:[e.firstname," ",e.secondname]}),(0,t.jsx)("td",{className:"px-4 py-2",children:(0,t.jsx)("div",{className:"flex gap-2",children:eK.map(a=>(0,t.jsx)(A.Button,{type:"button",variant:K[e.id]===a.value?"default":"outline",size:"sm",className:"px-3 py-1 text-xs transition ".concat(K[e.id]===a.value?"present"===a.value?"bg-green-500 hover:bg-green-600 text-white":"excused"===a.value?"bg-yellow-500 hover:bg-yellow-600 text-white":"bg-red-500 hover:bg-red-600 text-white":"present"===a.value?"border-green-400 text-green-700 hover:bg-green-50":"excused"===a.value?"border-yellow-400 text-yellow-700 hover:bg-yellow-50":"border-red-400 text-red-700 hover:bg-red-50"),onClick:()=>{var t,s;return t=e.id.toString(),s=a.value,void W(e=>({...e,[t]:s}))},children:a.label},a.value))})})]},e.id))})]}),(0,t.jsx)("div",{className:"mt-6 text-right",children:(0,t.jsx)(A.Button,{type:"submit",className:"px-6 py-2",children:"Save Attendance"})})]}):M?(0,t.jsx)("div",{className:"mt-8 p-4 bg-muted/50 border rounded text-muted-foreground text-center",children:"No members found for the selected criteria."}):(0,t.jsx)("div",{className:"mt-8 p-4 bg-blue-50 border border-blue-200 rounded text-blue-600 text-center",children:"Please select an event to mark attendance for."})]})})]}),"view"===e&&!j&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)(I.Card,{children:(0,t.jsx)(I.CardContent,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex flex-wrap gap-4 items-end",children:[(0,t.jsxs)("div",{className:"min-w-[180px]",children:[(0,t.jsx)(k.Label,{htmlFor:"eventFilter",children:"Event"}),(0,t.jsxs)(E.Select,{value:ed,onValueChange:ec,children:[(0,t.jsx)(E.SelectTrigger,{className:"h-11",children:(0,t.jsx)(E.SelectValue,{placeholder:"All Events"})}),(0,t.jsx)(E.SelectContent,{children:P.map(e=>(0,t.jsx)(E.SelectItem,{value:e.id.toString(),children:e.name},e.id))})]})]}),(0,t.jsxs)("div",{className:"min-w-[150px]",children:[(0,t.jsx)(k.Label,{htmlFor:"statusFilter",children:"Status"}),(0,t.jsxs)(E.Select,{value:eo,onValueChange:em,children:[(0,t.jsx)(E.SelectTrigger,{className:"h-11",children:(0,t.jsx)(E.SelectValue,{placeholder:"All Statuses"})}),(0,t.jsx)(E.SelectContent,{children:eK.map(e=>(0,t.jsx)(E.SelectItem,{value:e.value,children:e.label},e.value))})]})]}),(0,t.jsxs)("div",{className:"min-w-[150px]",children:[(0,t.jsx)(k.Label,{htmlFor:"dateFrom",children:"From Date"}),(0,t.jsx)(F.Input,{type:"date",value:eu,onChange:e=>ex(e.target.value),className:"h-11"})]}),(0,t.jsxs)("div",{className:"min-w-[150px]",children:[(0,t.jsx)(k.Label,{htmlFor:"dateTo",children:"To Date"}),(0,t.jsx)(F.Input,{type:"date",value:eh,onChange:e=>ep(e.target.value),className:"h-11"})]}),(null==g?void 0:g.scope)==="superadmin"&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"min-w-[180px]",children:[(0,t.jsx)(k.Label,{htmlFor:"regionFilter",children:"Region"}),(0,t.jsxs)(E.Select,{value:eD,onValueChange:e=>{eV(e),ez(""),eU(""),eH("")},children:[(0,t.jsx)(E.SelectTrigger,{className:"h-11",children:(0,t.jsx)(E.SelectValue,{placeholder:"All Regions"})}),(0,t.jsx)(E.SelectContent,{children:ek.map(e=>(0,t.jsx)(E.SelectItem,{value:e.id.toString(),children:e.name},e.id))})]})]}),(0,t.jsxs)("div",{className:"min-w-[180px]",children:[(0,t.jsx)(k.Label,{htmlFor:"universityFilter",children:"University"}),(0,t.jsxs)(E.Select,{value:eM,onValueChange:e=>{ez(e),eU("")},disabled:!eD,children:[(0,t.jsx)(E.SelectTrigger,{className:"h-11",children:(0,t.jsx)(E.SelectValue,{placeholder:eD?"All Universities":"Select region first"})}),(0,t.jsx)(E.SelectContent,{children:eA.map(e=>(0,t.jsx)(E.SelectItem,{value:e.id.toString(),children:e.name},e.id))})]})]}),(0,t.jsxs)("div",{className:"min-w-[180px]",children:[(0,t.jsx)(k.Label,{htmlFor:"smallGroupFilter",children:"Small Group"}),(0,t.jsxs)(E.Select,{value:eP,onValueChange:e=>{eU(e)},disabled:!eM,children:[(0,t.jsx)(E.SelectTrigger,{className:"h-11",children:(0,t.jsx)(E.SelectValue,{placeholder:eM?"All Small Groups":"Select university first"})}),(0,t.jsx)(E.SelectContent,{children:eG.map(e=>(0,t.jsx)(E.SelectItem,{value:e.id.toString(),children:e.name},e.id))})]})]}),(0,t.jsxs)("div",{className:"min-w-[180px]",children:[(0,t.jsx)(k.Label,{htmlFor:"alumniGroupFilter",children:"Alumni Group"}),(0,t.jsxs)(E.Select,{value:eO,onValueChange:e=>{eH(e)},disabled:!eD,children:[(0,t.jsx)(E.SelectTrigger,{className:"h-11",children:(0,t.jsx)(E.SelectValue,{placeholder:eD?"All Alumni Groups":"Select region first"})}),(0,t.jsx)(E.SelectContent,{children:eB.map(e=>(0,t.jsx)(E.SelectItem,{value:e.id.toString(),children:e.name},e.id))})]})]})]}),(0,t.jsxs)("div",{className:"flex-1 min-w-[200px]",children:[(0,t.jsx)(k.Label,{htmlFor:"search",children:"Search"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(r.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),(0,t.jsx)(F.Input,{type:"text",placeholder:"Search by member or event name...",value:en,onChange:e=>ei(e.target.value),className:"pl-10 h-11"})]})]}),(0,t.jsxs)("div",{className:"flex items-end gap-2",children:[(0,t.jsx)(A.Button,{type:"button",variant:"outline",onClick:()=>{ec(""),em(""),ex(""),ep(""),ei(""),eV(""),ez(""),eU(""),eH("")},className:"h-11",children:"Clear Filters"}),(0,t.jsxs)(T.DropdownMenu,{open:eI,onOpenChange:eF,children:[(0,t.jsx)(T.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsxs)(A.Button,{variant:"outline",className:"flex items-center gap-2 h-11",disabled:ew,children:[(0,t.jsx)(m.Download,{className:"w-4 h-4"}),ew?"Exporting...":"Export Document",(0,t.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),(0,t.jsxs)(T.DropdownMenuContent,{align:"end",className:"w-48",children:[(0,t.jsx)(T.DropdownMenuItem,{onClick:()=>e5("all"),children:"Export All Records"}),(0,t.jsx)(T.DropdownMenuItem,{onClick:()=>e5("present"),children:"Export Present Only"}),(0,t.jsx)(T.DropdownMenuItem,{onClick:()=>e5("absent"),children:"Export Absent Only"}),(0,t.jsx)(T.DropdownMenuItem,{onClick:()=>e5("excused"),children:"Export Excused Only"})]})]})]})]})})}),e1.length>0&&(0,t.jsx)(I.Card,{children:(0,t.jsx)(I.CardContent,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex flex-wrap gap-6 items-center",children:[(0,t.jsxs)("div",{className:"text-sm font-medium text-muted-foreground",children:["Total Records: ",(0,t.jsx)("span",{className:"font-bold text-foreground",children:e2.total})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),(0,t.jsxs)("span",{className:"text-sm text-muted-foreground",children:["Present: ",(0,t.jsx)("span",{className:"font-semibold text-green-600",children:e2.present})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),(0,t.jsxs)("span",{className:"text-sm text-muted-foreground",children:["Absent: ",(0,t.jsx)("span",{className:"font-semibold text-red-600",children:e2.absent})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-3 h-3 bg-yellow-500 rounded-full"}),(0,t.jsxs)("span",{className:"text-sm text-muted-foreground",children:["Excused: ",(0,t.jsx)("span",{className:"font-semibold text-yellow-600",children:e2.excused})]})]}),e2.total>0&&(0,t.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Attendance Rate: ",(0,t.jsxs)("span",{className:"font-semibold text-blue-600",children:[Math.round(e2.present/e2.total*100),"%"]})]})]})})}),(0,t.jsx)(I.Card,{children:(0,t.jsxs)(I.CardContent,{className:"p-0",children:[ea?(0,t.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,t.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground",children:[(0,t.jsx)(l.RefreshCw,{className:"w-4 h-4 animate-spin"}),(0,t.jsx)("span",{children:"Loading attendance records..."})]})}):er?(0,t.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(u.AlertCircle,{className:"w-8 h-8 text-destructive mx-auto mb-2"}),(0,t.jsx)("div",{className:"text-destructive text-lg mb-2",children:"Error loading attendance records"}),(0,t.jsx)("p",{className:"text-muted-foreground mb-4",children:er}),(0,t.jsx)(A.Button,{onClick:eZ,children:"Retry"})]})}):e1&&0!==e1.length?(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full",children:[(0,t.jsx)("thead",{className:"bg-muted/50 border-b border-border",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Member"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Event"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Status"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Date"})]})}),(0,t.jsx)("tbody",{className:"bg-card divide-y divide-border",children:e1.map(e=>{var a,s,r;return(0,t.jsxs)("tr",{className:"hover:bg-muted/50",children:[(0,t.jsx)("td",{className:"px-6 py-4 text-sm font-medium text-foreground",children:e.member?"".concat(e.member.firstname," ").concat(e.member.secondname):"N/A"}),(0,t.jsx)("td",{className:"px-6 py-4 text-sm text-muted-foreground",children:(null==(a=e.permanentministryevent)?void 0:a.name)||(null==(s=e.trainings)?void 0:s.name)||"N/A"}),(0,t.jsx)("td",{className:"px-6 py-4 text-sm",children:eg===e.id?(0,t.jsxs)("div",{className:"flex gap-2",children:[eK.map(e=>(0,t.jsx)(A.Button,{type:"button",variant:ev===e.value?"default":"outline",size:"sm",className:"px-3 py-1 text-xs ".concat(ev===e.value?"present"===e.value?"bg-green-500 hover:bg-green-600 text-white":"excused"===e.value?"bg-yellow-500 hover:bg-yellow-600 text-white":"bg-red-500 hover:bg-red-600 text-white":"present"===e.value?"border-green-400 text-green-700 hover:bg-green-50":"excused"===e.value?"border-yellow-400 text-yellow-700 hover:bg-yellow-50":"border-red-400 text-red-700 hover:bg-red-50"),onClick:()=>ef(e.value),children:e.label},e.value)),(0,t.jsx)(A.Button,{type:"button",size:"sm",onClick:()=>e0(e),className:"ml-2 px-3 py-1 bg-green-600 hover:bg-green-700 text-white text-xs",children:"Save"}),(0,t.jsx)(A.Button,{type:"button",variant:"outline",size:"sm",onClick:e_,className:"px-3 py-1 text-xs",children:"Cancel"})]}):(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-semibold ".concat("present"===e.status?"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400":"excused"===e.status?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-400":"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400"),children:e.status.charAt(0).toUpperCase()+e.status.slice(1)}),(0,t.jsx)(A.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>{ej(e.id),ef(e.status),eS(null),ey(null)},className:"px-2 py-1 text-xs",children:"Edit"})]})}),(0,t.jsx)("td",{className:"px-6 py-4 text-sm text-muted-foreground",children:(r=e.recordedAt)?new Date(r).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A"})]},e.id)})})]})}):(0,t.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(i.Calendar,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),(0,t.jsx)("div",{className:"text-muted-foreground text-lg mb-2",children:"No attendance records found"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:en?'No results for "'.concat(en,'". Try a different search term.'):"There are no attendance records to display at the moment."})]})}),eb&&(0,t.jsx)("div",{className:"p-4 bg-green-50 border-t border-green-200",children:(0,t.jsxs)("div",{className:"flex items-center text-green-800",children:[(0,t.jsx)(c.CheckCircle,{className:"w-4 h-4 mr-2"}),eb]})}),eN&&(0,t.jsx)("div",{className:"p-4 bg-red-50 border-t border-red-200",children:(0,t.jsxs)("div",{className:"flex items-center text-red-800",children:[(0,t.jsx)(o,{className:"w-4 h-4 mr-2"}),eN]})})]})})]})]})})]})]})}}]);