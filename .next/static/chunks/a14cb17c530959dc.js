(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,15868,e=>{"use strict";e.s(["default",()=>k],15868);var s=e.i(43476),t=e.i(71645),r=e.i(81949),l=e.i(55436),a=e.i(16715),i=e.i(7233),n=e.i(88511),d=e.i(27612),c=e.i(87316),o=e.i(60313),m=e.i(71850),u=e.i(9956),x=e.i(86882),h=e.i(1968),p=e.i(89737),g=e.i(22560),v=e.i(53300),j=e.i(46897),f=e.i(7486),y=e.i(61911),N=e.i(32095),b=e.i(21218),I=e.i(70665);function S(e){let{children:r,onEventAdded:l}=e,[a,n]=t.useState(!1),[d,o]=t.useState(!1),[S,w]=t.useState({}),[C,G]=t.useState(!1),{userScope:E,loading:A,getVisibleFields:T,getDefaultValues:k}=(0,I.useUserScope)(),L=T(),O=t.useMemo(()=>k(),[E]),[F,B]=t.useState([]),[V,U]=t.useState([]),[P,D]=t.useState([]),[R,M]=t.useState([]),[q,_]=t.useState({name:"",type:"",regionId:"",universityId:"",smallGroupId:"",alumniGroupId:"",isActive:!0});t.useEffect(()=>{E&&O&&_(e=>{var s,t,r,l;return{...e,regionId:(null==(s=O.regionId)?void 0:s.toString())||"",universityId:(null==(t=O.universityId)?void 0:t.toString())||"",smallGroupId:(null==(r=O.smallGroupId)?void 0:r.toString())||"",alumniGroupId:(null==(l=O.alumniGroupId)?void 0:l.toString())||""}})},[E,O]),t.useEffect(()=>{a&&L.region&&H()},[a,L.region]),t.useEffect(()=>{q.regionId&&L.university?z(Number(q.regionId)):(U([]),_(e=>({...e,universityId:""})))},[q.regionId,L.university]),t.useEffect(()=>{q.regionId&&L.alumniGroup?K(Number(q.regionId)):(M([]),_(e=>({...e,alumniGroupId:""})))},[q.regionId,L.alumniGroup]),t.useEffect(()=>{if(L.smallGroup){let e=(null==E?void 0:E.scope)==="university"?E.universityId:q.universityId;e?J(Number(e)):(D([]),_(e=>({...e,smallGroupId:""})))}},[q.universityId,L.smallGroup,E]);let H=async()=>{try{let e=await fetch("/api/regions"),s=await e.json();B(s)}catch(e){console.error("Error fetching regions:",e)}},z=async e=>{try{let s=await fetch("/api/universities?regionId=".concat(e)),t=await s.json();U(t)}catch(e){console.error("Error fetching universities:",e)}},J=async e=>{try{let s=await fetch("/api/small-groups?universityId=".concat(e)),t=await s.json();D(t)}catch(e){console.error("Error fetching small groups:",e)}},K=async e=>{try{let s=await fetch("/api/alumni-small-groups?regionId=".concat(e)),t=await s.json();M(t)}catch(e){console.error("Error fetching alumni groups:",e)}},W=(e,s)=>{_(t=>({...t,[e]:s})),S[e]&&w(s=>({...s,[e]:""})),C&&G(!1)},Q=async e=>{if(e.preventDefault(),(()=>{let e={};return q.name.trim()||(e.name="Event name is required"),q.type.trim()||(e.type="Event type is required"),L.region&&!q.regionId&&(e.regionId="Region is required"),w(e),0===Object.keys(e).length})()){o(!0);try{let e={name:q.name,type:q.type,regionId:q.regionId?Number(q.regionId):null,universityId:q.universityId?Number(q.universityId):null,smallGroupId:q.smallGroupId?Number(q.smallGroupId):null,alumniGroupId:q.alumniGroupId?Number(q.alumniGroupId):null,isActive:q.isActive},s=await fetch("/api/events",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),t=await s.json();s.ok?(G(!0),w({}),_({name:"",type:"",regionId:"",universityId:"",smallGroupId:"",alumniGroupId:"",isActive:!0}),l&&l(),setTimeout(()=>{n(!1),G(!1)},1500)):(console.error("API Error:",t),w({general:t.error||"Failed to create event"}))}catch(e){console.error("Error creating event:",e),w({general:"An unexpected error occurred"})}finally{o(!1)}}};return(0,s.jsxs)(v.Sheet,{open:a,onOpenChange:n,children:[(0,s.jsx)(v.SheetTrigger,{asChild:!0,children:r}),(0,s.jsx)(v.SheetContent,{side:"top",className:"h-full w-full max-w-none overflow-y-auto",children:(0,s.jsxs)("div",{className:"container mx-auto max-w-2xl py-8",children:[(0,s.jsxs)(v.SheetHeader,{className:"pb-8 text-center",children:[(0,s.jsxs)(v.SheetTitle,{className:"flex items-center justify-center gap-3 text-2xl",children:[(0,s.jsx)("div",{className:"flex h-12 w-12 items-center justify-center rounded-lg bg-primary/10",children:(0,s.jsx)(i.Plus,{className:"h-6 w-6 text-primary"})}),"Add New Event"]}),(0,s.jsx)(v.SheetDescription,{className:"text-lg text-muted-foreground",children:"Add a new event to your organization."})]}),(0,s.jsxs)(u.Card,{className:"shadow-lg",children:[(0,s.jsx)(u.CardHeader,{className:"pb-6",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold",children:"Event Information"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Fill in the details below to add a new event"})]})}),(0,s.jsx)(u.CardContent,{children:A?(0,s.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Loading user scope..."})}):(0,s.jsxs)("form",{onSubmit:Q,className:"flex flex-col gap-6",children:[S.general&&(0,s.jsx)("div",{className:"p-3 text-sm text-red-600 bg-red-50 border border-red-200 rounded-md",children:S.general}),E&&"superadmin"!==E.scope&&(0,s.jsxs)("div",{className:"p-3 text-sm bg-blue-50 border border-blue-200 rounded-md",children:[(0,s.jsxs)("div",{className:"font-medium text-blue-800",children:["Current Scope: ",E.scope]}),E.region&&(0,s.jsxs)("div",{className:"text-blue-700",children:["Region: ",E.region.name]}),E.university&&(0,s.jsxs)("div",{className:"text-blue-700",children:["University: ",E.university.name]}),E.smallGroup&&(0,s.jsxs)("div",{className:"text-blue-700",children:["Small Group: ",E.smallGroup.name]}),E.alumniGroup&&(0,s.jsxs)("div",{className:"text-blue-700",children:["Alumni Group: ",E.alumniGroup.name]})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h4",{className:"text-md font-semibold text-foreground border-b pb-2",children:"Event Details"}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(h.Label,{htmlFor:"name",className:"text-sm font-medium flex items-center gap-2",children:[(0,s.jsx)(c.Calendar,{className:"h-4 w-4"}),"Event Name *"]}),(0,s.jsx)(x.Input,{id:"name",placeholder:"Enter event name",className:"h-11",value:q.name,onChange:e=>W("name",e.target.value),required:!0}),S.name&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:S.name})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(h.Label,{htmlFor:"type",className:"text-sm font-medium flex items-center gap-2",children:[(0,s.jsx)(b.Activity,{className:"h-4 w-4"}),"Event Type *"]}),(0,s.jsxs)(p.Select,{value:q.type,onValueChange:e=>W("type",e),children:[(0,s.jsx)(p.SelectTrigger,{className:"h-11",children:(0,s.jsx)(p.SelectValue,{placeholder:"Select event type"})}),(0,s.jsxs)(p.SelectContent,{children:[(0,s.jsx)(p.SelectItem,{value:"bible_study",children:"Bible Study"}),(0,s.jsx)(p.SelectItem,{value:"discipleship",children:"Discipleship"}),(0,s.jsx)(p.SelectItem,{value:"evangelism",children:"Evangelism"}),(0,s.jsx)(p.SelectItem,{value:"cell_meeting",children:"Cell Meeting"}),(0,s.jsx)(p.SelectItem,{value:"alumni_meeting",children:"Alumni Meeting"}),(0,s.jsx)(p.SelectItem,{value:"other",children:"Other"})]})]}),S.type&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:S.type})]}),L.region&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(h.Label,{htmlFor:"regionId",className:"text-sm font-medium flex items-center gap-2",children:[(0,s.jsx)(j.MapPin,{className:"h-4 w-4"}),"Region *"]}),(0,s.jsxs)(p.Select,{value:q.regionId,onValueChange:e=>W("regionId",e),children:[(0,s.jsx)(p.SelectTrigger,{className:"h-11",children:(0,s.jsx)(p.SelectValue,{placeholder:"Select a region"})}),(0,s.jsx)(p.SelectContent,{children:F.map(e=>(0,s.jsx)(p.SelectItem,{value:e.id.toString(),children:e.name},e.id))})]}),S.regionId&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:S.regionId})]}),L.university&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(h.Label,{htmlFor:"universityId",className:"text-sm font-medium flex items-center gap-2",children:[(0,s.jsx)(f.Building2,{className:"h-4 w-4"}),"University (Optional)"]}),(0,s.jsxs)(p.Select,{value:q.universityId,onValueChange:e=>W("universityId",e),disabled:!q.regionId,children:[(0,s.jsx)(p.SelectTrigger,{className:"h-11",children:(0,s.jsx)(p.SelectValue,{placeholder:q.regionId?"Select a university (optional)":"Select a region first"})}),(0,s.jsx)(p.SelectContent,{children:V.map(e=>(0,s.jsx)(p.SelectItem,{value:e.id.toString(),children:e.name},e.id))})]})]}),L.smallGroup&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(h.Label,{htmlFor:"smallGroupId",className:"text-sm font-medium flex items-center gap-2",children:[(0,s.jsx)(y.Users,{className:"h-4 w-4"}),"Small Group (Optional)"]}),(0,s.jsxs)(p.Select,{value:q.smallGroupId,onValueChange:e=>W("smallGroupId",e),disabled:(null==E?void 0:E.scope)!=="university"&&!q.universityId,children:[(0,s.jsx)(p.SelectTrigger,{className:"h-11",children:(0,s.jsx)(p.SelectValue,{placeholder:(null==E?void 0:E.scope)==="university"||q.universityId?"Select a small group (optional)":"Select a university first"})}),(0,s.jsx)(p.SelectContent,{children:P.map(e=>(0,s.jsx)(p.SelectItem,{value:e.id.toString(),children:e.name},e.id))})]})]}),L.alumniGroup&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(h.Label,{htmlFor:"alumniGroupId",className:"text-sm font-medium flex items-center gap-2",children:[(0,s.jsx)(N.GraduationCap,{className:"h-4 w-4"}),"Alumni Group (Optional)"]}),(0,s.jsxs)(p.Select,{value:q.alumniGroupId,onValueChange:e=>W("alumniGroupId",e),disabled:!q.regionId,children:[(0,s.jsx)(p.SelectTrigger,{className:"h-11",children:(0,s.jsx)(p.SelectValue,{placeholder:q.regionId?"Select an alumni group (optional)":"Select a region first"})}),(0,s.jsx)(p.SelectContent,{children:R.map(e=>(0,s.jsx)(p.SelectItem,{value:e.id.toString(),children:e.name},e.id))})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(g.Checkbox,{id:"isActive",checked:q.isActive,onCheckedChange:e=>W("isActive",e)}),(0,s.jsx)(h.Label,{htmlFor:"isActive",className:"text-sm font-medium",children:"Event is active"})]})]}),(0,s.jsxs)("div",{className:"flex gap-3 pt-6 border-t",children:[(0,s.jsx)(m.Button,{type:"button",variant:"outline",className:"flex-1 h-11",onClick:()=>n(!1),disabled:d,children:"Cancel"}),(0,s.jsx)(m.Button,{type:"submit",className:"flex-1 h-11",disabled:d||C,children:d?"Creating...":C?"✅ Created Successfully!":(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.Plus,{className:"mr-2 h-4 w-4"}),"Add Event"]})})]})]})})]})]})})]})}var w=e.i(78894);function C(e){let{isOpen:t,onClose:r,onConfirm:l,eventName:a,isLoading:i=!1}=e;return(0,s.jsx)(v.Sheet,{open:t,onOpenChange:r,children:(0,s.jsx)(v.SheetContent,{side:"top",className:"h-auto w-full max-w-md mx-auto",children:(0,s.jsxs)("div",{className:"py-8",children:[(0,s.jsxs)(v.SheetHeader,{className:"pb-6 text-center",children:[(0,s.jsx)("div",{className:"flex justify-center mb-4",children:(0,s.jsx)("div",{className:"flex h-16 w-16 items-center justify-center rounded-full bg-destructive/10",children:(0,s.jsx)(w.AlertTriangle,{className:"h-8 w-8 text-destructive"})})}),(0,s.jsx)(v.SheetTitle,{className:"text-xl text-destructive",children:"Delete Event"}),(0,s.jsxs)(v.SheetDescription,{className:"text-base",children:["Are you sure you want to delete ",(0,s.jsx)("strong",{children:a}),"? This action cannot be undone."]})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("div",{className:"p-4 bg-destructive/5 border border-destructive/20 rounded-lg",children:(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)(d.Trash2,{className:"h-5 w-5 text-destructive mt-0.5"}),(0,s.jsxs)("div",{className:"text-sm text-destructive",children:[(0,s.jsx)("p",{className:"font-medium mb-1",children:"Warning:"}),(0,s.jsx)("p",{children:"This will permanently remove the event and all associated data from the system."})]})]})}),(0,s.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,s.jsx)(m.Button,{type:"button",variant:"outline",className:"flex-1",onClick:r,disabled:i,children:"Cancel"}),(0,s.jsx)(m.Button,{type:"button",variant:"destructive",className:"flex-1",onClick:l,disabled:i,children:i?"Deleting...":(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(d.Trash2,{className:"mr-2 h-4 w-4"}),"Delete Event"]})})]})]})]})})})}function G(e){let{event:r,onEventUpdated:l,isOpen:a,onClose:i}=e,[d,o]=t.useState(!1),[S,w]=t.useState({}),[C,G]=t.useState(!1),{userScope:E,loading:A,getVisibleFields:T,getDefaultValues:k}=(0,I.useUserScope)(),L=T();t.useMemo(()=>k(),[E]);let[O,F]=t.useState([]),[B,V]=t.useState([]),[U,P]=t.useState([]),[D,R]=t.useState([]),[M,q]=t.useState({name:"",type:"",regionId:"",universityId:"",smallGroupId:"",alumniGroupId:"",isActive:!0});t.useEffect(()=>{a&&L.region&&_()},[a,L.region]),t.useEffect(()=>{M.regionId&&L.university?H(Number(M.regionId)):(V([]),q(e=>({...e,universityId:""})))},[M.regionId,L.university]),t.useEffect(()=>{M.regionId&&L.alumniGroup?J(Number(M.regionId)):(R([]),q(e=>({...e,alumniGroupId:""})))},[M.regionId,L.alumniGroup]),t.useEffect(()=>{if(L.smallGroup){let e=(null==E?void 0:E.scope)==="university"?E.universityId:M.universityId;e?z(Number(e)):(P([]),q(e=>({...e,smallGroupId:""})))}},[M.universityId,L.smallGroup,E]),t.useEffect(()=>{if(r){var e,s,t,l,a;q({name:r.name||"",type:r.type||"",regionId:(null==(e=r.regionId)?void 0:e.toString())||"",universityId:(null==(s=r.universityId)?void 0:s.toString())||"",smallGroupId:(null==(t=r.smallGroupId)?void 0:t.toString())||"",alumniGroupId:(null==(l=r.alumniGroupId)?void 0:l.toString())||"",isActive:null==(a=r.isActive)||a})}},[r]);let _=async()=>{try{let e=await fetch("/api/regions"),s=await e.json();F(s)}catch(e){console.error("Error fetching regions:",e)}},H=async e=>{try{let s=await fetch("/api/universities?regionId=".concat(e)),t=await s.json();V(t)}catch(e){console.error("Error fetching universities:",e)}},z=async e=>{try{let s=await fetch("/api/small-groups?universityId=".concat(e)),t=await s.json();P(t)}catch(e){console.error("Error fetching small groups:",e)}},J=async e=>{try{let s=await fetch("/api/alumni-small-groups?regionId=".concat(e)),t=await s.json();R(t)}catch(e){console.error("Error fetching alumni groups:",e)}},K=(e,s)=>{q(t=>({...t,[e]:s})),S[e]&&w(s=>({...s,[e]:""})),C&&G(!1)},W=async e=>{if((e.preventDefault(),r)&&(()=>{let e={};return M.name.trim()||(e.name="Event name is required"),M.type.trim()||(e.type="Event type is required"),L.region&&!M.regionId&&(e.regionId="Region is required"),w(e),0===Object.keys(e).length})()){o(!0);try{let e=await fetch("/api/events?id=".concat(r.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:M.name,type:M.type,regionId:M.regionId?Number(M.regionId):null,universityId:M.universityId?Number(M.universityId):null,smallGroupId:M.smallGroupId?Number(M.smallGroupId):null,alumniGroupId:M.alumniGroupId?Number(M.alumniGroupId):null,isActive:M.isActive})}),s=await e.json();e.ok?(G(!0),w({}),l&&l(),setTimeout(()=>{i(),G(!1)},1500)):(console.error("API Error:",s),w({general:s.error||"Failed to update event"}))}catch(e){console.error("Error updating event:",e),w({general:"An unexpected error occurred"})}finally{o(!1)}}};return r?(0,s.jsx)(v.Sheet,{open:a,onOpenChange:i,children:(0,s.jsx)(v.SheetContent,{side:"top",className:"h-full w-full max-w-none overflow-y-auto",children:(0,s.jsxs)("div",{className:"container mx-auto max-w-2xl py-8",children:[(0,s.jsxs)(v.SheetHeader,{className:"pb-8 text-center",children:[(0,s.jsxs)(v.SheetTitle,{className:"flex items-center justify-center gap-3 text-2xl",children:[(0,s.jsx)("div",{className:"flex h-12 w-12 items-center justify-center rounded-lg bg-primary/10",children:(0,s.jsx)(n.Edit,{className:"h-6 w-6 text-primary"})}),"Edit Event"]}),(0,s.jsxs)(v.SheetDescription,{className:"text-lg text-muted-foreground",children:["Update event information for ",r.name,"."]})]}),(0,s.jsxs)(u.Card,{className:"shadow-lg",children:[(0,s.jsx)(u.CardHeader,{className:"pb-6",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold",children:"Event Information"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Update the details below for this event"})]})}),(0,s.jsx)(u.CardContent,{children:A?(0,s.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Loading user scope..."})}):(0,s.jsxs)("form",{onSubmit:W,className:"flex flex-col gap-6",children:[S.general&&(0,s.jsx)("div",{className:"p-3 text-sm text-red-600 bg-red-50 border border-red-200 rounded-md",children:S.general}),E&&"superadmin"!==E.scope&&(0,s.jsxs)("div",{className:"p-3 text-sm bg-blue-50 border border-blue-200 rounded-md",children:[(0,s.jsxs)("div",{className:"font-medium text-blue-800",children:["Current Scope: ",E.scope]}),E.region&&(0,s.jsxs)("div",{className:"text-blue-700",children:["Region: ",E.region.name]}),E.university&&(0,s.jsxs)("div",{className:"text-blue-700",children:["University: ",E.university.name]}),E.smallGroup&&(0,s.jsxs)("div",{className:"text-blue-700",children:["Small Group: ",E.smallGroup.name]}),E.alumniGroup&&(0,s.jsxs)("div",{className:"text-blue-700",children:["Alumni Group: ",E.alumniGroup.name]})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h4",{className:"text-md font-semibold text-foreground border-b pb-2",children:"Event Details"}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(h.Label,{htmlFor:"name",className:"text-sm font-medium flex items-center gap-2",children:[(0,s.jsx)(c.Calendar,{className:"h-4 w-4"}),"Event Name *"]}),(0,s.jsx)(x.Input,{id:"name",placeholder:"Enter event name",className:"h-11",value:M.name,onChange:e=>K("name",e.target.value),required:!0}),S.name&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:S.name})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(h.Label,{htmlFor:"type",className:"text-sm font-medium flex items-center gap-2",children:[(0,s.jsx)(b.Activity,{className:"h-4 w-4"}),"Event Type *"]}),(0,s.jsxs)(p.Select,{value:M.type,onValueChange:e=>K("type",e),children:[(0,s.jsx)(p.SelectTrigger,{className:"h-11",children:(0,s.jsx)(p.SelectValue,{placeholder:"Select event type"})}),(0,s.jsxs)(p.SelectContent,{children:[(0,s.jsx)(p.SelectItem,{value:"bible_study",children:"Bible Study"}),(0,s.jsx)(p.SelectItem,{value:"discipleship",children:"Discipleship"}),(0,s.jsx)(p.SelectItem,{value:"evangelism",children:"Evangelism"}),(0,s.jsx)(p.SelectItem,{value:"cell_meeting",children:"Cell Meeting"}),(0,s.jsx)(p.SelectItem,{value:"alumni_meeting",children:"Alumni Meeting"}),(0,s.jsx)(p.SelectItem,{value:"other",children:"Other"})]})]}),S.type&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:S.type})]}),L.region&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(h.Label,{htmlFor:"regionId",className:"text-sm font-medium flex items-center gap-2",children:[(0,s.jsx)(j.MapPin,{className:"h-4 w-4"}),"Region *"]}),(0,s.jsxs)(p.Select,{value:M.regionId,onValueChange:e=>K("regionId",e),children:[(0,s.jsx)(p.SelectTrigger,{className:"h-11",children:(0,s.jsx)(p.SelectValue,{placeholder:"Select a region"})}),(0,s.jsx)(p.SelectContent,{children:O.map(e=>(0,s.jsx)(p.SelectItem,{value:e.id.toString(),children:e.name},e.id))})]}),S.regionId&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:S.regionId})]}),L.university&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(h.Label,{htmlFor:"universityId",className:"text-sm font-medium flex items-center gap-2",children:[(0,s.jsx)(f.Building2,{className:"h-4 w-4"}),"University (Optional)"]}),(0,s.jsxs)(p.Select,{value:M.universityId,onValueChange:e=>K("universityId",e),disabled:!M.regionId,children:[(0,s.jsx)(p.SelectTrigger,{className:"h-11",children:(0,s.jsx)(p.SelectValue,{placeholder:M.regionId?"Select a university (optional)":"Select a region first"})}),(0,s.jsx)(p.SelectContent,{children:B.map(e=>(0,s.jsx)(p.SelectItem,{value:e.id.toString(),children:e.name},e.id))})]})]}),L.smallGroup&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(h.Label,{htmlFor:"smallGroupId",className:"text-sm font-medium flex items-center gap-2",children:[(0,s.jsx)(y.Users,{className:"h-4 w-4"}),"Small Group (Optional)"]}),(0,s.jsxs)(p.Select,{value:M.smallGroupId,onValueChange:e=>K("smallGroupId",e),disabled:(null==E?void 0:E.scope)!=="university"&&!M.universityId,children:[(0,s.jsx)(p.SelectTrigger,{className:"h-11",children:(0,s.jsx)(p.SelectValue,{placeholder:(null==E?void 0:E.scope)==="university"||M.universityId?"Select a small group (optional)":"Select a university first"})}),(0,s.jsx)(p.SelectContent,{children:U.map(e=>(0,s.jsx)(p.SelectItem,{value:e.id.toString(),children:e.name},e.id))})]})]}),L.alumniGroup&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(h.Label,{htmlFor:"alumniGroupId",className:"text-sm font-medium flex items-center gap-2",children:[(0,s.jsx)(N.GraduationCap,{className:"h-4 w-4"}),"Alumni Group (Optional)"]}),(0,s.jsxs)(p.Select,{value:M.alumniGroupId,onValueChange:e=>K("alumniGroupId",e),disabled:!M.regionId,children:[(0,s.jsx)(p.SelectTrigger,{className:"h-11",children:(0,s.jsx)(p.SelectValue,{placeholder:M.regionId?"Select an alumni group (optional)":"Select a region first"})}),(0,s.jsx)(p.SelectContent,{children:D.map(e=>(0,s.jsx)(p.SelectItem,{value:e.id.toString(),children:e.name},e.id))})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(g.Checkbox,{id:"isActive",checked:M.isActive,onCheckedChange:e=>K("isActive",e)}),(0,s.jsx)(h.Label,{htmlFor:"isActive",className:"text-sm font-medium",children:"Event is active"})]})]}),(0,s.jsxs)("div",{className:"flex gap-3 pt-6 border-t",children:[(0,s.jsx)(m.Button,{type:"button",variant:"outline",className:"flex-1 h-11",onClick:i,disabled:d,children:"Cancel"}),(0,s.jsx)(m.Button,{type:"submit",className:"flex-1 h-11",disabled:d||C,children:d?"Updating...":C?"✅ Updated Successfully!":(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.Edit,{className:"mr-2 h-4 w-4"}),"Update Event"]})})]})]})})]})]})})}):null}var E=e.i(75117),A=e.i(69035),T=e.i(11522);function k(){let[e,m]=(0,t.useState)(""),[u,x]=(0,t.useState)([]),[h,p]=(0,t.useState)(!0),[g,v]=(0,t.useState)(null),[j,f]=(0,t.useState)({isOpen:!1,eventId:null,eventName:""}),[y,N]=(0,t.useState)(!1),[b,I]=(0,t.useState)(null),w=async()=>{try{p(!0),v(null);let e=await r.default.get("/api/events");x(e.data)}catch(e){console.error("Error fetching events:",e),v("Failed to fetch events. Please try again.")}finally{p(!1)}},k=()=>{f({isOpen:!1,eventId:null,eventName:""})},L=async()=>{if(j.eventId){N(!0);try{let e=await r.default.delete("/api/events?id=".concat(j.eventId));200===e.status&&(x(e=>e.filter(e=>e.id!==j.eventId)),k())}catch(e){console.error("Error deleting event:",e),alert("Failed to delete event. Please try again.")}finally{N(!1)}}};(0,t.useEffect)(()=>{w()},[]);let O=u.filter(s=>{var t,r,l,a,i,n,d,c,o,m;if(!e)return!0;let u=e.toLowerCase();return(null==(t=s.name)?void 0:t.toLowerCase().includes(u))||(null==(r=s.type)?void 0:r.toLowerCase().includes(u))||(null==(a=s.region)||null==(l=a.name)?void 0:l.toLowerCase().includes(u))||(null==(n=s.university)||null==(i=n.name)?void 0:i.toLowerCase().includes(u))||(null==(c=s.smallGroup)||null==(d=c.name)?void 0:d.toLowerCase().includes(u))||(null==(m=s.alumniGroup)||null==(o=m.name)?void 0:o.toLowerCase().includes(u))});return(0,s.jsxs)(T.SidebarProvider,{children:[(0,s.jsx)(o.AppSidebar,{}),(0,s.jsxs)(T.SidebarInset,{children:[(0,s.jsx)("header",{className:"flex h-16 shrink-0 items-center gap-2 transition-[width,height] ease-linear group-has-data-[collapsible=icon]/sidebar-wrapper:h-12",children:(0,s.jsxs)("div",{className:"flex items-center gap-2 px-4",children:[(0,s.jsx)(T.SidebarTrigger,{className:"-ml-1"}),(0,s.jsx)(A.Separator,{orientation:"vertical",className:"mr-2 data-[orientation=vertical]:h-4"}),(0,s.jsx)(E.Breadcrumb,{children:(0,s.jsxs)(E.BreadcrumbList,{children:[(0,s.jsx)(E.BreadcrumbItem,{className:"hidden md:block",children:(0,s.jsx)(E.BreadcrumbLink,{href:"/dashboard",children:"Dashboard"})}),(0,s.jsx)(E.BreadcrumbSeparator,{className:"hidden md:block"}),(0,s.jsx)(E.BreadcrumbItem,{children:(0,s.jsx)(E.BreadcrumbLink,{href:"/links/activities",children:"Activities"})}),(0,s.jsx)(E.BreadcrumbSeparator,{}),(0,s.jsx)(E.BreadcrumbItem,{children:(0,s.jsx)(E.BreadcrumbPage,{children:"Events"})})]})})]})}),(0,s.jsx)("div",{className:"flex flex-1 flex-col gap-4 p-2 sm:p-4 pt-0",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto w-full",children:[(0,s.jsxs)("div",{className:"mb-4 sm:mb-6 lg:mb-8",children:[(0,s.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-foreground mb-1 sm:mb-2",children:"Events Management"}),(0,s.jsx)("p",{className:"text-sm sm:text-base text-muted-foreground",children:"Manage events and their information across the organization"})]}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 sm:gap-4 items-stretch sm:items-center justify-between mb-4 sm:mb-6",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3 flex-1",children:[(0,s.jsxs)("div",{className:"relative flex-1 max-w-md",children:[(0,s.jsx)(l.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),(0,s.jsx)("input",{type:"text",placeholder:"Search events...",value:e,onChange:e=>m(e.target.value),className:"w-full pl-10 pr-4 py-2 sm:py-2.5 bg-muted/30 border border-border/20 rounded-lg focus:ring-2 focus:ring-primary/20 focus:border-primary/50 focus:bg-muted/50 transition-all duration-200 text-foreground placeholder:text-muted-foreground text-sm sm:text-base"})]}),(0,s.jsxs)("button",{onClick:w,disabled:h,className:"flex items-center justify-center gap-2 px-3 sm:px-4 py-2 sm:py-2.5 text-foreground bg-muted/30 hover:bg-muted/50 border border-border/20 hover:border-border/40 rounded-lg transition-all duration-200 text-sm sm:text-base disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,s.jsx)(a.RefreshCw,{className:"w-4 h-4 ".concat(h?"animate-spin":"")}),(0,s.jsx)("span",{className:"hidden sm:inline",children:h?"Loading...":"Refresh"})]})]}),(0,s.jsx)(S,{onEventAdded:w,children:(0,s.jsxs)("button",{className:"flex items-center justify-center gap-2 px-4 sm:px-6 py-2 sm:py-2.5 bg-muted text-foreground hover:bg-muted/80 rounded-md transition-all duration-200 shadow-sm text-sm sm:text-base",children:[(0,s.jsx)(i.Plus,{className:"w-4 h-4"}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Add New Event"}),(0,s.jsx)("span",{className:"sm:hidden",children:"Add Event"})]})})]}),g&&(0,s.jsxs)("div",{className:"bg-destructive/10 border border-destructive/20 rounded-lg p-4 mb-6",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-destructive",children:[(0,s.jsx)("span",{className:"text-sm font-medium",children:"Error:"}),(0,s.jsx)("span",{className:"text-sm",children:g})]}),(0,s.jsx)("button",{onClick:w,className:"mt-2 text-sm text-destructive hover:text-destructive/80 underline",children:"Try again"})]}),(0,s.jsxs)("div",{className:"bg-card rounded-lg shadow-sm border border-border overflow-hidden",children:[h?(0,s.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,s.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground",children:[(0,s.jsx)(a.RefreshCw,{className:"w-4 h-4 animate-spin"}),(0,s.jsx)("span",{children:"Loading events..."})]})}):(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full min-w-[800px]",children:[(0,s.jsx)("thead",{className:"bg-muted/50 border-b border-border",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"ID"}),(0,s.jsx)("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Event Name"}),(0,s.jsx)("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Type"}),(0,s.jsx)("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Organization"}),(0,s.jsx)("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Status"}),(0,s.jsx)("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Actions"})]})}),(0,s.jsx)("tbody",{className:"bg-card divide-y divide-border",children:O.map(e=>{var t;return(0,s.jsxs)("tr",{className:"hover:bg-muted/50",children:[(0,s.jsx)("td",{className:"px-3 sm:px-6 py-3 sm:py-4 text-sm font-medium text-foreground",children:e.id}),(0,s.jsx)("td",{className:"px-3 sm:px-6 py-3 sm:py-4 text-sm text-foreground",children:e.name}),(0,s.jsx)("td",{className:"px-3 sm:px-6 py-3 sm:py-4 text-sm text-muted-foreground",children:e.type}),(0,s.jsx)("td",{className:"px-3 sm:px-6 py-3 sm:py-4 text-sm text-muted-foreground",children:(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("div",{className:"font-medium",children:null==(t=e.region)?void 0:t.name}),e.university&&(0,s.jsxs)("div",{className:"text-xs text-muted-foreground",children:["University: ",e.university.name]}),e.smallGroup&&(0,s.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Small Group: ",e.smallGroup.name]}),e.alumniGroup&&(0,s.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Alumni Group: ",e.alumniGroup.name]})]})}),(0,s.jsx)("td",{className:"px-3 sm:px-6 py-3 sm:py-4 text-sm",children:(0,s.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(e.isActive?"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400":"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400"),children:e.isActive?"Active":"Inactive"})}),(0,s.jsx)("td",{className:"px-3 sm:px-6 py-3 sm:py-4 text-sm font-medium",children:(0,s.jsxs)("div",{className:"flex items-center gap-1 sm:gap-2",children:[(0,s.jsx)("button",{onClick:()=>{I(e)},className:"text-muted-foreground hover:text-foreground p-1 rounded",title:"Edit",children:(0,s.jsx)(n.Edit,{className:"w-4 h-4"})}),(0,s.jsx)("button",{onClick:()=>{f({isOpen:!0,eventId:e.id,eventName:e.name})},className:"text-destructive hover:text-destructive/80 p-1 rounded",title:"Delete",children:(0,s.jsx)(d.Trash2,{className:"w-4 h-4"})})]})})]},e.id)})})]})}),!h&&0===O.length&&!g&&(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center py-12",children:[(0,s.jsx)(c.Calendar,{className:"w-12 h-12 text-muted-foreground mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-medium text-foreground mb-2",children:"No events found"}),(0,s.jsx)("p",{className:"text-muted-foreground text-center mb-4",children:e?"No events match your search criteria.":"No events have been added yet."}),!e&&(0,s.jsx)(S,{onEventAdded:w,children:(0,s.jsxs)("button",{className:"flex items-center gap-2 px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors",children:[(0,s.jsx)(i.Plus,{className:"w-4 h-4"}),"Add First Event"]})})]}),!h&&O.length>0&&(0,s.jsx)("div",{className:"bg-muted/50 px-3 sm:px-6 py-3 border-t border-border",children:(0,s.jsx)("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-2 sm:gap-0",children:(0,s.jsxs)("div",{className:"text-xs sm:text-sm text-muted-foreground text-center sm:text-left",children:["Showing ",(0,s.jsx)("span",{className:"font-medium text-foreground",children:O.length})," of ",(0,s.jsx)("span",{className:"font-medium text-foreground",children:u.length})," events"]})})})]})]})})]}),(0,s.jsx)(C,{isOpen:j.isOpen,onClose:k,onConfirm:L,eventName:j.eventName,isLoading:y}),(0,s.jsx)(G,{event:b,onEventUpdated:w,isOpen:null!==b,onClose:()=>{I(null)}})]})}}]);