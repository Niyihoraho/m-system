(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,98183,(e,s,t)=>{"use strict";function r(e){let s={};for(let[t,r]of e.entries()){let e=s[t];void 0===e?s[t]=r:Array.isArray(e)?e.push(r):s[t]=[e,r]}return s}function a(e){return"string"==typeof e?e:("number"!=typeof e||isNaN(e))&&"boolean"!=typeof e?"":String(e)}function l(e){let s=new URLSearchParams;for(let[t,r]of Object.entries(e))if(Array.isArray(r))for(let e of r)s.append(t,a(e));else s.set(t,a(r));return s}function n(e){for(var s=arguments.length,t=Array(s>1?s-1:0),r=1;r<s;r++)t[r-1]=arguments[r];for(let s of t){for(let t of s.keys())e.delete(t);for(let[t,r]of s.entries())e.append(t,r)}return e}Object.defineProperty(t,"__esModule",{value:!0}),!function(e,s){for(var t in s)Object.defineProperty(e,t,{enumerable:!0,get:s[t]})}(t,{assign:function(){return n},searchParamsToUrlQuery:function(){return r},urlQueryToSearchParams:function(){return l}})},95057,(e,s,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,s){for(var t in s)Object.defineProperty(e,t,{enumerable:!0,get:s[t]})}(t,{formatUrl:function(){return l},formatWithValidation:function(){return i},urlObjectKeys:function(){return n}});let r=e.r(90809)._(e.r(98183)),a=/https?|ftp|gopher|file/;function l(e){let{auth:s,hostname:t}=e,l=e.protocol||"",n=e.pathname||"",i=e.hash||"",o=e.query||"",d=!1;s=s?encodeURIComponent(s).replace(/%3A/i,":")+"@":"",e.host?d=s+e.host:t&&(d=s+(~t.indexOf(":")?"["+t+"]":t),e.port&&(d+=":"+e.port)),o&&"object"==typeof o&&(o=String(r.urlQueryToSearchParams(o)));let c=e.search||o&&"?"+o||"";return l&&!l.endsWith(":")&&(l+=":"),e.slashes||(!l||a.test(l))&&!1!==d?(d="//"+(d||""),n&&"/"!==n[0]&&(n="/"+n)):d||(d=""),i&&"#"!==i[0]&&(i="#"+i),c&&"?"!==c[0]&&(c="?"+c),""+l+d+(n=n.replace(/[?#]/g,encodeURIComponent))+(c=c.replace("#","%23"))+i}let n=["auth","hash","host","hostname","href","path","pathname","port","protocol","query","search","slashes"];function i(e){return l(e)}},18581,(e,s,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"useMergedRef",{enumerable:!0,get:function(){return a}});let r=e.r(71645);function a(e,s){let t=(0,r.useRef)(null),a=(0,r.useRef)(null);return(0,r.useCallback)(r=>{if(null===r){let e=t.current;e&&(t.current=null,e());let s=a.current;s&&(a.current=null,s())}else e&&(t.current=l(e,r)),s&&(a.current=l(s,r))},[e,s])}function l(e,s){if("function"!=typeof e)return e.current=s,()=>{e.current=null};{let t=e(s);return"function"==typeof t?t:()=>e(null)}}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),s.exports=t.default)},18967,(e,s,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,s){for(var t in s)Object.defineProperty(e,t,{enumerable:!0,get:s[t]})}(t,{DecodeError:function(){return h},MiddlewareNotFoundError:function(){return N},MissingStaticPage:function(){return j},NormalizeError:function(){return f},PageNotFoundError:function(){return g},SP:function(){return p},ST:function(){return x},WEB_VITALS:function(){return r},execOnce:function(){return a},getDisplayName:function(){return d},getLocationOrigin:function(){return i},getURL:function(){return o},isAbsoluteUrl:function(){return n},isResSent:function(){return c},loadGetInitialProps:function(){return m},normalizeRepeatedSlashes:function(){return u},stringifyError:function(){return v}});let r=["CLS","FCP","FID","INP","LCP","TTFB"];function a(e){let s,t=!1;return function(){for(var r=arguments.length,a=Array(r),l=0;l<r;l++)a[l]=arguments[l];return t||(t=!0,s=e(...a)),s}}let l=/^[a-zA-Z][a-zA-Z\d+\-.]*?:/,n=e=>l.test(e);function i(){let{protocol:e,hostname:s,port:t}=window.location;return e+"//"+s+(t?":"+t:"")}function o(){let{href:e}=window.location,s=i();return e.substring(s.length)}function d(e){return"string"==typeof e?e:e.displayName||e.name||"Unknown"}function c(e){return e.finished||e.headersSent}function u(e){let s=e.split("?");return s[0].replace(/\\/g,"/").replace(/\/\/+/g,"/")+(s[1]?"?"+s.slice(1).join("?"):"")}async function m(e,s){let t=s.res||s.ctx&&s.ctx.res;if(!e.getInitialProps)return s.ctx&&s.Component?{pageProps:await m(s.Component,s.ctx)}:{};let r=await e.getInitialProps(s);if(t&&c(t))return r;if(!r)throw Object.defineProperty(Error('"'+d(e)+'.getInitialProps()" should resolve to an object. But found "'+r+'" instead.'),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});return r}let p="undefined"!=typeof performance,x=p&&["mark","measure","getEntriesByName"].every(e=>"function"==typeof performance[e]);class h extends Error{}class f extends Error{}class g extends Error{constructor(e){super(),this.code="ENOENT",this.name="PageNotFoundError",this.message="Cannot find module for page: "+e}}class j extends Error{constructor(e,s){super(),this.message="Failed to load static file for page: "+e+" "+s}}class N extends Error{constructor(){super(),this.code="ENOENT",this.message="Cannot find the middleware module"}}function v(e){return JSON.stringify({message:e.message,stack:e.stack})}},73668,(e,s,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"isLocalURL",{enumerable:!0,get:function(){return l}});let r=e.r(18967),a=e.r(52817);function l(e){if(!(0,r.isAbsoluteUrl)(e))return!0;try{let s=(0,r.getLocationOrigin)(),t=new URL(e,s);return t.origin===s&&(0,a.hasBasePath)(t.pathname)}catch(e){return!1}}},84508,(e,s,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"errorOnce",{enumerable:!0,get:function(){return r}});let r=e=>{}},22016,(e,s,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,s){for(var t in s)Object.defineProperty(e,t,{enumerable:!0,get:s[t]})}(t,{default:function(){return f},useLinkStatus:function(){return j}});let r=e.r(90809),a=e.r(43476),l=r._(e.r(71645)),n=e.r(95057),i=e.r(8372),o=e.r(18581),d=e.r(18967),c=e.r(5550);e.r(33525);let u=e.r(91949),m=e.r(73668),p=e.r(99781);e.r(84508);let x=e.r(65165);function h(e){return"string"==typeof e?e:(0,n.formatUrl)(e)}function f(e){var s;let t,r,n,[f,j]=(0,l.useOptimistic)(u.IDLE_LINK_STATUS),N=(0,l.useRef)(null),{href:v,as:y,children:b,prefetch:w=null,passHref:S,replace:I,shallow:C,scroll:A,onClick:P,onMouseEnter:U,onTouchStart:E,legacyBehavior:R=!1,onNavigate:k,ref:T,unstable_dynamicOnHover:L,...O}=e;t=b,R&&("string"==typeof t||"number"==typeof t)&&(t=(0,a.jsx)("a",{children:t}));let F=l.default.useContext(i.AppRouterContext),G=!1!==w,D=!1!==w?null===(s=w)||"auto"===s?x.FetchStrategy.PPR:x.FetchStrategy.Full:x.FetchStrategy.PPR,{href:z,as:_}=l.default.useMemo(()=>{let e=h(v);return{href:e,as:y?h(y):e}},[v,y]);R&&(r=l.default.Children.only(t));let M=R?r&&"object"==typeof r&&r.ref:T,B=l.default.useCallback(e=>(null!==F&&(N.current=(0,u.mountLinkInstance)(e,z,F,D,G,j)),()=>{N.current&&((0,u.unmountLinkForCurrentNavigation)(N.current),N.current=null),(0,u.unmountPrefetchableInstance)(e)}),[G,z,F,D,j]),q={ref:(0,o.useMergedRef)(B,M),onClick(e){R||"function"!=typeof P||P(e),R&&r.props&&"function"==typeof r.props.onClick&&r.props.onClick(e),F&&(e.defaultPrevented||function(e,s,t,r,a,n,i){let{nodeName:o}=e.currentTarget;if(!("A"===o.toUpperCase()&&function(e){let s=e.currentTarget.getAttribute("target");return s&&"_self"!==s||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey||e.nativeEvent&&2===e.nativeEvent.which}(e)||e.currentTarget.hasAttribute("download"))){if(!(0,m.isLocalURL)(s)){a&&(e.preventDefault(),location.replace(s));return}if(e.preventDefault(),i){let e=!1;if(i({preventDefault:()=>{e=!0}}),e)return}l.default.startTransition(()=>{(0,p.dispatchNavigateAction)(t||s,a?"replace":"push",null==n||n,r.current)})}}(e,z,_,N,I,A,k))},onMouseEnter(e){R||"function"!=typeof U||U(e),R&&r.props&&"function"==typeof r.props.onMouseEnter&&r.props.onMouseEnter(e),F&&G&&(0,u.onNavigationIntent)(e.currentTarget,!0===L)},onTouchStart:function(e){R||"function"!=typeof E||E(e),R&&r.props&&"function"==typeof r.props.onTouchStart&&r.props.onTouchStart(e),F&&G&&(0,u.onNavigationIntent)(e.currentTarget,!0===L)}};return(0,d.isAbsoluteUrl)(_)?q.href=_:R&&!S&&("a"!==r.type||"href"in r.props)||(q.href=(0,c.addBasePath)(_)),n=R?l.default.cloneElement(r,q):(0,a.jsx)("a",{...O,...q,children:t}),(0,a.jsx)(g.Provider,{value:f,children:n})}let g=(0,l.createContext)(u.IDLE_LINK_STATUS),j=()=>(0,l.useContext)(g);("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),s.exports=t.default)},96633,e=>{"use strict";e.s(["default",()=>eI],96633);var s=e.i(43476),t=e.i(71645),r=e.i(26732),a=e.i(22016),l=e.i(81949),n=e.i(55436),i=e.i(16715),o=e.i(79002),d=e.i(88511),c=e.i(27612),u=e.i(86536),m=e.i(61911),p=e.i(63488),x=e.i(43432),h=e.i(87316);let f=(0,e.i(75254).default)("user-check",[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]);var g=e.i(60313),j=e.i(67881),N=e.i(52917),v=e.i(70065),y=e.i(23750),b=e.i(10708),w=e.i(62870),S=e.i(84614),I=e.i(70756),C=e.i(98919),A=e.i(81307);let P=A.z.object({name:A.z.string().min(1,"Name is required").max(255,"Name cannot exceed 255 characters"),username:A.z.string().min(3,"Username must be at least 3 characters").max(50,"Username cannot exceed 50 characters"),email:A.z.string().email("Invalid email address").max(255,"Email cannot exceed 255 characters"),password:A.z.string().min(6,"Password must be at least 6 characters").max(100,"Password cannot exceed 100 characters"),confirmPassword:A.z.string().min(6,"Password confirmation is required"),contact:A.z.string().max(20,"Contact cannot exceed 20 characters").optional().or(A.z.literal("")).or(A.z.null()),status:A.z.enum(["active","inactive","suspended"]).optional().default("active")}).refine(e=>e.password===e.confirmPassword,{message:"Passwords do not match",path:["confirmPassword"]}),U=A.z.object({id:A.z.string().min(1,"User ID is required"),name:A.z.string().min(1,"Name is required").max(255,"Name cannot exceed 255 characters").optional(),username:A.z.string().min(3,"Username must be at least 3 characters").max(50,"Username cannot exceed 50 characters").optional(),email:A.z.string().email("Invalid email address").max(255,"Email cannot exceed 255 characters").optional(),password:A.z.string().min(6,"Password must be at least 6 characters").max(100,"Password cannot exceed 100 characters").optional(),contact:A.z.string().max(20,"Contact cannot exceed 20 characters").optional().or(A.z.literal("")).or(A.z.null()),status:A.z.enum(["active","inactive","suspended"]).optional()});function E(e){let{children:r,onUserAdded:a}=e,[l,n]=t.useState(!1),[i,d]=t.useState(!1),[c,u]=t.useState({}),[m,h]=t.useState(!1),[f,g]=t.useState({name:"",username:"",email:"",password:"",confirmPassword:"",contact:"",status:"active"}),A=(e,s)=>{g(t=>({...t,[e]:s})),c[e]&&u(s=>({...s,[e]:""})),m&&h(!1)},U=async e=>{if(e.preventDefault(),(()=>{try{return P.parse(f),u({}),!0}catch(s){let e={};return s&&"object"==typeof s&&"errors"in s&&Array.isArray(s.errors)&&s.errors.forEach(s=>{e[s.path[0]]=s.message}),u(e),!1}})()){d(!0),u({});try{let e=await fetch("/api/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(f)}),s=await e.json();if(!e.ok){if(s.details&&Array.isArray(s.details)){let e={};s.details.forEach(s=>{e[s.path[0]]=s.message}),u(e)}else u({general:s.error||"Failed to create user"});return}h(!0),g({name:"",username:"",email:"",password:"",confirmPassword:"",contact:"",status:"active"}),setTimeout(()=>{null==a||a(),n(!1),h(!1)},1500)}catch(e){console.error("Error creating user:",e),u({general:"Failed to create user. Please try again."})}finally{d(!1)}}};return(0,s.jsxs)(N.Sheet,{open:l,onOpenChange:n,children:[(0,s.jsx)(N.SheetTrigger,{asChild:!0,children:r}),(0,s.jsxs)(N.SheetContent,{className:"w-full sm:max-w-2xl h-full flex flex-col",children:[(0,s.jsxs)(N.SheetHeader,{className:"flex-shrink-0",children:[(0,s.jsxs)(N.SheetTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(o.UserPlus,{className:"h-5 w-5"}),"Add New User"]}),(0,s.jsx)(N.SheetDescription,{children:"Create a new user account with appropriate permissions and access levels."})]}),(0,s.jsx)("div",{className:"flex-1 overflow-y-auto py-4",children:(0,s.jsxs)(v.Card,{className:"shadow-lg",children:[(0,s.jsx)(v.CardHeader,{className:"pb-6",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold",children:"User Information"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Fill in the details below to add a new user"})]})}),(0,s.jsx)(v.CardContent,{children:(0,s.jsxs)("form",{onSubmit:U,className:"flex flex-col gap-6",children:[c.general&&(0,s.jsx)("div",{className:"p-3 text-sm text-red-600 bg-red-50 border border-red-200 rounded-md",children:c.general}),m&&(0,s.jsx)("div",{className:"p-3 text-sm text-green-600 bg-green-50 border border-green-200 rounded-md",children:"User created successfully!"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h4",{className:"text-md font-semibold text-foreground border-b pb-2",children:"User Details"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(b.Label,{htmlFor:"name",className:"text-sm font-medium flex items-center gap-2",children:[(0,s.jsx)(S.User,{className:"h-4 w-4"}),"Full Name *"]}),(0,s.jsx)(y.Input,{id:"name",placeholder:"Enter full name",className:"h-11",value:f.name,onChange:e=>A("name",e.target.value),required:!0}),c.name&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:c.name})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(b.Label,{htmlFor:"username",className:"text-sm font-medium flex items-center gap-2",children:[(0,s.jsx)(S.User,{className:"h-4 w-4"}),"Username *"]}),(0,s.jsx)(y.Input,{id:"username",placeholder:"Enter username",className:"h-11",value:f.username,onChange:e=>A("username",e.target.value),required:!0}),c.username&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:c.username})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(b.Label,{htmlFor:"email",className:"text-sm font-medium flex items-center gap-2",children:[(0,s.jsx)(p.Mail,{className:"h-4 w-4"}),"Email Address *"]}),(0,s.jsx)(y.Input,{id:"email",type:"email",placeholder:"Enter email address",className:"h-11",value:f.email,onChange:e=>A("email",e.target.value),required:!0}),c.email&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:c.email})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(b.Label,{htmlFor:"contact",className:"text-sm font-medium flex items-center gap-2",children:[(0,s.jsx)(x.Phone,{className:"h-4 w-4"}),"Contact Number"]}),(0,s.jsx)(y.Input,{id:"contact",placeholder:"Enter contact number",className:"h-11",value:f.contact,onChange:e=>A("contact",e.target.value)}),c.contact&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:c.contact})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(b.Label,{htmlFor:"status",className:"text-sm font-medium flex items-center gap-2",children:[(0,s.jsx)(C.Shield,{className:"h-4 w-4"}),"Status"]}),(0,s.jsxs)(w.Select,{value:f.status,onValueChange:e=>A("status",e),children:[(0,s.jsx)(w.SelectTrigger,{className:"h-11",children:(0,s.jsx)(w.SelectValue,{placeholder:"Select status"})}),(0,s.jsxs)(w.SelectContent,{children:[(0,s.jsx)(w.SelectItem,{value:"active",children:"Active"}),(0,s.jsx)(w.SelectItem,{value:"inactive",children:"Inactive"}),(0,s.jsx)(w.SelectItem,{value:"suspended",children:"Suspended"})]})]}),c.status&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:c.status})]})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h4",{className:"text-md font-semibold text-foreground border-b pb-2",children:"Security"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(b.Label,{htmlFor:"password",className:"text-sm font-medium flex items-center gap-2",children:[(0,s.jsx)(I.Lock,{className:"h-4 w-4"}),"Password *"]}),(0,s.jsx)(y.Input,{id:"password",type:"password",placeholder:"Enter password (min 6 characters)",className:"h-11",value:f.password,onChange:e=>A("password",e.target.value),required:!0}),c.password&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:c.password})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(b.Label,{htmlFor:"confirmPassword",className:"text-sm font-medium flex items-center gap-2",children:[(0,s.jsx)(I.Lock,{className:"h-4 w-4"}),"Confirm Password *"]}),(0,s.jsx)(y.Input,{id:"confirmPassword",type:"password",placeholder:"Confirm password",className:"h-11",value:f.confirmPassword,onChange:e=>A("confirmPassword",e.target.value),required:!0}),c.confirmPassword&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:c.confirmPassword})]})]})]}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 pt-4",children:[(0,s.jsx)(j.Button,{type:"submit",className:"flex-1 h-11",disabled:i,children:i?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Creating User..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.UserPlus,{className:"h-4 w-4 mr-2"}),"Create User"]})}),(0,s.jsx)(j.Button,{type:"button",variant:"outline",className:"flex-1 h-11",onClick:()=>{n(!1),g({name:"",username:"",email:"",password:"",confirmPassword:"",contact:"",status:"active"}),u({}),h(!1)},disabled:i,children:"Cancel"})]})]})})]})})]})]})}A.z.object({userId:A.z.string().min(1,"User ID is required"),regionId:A.z.number().int().positive().optional().or(A.z.null()),universityId:A.z.number().int().positive().optional().or(A.z.null()),smallGroupId:A.z.number().int().positive().optional().or(A.z.null()),alumniGroupId:A.z.number().int().positive().optional().or(A.z.null()),scope:A.z.enum(["superadmin","national","region","university","smallgroup","alumnismallgroup"]).default("superadmin")});var R=e.i(30030),k=e.i(20783),T=e.i(26999),L=e.i(81140),O=e.i(91918),F="AlertDialog",[G,D]=(0,R.createContextScope)(F,[T.createDialogScope]),z=(0,T.createDialogScope)(),_=e=>{let{__scopeAlertDialog:t,...r}=e,a=z(t);return(0,s.jsx)(T.Root,{...a,...r,modal:!0})};_.displayName=F,t.forwardRef((e,t)=>{let{__scopeAlertDialog:r,...a}=e,l=z(r);return(0,s.jsx)(T.Trigger,{...l,...a,ref:t})}).displayName="AlertDialogTrigger";var M=e=>{let{__scopeAlertDialog:t,...r}=e,a=z(t);return(0,s.jsx)(T.Portal,{...a,...r})};M.displayName="AlertDialogPortal";var B=t.forwardRef((e,t)=>{let{__scopeAlertDialog:r,...a}=e,l=z(r);return(0,s.jsx)(T.Overlay,{...l,...a,ref:t})});B.displayName="AlertDialogOverlay";var q="AlertDialogContent",[V,H]=G(q),K=(0,O.createSlottable)("AlertDialogContent"),W=t.forwardRef((e,r)=>{let{__scopeAlertDialog:a,children:l,...n}=e,i=z(a),o=t.useRef(null),d=(0,k.useComposedRefs)(r,o),c=t.useRef(null);return(0,s.jsx)(T.WarningProvider,{contentName:q,titleName:J,docsSlug:"alert-dialog",children:(0,s.jsx)(V,{scope:a,cancelRef:c,children:(0,s.jsxs)(T.Content,{role:"alertdialog",...i,...n,ref:d,onOpenAutoFocus:(0,L.composeEventHandlers)(n.onOpenAutoFocus,e=>{var s;e.preventDefault(),null==(s=c.current)||s.focus({preventScroll:!0})}),onPointerDownOutside:e=>e.preventDefault(),onInteractOutside:e=>e.preventDefault(),children:[(0,s.jsx)(K,{children:l}),(0,s.jsx)(es,{contentRef:o})]})})})});W.displayName=q;var J="AlertDialogTitle",Q=t.forwardRef((e,t)=>{let{__scopeAlertDialog:r,...a}=e,l=z(r);return(0,s.jsx)(T.Title,{...l,...a,ref:t})});Q.displayName=J;var Y="AlertDialogDescription",Z=t.forwardRef((e,t)=>{let{__scopeAlertDialog:r,...a}=e,l=z(r);return(0,s.jsx)(T.Description,{...l,...a,ref:t})});Z.displayName=Y;var X=t.forwardRef((e,t)=>{let{__scopeAlertDialog:r,...a}=e,l=z(r);return(0,s.jsx)(T.Close,{...l,...a,ref:t})});X.displayName="AlertDialogAction";var $="AlertDialogCancel",ee=t.forwardRef((e,t)=>{let{__scopeAlertDialog:r,...a}=e,{cancelRef:l}=H($,r),n=z(r),i=(0,k.useComposedRefs)(t,l);return(0,s.jsx)(T.Close,{...n,...a,ref:i})});ee.displayName=$;var es=e=>{let{contentRef:s}=e,r="`".concat(q,"` requires a description for the component to be accessible for screen reader users.\n\nYou can add a description to the `").concat(q,"` by passing a `").concat(Y,"` component as a child, which also benefits sighted users by adding visible context to the dialog.\n\nAlternatively, you can use your own component as a description by assigning it an `id` and passing the same value to the `aria-describedby` prop in `").concat(q,"`. If the description is confusing or duplicative for sighted users, you can use the `@radix-ui/react-visually-hidden` primitive as a wrapper around your description component.\n\nFor more information, see https://radix-ui.com/primitives/docs/components/alert-dialog");return t.useEffect(()=>{var e;document.getElementById(null==(e=s.current)?void 0:e.getAttribute("aria-describedby"))||console.warn(r)},[r,s]),null},et=e.i(47163);let er=t.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(B,{className:(0,et.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",r),...a,ref:t})});er.displayName=B.displayName;let ea=t.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsxs)(M,{children:[(0,s.jsx)(er,{}),(0,s.jsx)(W,{ref:t,className:(0,et.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",r),...a})]})});ea.displayName=W.displayName;let el=e=>{let{className:t,...r}=e;return(0,s.jsx)("div",{className:(0,et.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...r})};el.displayName="AlertDialogHeader";let en=e=>{let{className:t,...r}=e;return(0,s.jsx)("div",{className:(0,et.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...r})};en.displayName="AlertDialogFooter";let ei=t.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(Q,{ref:t,className:(0,et.cn)("text-lg font-semibold",r),...a})});ei.displayName=Q.displayName;let eo=t.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(Z,{ref:t,className:(0,et.cn)("text-sm text-muted-foreground",r),...a})});eo.displayName=Z.displayName;let ed=t.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(X,{ref:t,className:(0,et.cn)((0,j.buttonVariants)(),r),...a})});ed.displayName=X.displayName;let ec=t.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(ee,{ref:t,className:(0,et.cn)((0,j.buttonVariants)({variant:"outline"}),"mt-2 sm:mt-0",r),...a})});ec.displayName=ee.displayName;var eu=e.i(78894);function em(e){let{isOpen:t,onClose:r,onConfirm:a,userName:l,isLoading:n=!1}=e;return(0,s.jsx)(_,{open:t,onOpenChange:r,children:(0,s.jsxs)(ea,{className:"sm:max-w-md",children:[(0,s.jsxs)(el,{children:[(0,s.jsxs)(ei,{className:"flex items-center gap-2",children:[(0,s.jsx)(eu.AlertTriangle,{className:"h-5 w-5 text-destructive"}),"Delete User"]}),(0,s.jsxs)(eo,{className:"text-left",children:["Are you sure you want to delete ",(0,s.jsx)("span",{className:"font-semibold text-foreground",children:l}),"? This action cannot be undone and will permanently remove the user and all associated data."]})]}),(0,s.jsxs)(en,{className:"flex-col sm:flex-row gap-2",children:[(0,s.jsx)(ec,{onClick:r,disabled:n,className:"w-full sm:w-auto",children:"Cancel"}),(0,s.jsx)(ed,{onClick:a,disabled:n,className:"w-full sm:w-auto bg-destructive text-destructive-foreground hover:bg-destructive/90",children:n?(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Deleting..."]}):(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(c.Trash2,{className:"h-4 w-4"}),"Delete User"]})})]})]})})}function ep(e){let{user:r,onUserUpdated:a,isOpen:l,onClose:n}=e,[i,o]=t.useState(!1),[c,u]=t.useState({}),[m,h]=t.useState(!1),[f,g]=t.useState({id:"",name:"",username:"",email:"",password:"",contact:"",status:"active"});t.useEffect(()=>{r&&g({id:r.id,name:r.name||"",username:r.username||"",email:r.email||"",password:"",contact:r.contact||"",status:r.status||"active"})},[r]);let A=(e,s)=>{g(t=>({...t,[e]:s})),c[e]&&u(s=>({...s,[e]:""})),m&&h(!1)},P=async e=>{if(e.preventDefault(),(()=>{try{return U.parse(f),u({}),!0}catch(s){let e={};return s&&"object"==typeof s&&"errors"in s&&Array.isArray(s.errors)&&s.errors.forEach(s=>{e[s.path[0]]=s.message}),u(e),!1}})()){o(!0),u({});try{let e=await fetch("/api/users",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(f)}),s=await e.json();if(!e.ok){if(s.details&&Array.isArray(s.details)){let e={};s.details.forEach(s=>{e[s.path[0]]=s.message}),u(e)}else u({general:s.error||"Failed to update user"});return}h(!0),setTimeout(()=>{null==a||a(),n(),h(!1)},1500)}catch(e){console.error("Error updating user:",e),u({general:"Failed to update user. Please try again."})}finally{o(!1)}}},E=()=>{n(),g({id:"",name:"",username:"",email:"",password:"",contact:"",status:"active"}),u({}),h(!1)};return r?(0,s.jsx)(N.Sheet,{open:l,onOpenChange:E,children:(0,s.jsxs)(N.SheetContent,{className:"w-full sm:max-w-2xl h-full flex flex-col",children:[(0,s.jsxs)(N.SheetHeader,{className:"flex-shrink-0",children:[(0,s.jsxs)(N.SheetTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(d.Edit,{className:"h-5 w-5"}),"Edit User"]}),(0,s.jsx)(N.SheetDescription,{children:"Update user information and permissions."})]}),(0,s.jsx)("div",{className:"flex-1 overflow-y-auto py-4",children:(0,s.jsxs)(v.Card,{className:"shadow-lg",children:[(0,s.jsx)(v.CardHeader,{className:"pb-6",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold",children:"User Information"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Update the details below"})]})}),(0,s.jsx)(v.CardContent,{children:(0,s.jsxs)("form",{onSubmit:P,className:"flex flex-col gap-6",children:[c.general&&(0,s.jsx)("div",{className:"p-3 text-sm text-red-600 bg-red-50 border border-red-200 rounded-md",children:c.general}),m&&(0,s.jsx)("div",{className:"p-3 text-sm text-green-600 bg-green-50 border border-green-200 rounded-md",children:"User updated successfully!"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h4",{className:"text-md font-semibold text-foreground border-b pb-2",children:"User Details"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(b.Label,{htmlFor:"name",className:"text-sm font-medium flex items-center gap-2",children:[(0,s.jsx)(S.User,{className:"h-4 w-4"}),"Full Name *"]}),(0,s.jsx)(y.Input,{id:"name",placeholder:"Enter full name",className:"h-11",value:f.name,onChange:e=>A("name",e.target.value),required:!0}),c.name&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:c.name})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(b.Label,{htmlFor:"username",className:"text-sm font-medium flex items-center gap-2",children:[(0,s.jsx)(S.User,{className:"h-4 w-4"}),"Username *"]}),(0,s.jsx)(y.Input,{id:"username",placeholder:"Enter username",className:"h-11",value:f.username,onChange:e=>A("username",e.target.value),required:!0}),c.username&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:c.username})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(b.Label,{htmlFor:"email",className:"text-sm font-medium flex items-center gap-2",children:[(0,s.jsx)(p.Mail,{className:"h-4 w-4"}),"Email Address *"]}),(0,s.jsx)(y.Input,{id:"email",type:"email",placeholder:"Enter email address",className:"h-11",value:f.email,onChange:e=>A("email",e.target.value),required:!0}),c.email&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:c.email})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(b.Label,{htmlFor:"contact",className:"text-sm font-medium flex items-center gap-2",children:[(0,s.jsx)(x.Phone,{className:"h-4 w-4"}),"Contact Number"]}),(0,s.jsx)(y.Input,{id:"contact",placeholder:"Enter contact number",className:"h-11",value:f.contact,onChange:e=>A("contact",e.target.value)}),c.contact&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:c.contact})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(b.Label,{htmlFor:"status",className:"text-sm font-medium flex items-center gap-2",children:[(0,s.jsx)(C.Shield,{className:"h-4 w-4"}),"Status"]}),(0,s.jsxs)(w.Select,{value:f.status,onValueChange:e=>A("status",e),children:[(0,s.jsx)(w.SelectTrigger,{className:"h-11",children:(0,s.jsx)(w.SelectValue,{placeholder:"Select status"})}),(0,s.jsxs)(w.SelectContent,{children:[(0,s.jsx)(w.SelectItem,{value:"active",children:"Active"}),(0,s.jsx)(w.SelectItem,{value:"inactive",children:"Inactive"}),(0,s.jsx)(w.SelectItem,{value:"suspended",children:"Suspended"})]})]}),c.status&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:c.status})]})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h4",{className:"text-md font-semibold text-foreground border-b pb-2",children:"Security"}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(b.Label,{htmlFor:"password",className:"text-sm font-medium flex items-center gap-2",children:[(0,s.jsx)(I.Lock,{className:"h-4 w-4"}),"New Password (leave blank to keep current password)"]}),(0,s.jsx)(y.Input,{id:"password",type:"password",placeholder:"Enter new password (min 6 characters)",className:"h-11",value:f.password,onChange:e=>A("password",e.target.value)}),c.password&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:c.password})]})]}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 pt-4",children:[(0,s.jsx)(j.Button,{type:"submit",className:"flex-1 h-11",disabled:i,children:i?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Updating User..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(d.Edit,{className:"h-4 w-4 mr-2"}),"Update User"]})}),(0,s.jsx)(j.Button,{type:"button",variant:"outline",className:"flex-1 h-11",onClick:E,disabled:i,children:"Cancel"})]})]})})]})})]})}):null}var ex=e.i(46897),eh=e.i(7486),ef=e.i(32095);function eg(e){var r,a,n,i,o;let{children:d,userId:c,userName:u,existingRole:p,onRoleAssigned:x}=e,[h,f]=t.useState(!1),[g,y]=t.useState(!1),[S,I]=t.useState({}),[A,P]=t.useState(!1),[U,E]=t.useState([]),[R,k]=t.useState([]),[T,L]=t.useState([]),[O,F]=t.useState([]),[G,D]=t.useState({userId:c,regionId:(null==p||null==(r=p.regionId)?void 0:r.toString())||"",universityId:(null==p||null==(a=p.universityId)?void 0:a.toString())||"",smallGroupId:(null==p||null==(n=p.smallGroupId)?void 0:n.toString())||"",alumniGroupId:(null==p||null==(i=p.alumniGroupId)?void 0:i.toString())||"",scope:(null==p?void 0:p.scope)||"superadmin"});t.useEffect(()=>{z()},[]),t.useEffect(()=>{G.regionId?(_(Number(G.regionId)),B(Number(G.regionId))):(k([]),F([]),D(e=>({...e,universityId:"",alumniGroupId:""})))},[G.regionId]),t.useEffect(()=>{G.universityId&&G.regionId?M(Number(G.regionId),Number(G.universityId)):(L([]),D(e=>({...e,smallGroupId:""})))},[G.universityId,G.regionId]);let z=async()=>{try{let e=await l.default.get("/api/regions");e.data&&Array.isArray(e.data)?E(e.data):console.error("Unexpected regions response format:",e.data)}catch(e){console.error("Error fetching regions:",e)}},_=async e=>{try{let s=await l.default.get("/api/universities?regionId=".concat(e));s.data&&Array.isArray(s.data)&&k(s.data)}catch(e){console.error("Error fetching universities:",e)}},M=async(e,s)=>{try{let t=await l.default.get("/api/small-groups?regionId=".concat(e,"&universityId=").concat(s));t.data&&Array.isArray(t.data)&&L(t.data)}catch(e){console.error("Error fetching small groups:",e)}},B=async e=>{try{let s=await l.default.get("/api/alumni-small-groups?regionId=".concat(e));s.data&&Array.isArray(s.data)&&F(s.data)}catch(e){console.error("Error fetching alumni groups:",e)}},q=(e,s)=>{"scope"===e?D(e=>({...e,scope:s,regionId:"",universityId:"",smallGroupId:"",alumniGroupId:""})):"regionId"===e?D(e=>({...e,regionId:s,universityId:"",smallGroupId:"",alumniGroupId:""})):"universityId"===e?D(e=>({...e,universityId:s,smallGroupId:""})):D(t=>({...t,[e]:s})),S[e]&&I(s=>({...s,[e]:""})),A&&P(!1)},V=async e=>{if(e.preventDefault(),(()=>{let e={};return G.scope||(e.scope="Role scope is required"),"region"!==G.scope||G.regionId||(e.regionId="Region is required for region scope"),"university"!==G.scope||G.universityId||(e.universityId="University is required for university scope"),"smallgroup"!==G.scope||G.smallGroupId||(e.smallGroupId="Small group is required for small group scope"),"alumnismallgroup"!==G.scope||G.alumniGroupId||(e.alumniGroupId="Alumni small group is required for alumni small group scope"),I(e),0===Object.keys(e).length})()){y(!0),I({});try{let e,s={userId:G.userId,scope:G.scope,regionId:G.regionId?Number(G.regionId):null,universityId:G.universityId?Number(G.universityId):null,smallGroupId:G.smallGroupId?Number(G.smallGroupId):null,alumniGroupId:G.alumniGroupId?Number(G.alumniGroupId):null};e=p?await l.default.put("/api/user-roles",{id:p.id,...s}):await l.default.post("/api/user-roles",s),(200===e.status||201===e.status)&&(P(!0),setTimeout(()=>{null==x||x(),f(!1),P(!1),D({userId:c,regionId:"",universityId:"",smallGroupId:"",alumniGroupId:"",scope:"superadmin"})},1500))}catch(e){if(console.error("Error assigning role:",e),e&&"object"==typeof e&&"response"in e){var s,t,r,a,n;if(console.error("Error response:",null==(s=e.response)?void 0:s.data),(null==(r=e.response)||null==(t=r.data)?void 0:t.details)&&Array.isArray(e.response.data.details)){let s={};e.response.data.details.forEach(e=>{s[e.path[0]]=e.message}),I(s)}else I({general:(null==(n=e.response)||null==(a=n.data)?void 0:a.error)||"Failed to assign role. Please try again."})}else I({general:"Failed to assign role. Please try again."})}finally{y(!1)}}},H=()=>{var e,s,t,r;return"region"===G.scope&&G.regionId?null==(e=U.find(e=>e.id.toString()===G.regionId))?void 0:e.name:"university"===G.scope&&G.universityId?null==(s=R.find(e=>e.id.toString()===G.universityId))?void 0:s.name:"smallgroup"===G.scope&&G.smallGroupId?null==(t=T.find(e=>e.id.toString()===G.smallGroupId))?void 0:t.name:"alumnismallgroup"===G.scope&&G.alumniGroupId?null==(r=O.find(e=>e.id.toString()===G.alumniGroupId))?void 0:r.name:null},K=[{value:"superadmin",label:"Super Admin"},{value:"national",label:"National"},{value:"region",label:"Region"},{value:"university",label:"University"},{value:"smallgroup",label:"Small Group"},{value:"alumnismallgroup",label:"Alumni Small Group"}];return(0,s.jsxs)(N.Sheet,{open:h,onOpenChange:f,children:[(0,s.jsx)(N.SheetTrigger,{asChild:!0,children:d}),(0,s.jsxs)(N.SheetContent,{className:"w-full sm:max-w-2xl overflow-y-auto",children:[(0,s.jsxs)(N.SheetHeader,{className:"sticky top-0 bg-background z-10 pb-4",children:[(0,s.jsxs)(N.SheetTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(C.Shield,{className:"h-5 w-5"}),p?"Update Role for":"Assign Role to"," ",u]}),(0,s.jsx)(N.SheetDescription,{children:p?"Update user permissions and access scope.":"Configure user permissions and access scope for this user."})]}),(0,s.jsx)("div",{className:"flex-1 overflow-y-auto",children:(0,s.jsxs)(v.Card,{className:"shadow-lg",children:[(0,s.jsx)(v.CardHeader,{className:"pb-6",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold",children:"Role Assignment"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Select the appropriate scope and permission level"})]})}),(0,s.jsx)(v.CardContent,{children:(0,s.jsxs)("form",{onSubmit:V,className:"flex flex-col gap-6",children:[S.general&&(0,s.jsx)("div",{className:"p-3 text-sm text-red-600 bg-red-50 border border-red-200 rounded-md",children:S.general}),A&&(0,s.jsx)("div",{className:"p-3 text-sm text-green-600 bg-green-50 border border-green-200 rounded-md",children:p?"Role updated successfully!":"Role assigned successfully!"}),(0,s.jsxs)("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[(0,s.jsx)("h4",{className:"font-medium text-gray-900 dark:text-white mb-2",children:"User Information"}),(0,s.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Name:"})," ",u]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"User ID:"})," ",c]})]})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h4",{className:"text-md font-semibold text-foreground border-b pb-2",children:"Role Scope"}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(b.Label,{htmlFor:"scope",className:"text-sm font-medium flex items-center gap-2",children:[(0,s.jsx)(C.Shield,{className:"h-4 w-4"}),"Role Scope *"]}),(0,s.jsxs)(w.Select,{value:G.scope,onValueChange:e=>q("scope",e),children:[(0,s.jsx)(w.SelectTrigger,{className:"h-11",children:(0,s.jsx)(w.SelectValue,{placeholder:"Select role scope"})}),(0,s.jsx)(w.SelectContent,{children:K.map(e=>(0,s.jsx)(w.SelectItem,{value:e.value,children:e.label},e.value))})]}),(0,s.jsx)("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:{superadmin:"Full system access across all entities",national:"National level access and management",region:"Access limited to specific region",university:"Access limited to specific university",smallgroup:"Access limited to specific small group",alumnismallgroup:"Access limited to specific alumni small group"}[G.scope]||""}),S.scope&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:S.scope})]})]}),("region"===G.scope||"university"===G.scope||"smallgroup"===G.scope||"alumnismallgroup"===G.scope)&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(b.Label,{htmlFor:"regionId",className:"text-sm font-medium flex items-center gap-2",children:[(0,s.jsx)(ex.MapPin,{className:"h-4 w-4"}),"Region","region"===G.scope?" *":""]}),(0,s.jsxs)(w.Select,{value:G.regionId,onValueChange:e=>q("regionId",e),children:[(0,s.jsx)(w.SelectTrigger,{className:"h-11",children:(0,s.jsx)(w.SelectValue,{placeholder:"Select region"})}),(0,s.jsxs)(w.SelectContent,{children:[console.log("Rendering regions in dropdown:",U),U.map(e=>(0,s.jsx)(w.SelectItem,{value:e.id.toString(),children:e.name},e.id))]})]}),S.regionId&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:S.regionId})]}),("university"===G.scope||"smallgroup"===G.scope)&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(b.Label,{htmlFor:"universityId",className:"text-sm font-medium flex items-center gap-2",children:[(0,s.jsx)(eh.Building2,{className:"h-4 w-4"}),"University","university"===G.scope?" *":""]}),(0,s.jsxs)(w.Select,{value:G.universityId,onValueChange:e=>q("universityId",e),children:[(0,s.jsx)(w.SelectTrigger,{className:"h-11",children:(0,s.jsx)(w.SelectValue,{placeholder:"Select university"})}),(0,s.jsx)(w.SelectContent,{children:R.map(e=>(0,s.jsx)(w.SelectItem,{value:e.id.toString(),children:e.name},e.id))})]}),S.universityId&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:S.universityId})]}),"smallgroup"===G.scope&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(b.Label,{htmlFor:"smallGroupId",className:"text-sm font-medium flex items-center gap-2",children:[(0,s.jsx)(m.Users,{className:"h-4 w-4"}),"Small Group *"]}),(0,s.jsxs)(w.Select,{value:G.smallGroupId,onValueChange:e=>q("smallGroupId",e),children:[(0,s.jsx)(w.SelectTrigger,{className:"h-11",children:(0,s.jsx)(w.SelectValue,{placeholder:"Select small group"})}),(0,s.jsx)(w.SelectContent,{children:T.map(e=>(0,s.jsx)(w.SelectItem,{value:e.id.toString(),children:e.name},e.id))})]}),S.smallGroupId&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:S.smallGroupId})]}),"alumnismallgroup"===G.scope&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(b.Label,{htmlFor:"alumniGroupId",className:"text-sm font-medium flex items-center gap-2",children:[(0,s.jsx)(ef.GraduationCap,{className:"h-4 w-4"}),"Alumni Small Group *"]}),(0,s.jsxs)(w.Select,{value:G.alumniGroupId,onValueChange:e=>q("alumniGroupId",e),children:[(0,s.jsx)(w.SelectTrigger,{className:"h-11",children:(0,s.jsx)(w.SelectValue,{placeholder:"Select alumni small group"})}),(0,s.jsx)(w.SelectContent,{children:O.map(e=>(0,s.jsx)(w.SelectItem,{value:e.id.toString(),children:e.name},e.id))})]}),S.alumniGroupId&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:S.alumniGroupId})]}),(0,s.jsxs)("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[(0,s.jsx)("h4",{className:"font-medium text-blue-900 dark:text-blue-100 mb-2",children:"Role Summary"}),(0,s.jsxs)("div",{className:"text-sm text-blue-800 dark:text-blue-200 space-y-1",children:[(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"User:"})," ",u]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Scope:"})," ",null==(o=K.find(e=>e.value===G.scope))?void 0:o.label]}),H()&&(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Entity:"})," ",H()]})]})]}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 pt-6 border-t",children:[(0,s.jsx)(j.Button,{type:"submit",className:"flex-1 h-11",disabled:g,children:g?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),p?"Updating Role...":"Assigning Role..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(C.Shield,{className:"h-4 w-4 mr-2"}),p?"Update Role":"Assign Role"]})}),(0,s.jsx)(j.Button,{type:"button",variant:"outline",className:"flex-1 h-11",onClick:()=>{f(!1),D({userId:c,regionId:"",universityId:"",smallGroupId:"",alumniGroupId:"",scope:"superadmin"}),I({}),P(!1)},disabled:g,children:"Cancel"})]})]})})]})})]})]})}var ej=e.i(75117),eN=e.i(69035),ev=e.i(11522);let ey={active:"Active",inactive:"Inactive",suspended:"Suspended"},eb={active:"bg-green-100 text-green-800",inactive:"bg-gray-100 text-gray-800",suspended:"bg-red-100 text-red-800"},ew={superadmin:"Super Admin",admin:"Admin",moderator:"Moderator",user:"User"},eS={superadmin:"bg-purple-100 text-purple-800",admin:"bg-blue-100 text-blue-800",moderator:"bg-yellow-100 text-yellow-800",user:"bg-gray-100 text-gray-800"};function eI(){let{data:e,status:j}=(0,r.useSession)(),[N,v]=(0,t.useState)(""),[y,b]=(0,t.useState)([]),[w,S]=(0,t.useState)(!0),[I,C]=(0,t.useState)(null),[A,P]=(0,t.useState)(1),[U]=(0,t.useState)(10),[R,k]=(0,t.useState)({isOpen:!1,userId:null,userName:""}),[T,L]=(0,t.useState)(!1),[O,F]=(0,t.useState)(null);(0,t.useEffect)(()=>{G()},[A,N,G]);let G=async()=>{try{S(!0),C(null);let e=await l.default.get("/api/users?page=".concat(A,"&limit=").concat(U,"&search=").concat(N));b(e.data.users||[])}catch(e){console.error("Error fetching users:",e),C("Failed to fetch users. Please try again.")}finally{S(!1)}},D=()=>{k({isOpen:!1,userId:null,userName:""})},z=async()=>{if(R.userId){L(!0);try{let e=await l.default.delete("/api/users?id=".concat(R.userId));200===e.status&&(b(e=>e.filter(e=>e.id!==R.userId)),D())}catch(e){console.error("Error deleting user:",e),alert("Failed to delete user. Please try again.")}finally{L(!1)}}},_=y.filter(e=>{var s,t,r,a,l,n;if(!N)return!0;let i=N.toLowerCase();return(null==(s=e.name)?void 0:s.toLowerCase().includes(i))||(null==(t=e.username)?void 0:t.toLowerCase().includes(i))||(null==(r=e.email)?void 0:r.toLowerCase().includes(i))||(null==(a=e.contact)?void 0:a.includes(N))||(null==(l=e.status)?void 0:l.toLowerCase().includes(i))||(null==(n=ey[e.status])?void 0:n.toLowerCase().includes(i))});return((0,t.useEffect)(()=>{P(1)},[N]),"loading"===j)?(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):"unauthenticated"!==j&&e?(0,s.jsxs)(ev.SidebarProvider,{children:[(0,s.jsx)(g.AppSidebar,{}),(0,s.jsxs)(ev.SidebarInset,{children:[(0,s.jsx)("header",{className:"flex h-16 shrink-0 items-center gap-2 transition-[width,height] ease-linear group-has-data-[collapsible=icon]/sidebar-wrapper:h-12",children:(0,s.jsxs)("div",{className:"flex items-center gap-2 px-4",children:[(0,s.jsx)(ev.SidebarTrigger,{className:"-ml-1"}),(0,s.jsx)(eN.Separator,{orientation:"vertical",className:"mr-2 data-[orientation=vertical]:h-4"}),(0,s.jsx)(ej.Breadcrumb,{children:(0,s.jsxs)(ej.BreadcrumbList,{children:[(0,s.jsx)(ej.BreadcrumbItem,{className:"hidden md:block",children:(0,s.jsx)(ej.BreadcrumbLink,{href:"/dashboard",children:"Dashboard"})}),(0,s.jsx)(ej.BreadcrumbSeparator,{className:"hidden md:block"}),(0,s.jsx)(ej.BreadcrumbItem,{children:(0,s.jsx)(ej.BreadcrumbLink,{href:"/links/admin/user-management",children:"Admin"})}),(0,s.jsx)(ej.BreadcrumbSeparator,{}),(0,s.jsx)(ej.BreadcrumbItem,{children:(0,s.jsx)(ej.BreadcrumbPage,{children:"User Management"})})]})})]})}),(0,s.jsx)("div",{className:"flex flex-1 flex-col gap-4 p-2 sm:p-4 pt-0",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto w-full",children:[(0,s.jsxs)("div",{className:"mb-4 sm:mb-6 lg:mb-8",children:[(0,s.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-foreground mb-1 sm:mb-2",children:"User Management"}),(0,s.jsx)("p",{className:"text-sm sm:text-base text-muted-foreground",children:"Manage system users and their permissions"})]}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 sm:gap-4 items-stretch sm:items-center justify-between mb-4 sm:mb-6",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3 flex-1",children:[(0,s.jsxs)("div",{className:"relative flex-1 max-w-md",children:[(0,s.jsx)(n.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),(0,s.jsx)("input",{type:"text",placeholder:"Search users...",value:N,onChange:e=>v(e.target.value),className:"w-full pl-10 pr-4 py-2 sm:py-2.5 bg-muted/30 border border-border/20 rounded-lg focus:ring-2 focus:ring-primary/20 focus:border-primary/50 focus:bg-muted/50 transition-all duration-200 text-foreground placeholder:text-muted-foreground text-sm sm:text-base"})]}),(0,s.jsxs)("button",{onClick:G,disabled:w,className:"flex items-center justify-center gap-2 px-3 sm:px-4 py-2 sm:py-2.5 text-foreground bg-muted/30 hover:bg-muted/50 border border-border/20 hover:border-border/40 rounded-lg transition-all duration-200 text-sm sm:text-base disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,s.jsx)(i.RefreshCw,{className:"w-4 h-4 ".concat(w?"animate-spin":"")}),(0,s.jsx)("span",{className:"hidden sm:inline",children:w?"Loading...":"Refresh"})]})]}),(0,s.jsx)(E,{onUserAdded:G,children:(0,s.jsxs)("button",{className:"flex items-center justify-center gap-2 px-4 sm:px-6 py-2 sm:py-2.5 bg-muted text-foreground hover:bg-muted/80 rounded-md transition-all duration-200 shadow-sm text-sm sm:text-base",children:[(0,s.jsx)(o.UserPlus,{className:"w-4 h-4"}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Add New User"}),(0,s.jsx)("span",{className:"sm:hidden",children:"Add User"})]})})]}),I&&(0,s.jsxs)("div",{className:"bg-destructive/10 border border-destructive/20 rounded-lg p-4 mb-6",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-destructive",children:[(0,s.jsx)("span",{className:"text-sm font-medium",children:"Error:"}),(0,s.jsx)("span",{className:"text-sm",children:I})]}),(0,s.jsx)("button",{onClick:G,className:"mt-2 text-sm text-destructive hover:text-destructive/80 underline",children:"Try again"})]}),(0,s.jsxs)("div",{className:"bg-card rounded-lg shadow-sm border border-border overflow-hidden",children:[w?(0,s.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,s.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground",children:[(0,s.jsx)(i.RefreshCw,{className:"w-4 h-4 animate-spin"}),(0,s.jsx)("span",{children:"Loading users..."})]})}):(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full min-w-[800px]",children:[(0,s.jsx)("thead",{className:"bg-muted/50 border-b border-border",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"User"}),(0,s.jsx)("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider hidden md:table-cell",children:"Contact"}),(0,s.jsx)("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider hidden lg:table-cell",children:"Roles & Permissions"}),(0,s.jsx)("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Status"}),(0,s.jsx)("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Actions"})]})}),(0,s.jsx)("tbody",{className:"bg-card divide-y divide-border",children:_.map(e=>{var t,r;return(0,s.jsxs)("tr",{className:"hover:bg-muted/50",children:[(0,s.jsx)("td",{className:"px-3 sm:px-6 py-3 sm:py-4",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"flex-shrink-0 h-8 w-8 sm:h-10 sm:w-10",children:(0,s.jsx)("div",{className:"h-8 w-8 sm:h-10 sm:w-10 rounded-full bg-muted flex items-center justify-center",children:(0,s.jsxs)("span",{className:"text-xs sm:text-sm font-medium text-muted-foreground",children:[null==(t=e.name)?void 0:t[0],null==(r=e.username)?void 0:r[0]]})})}),(0,s.jsxs)("div",{className:"ml-2 sm:ml-4 min-w-0 flex-1",children:[(0,s.jsx)("div",{className:"text-sm font-medium text-foreground truncate",children:e.name}),(0,s.jsxs)("div",{className:"text-xs sm:text-sm text-muted-foreground flex items-center gap-1 truncate",children:[(0,s.jsxs)("span",{children:["@",e.username]}),(0,s.jsx)("span",{children:""}),(0,s.jsx)("span",{children:e.id})]}),(0,s.jsxs)("div",{className:"md:hidden mt-1 space-y-1",children:[(0,s.jsxs)("div",{className:"text-xs text-foreground flex items-center gap-1",children:[(0,s.jsx)(p.Mail,{className:"w-3 h-3"}),(0,s.jsx)("span",{className:"truncate",children:e.email})]}),e.contact&&(0,s.jsxs)("div",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[(0,s.jsx)(x.Phone,{className:"w-3 h-3"}),(0,s.jsx)("span",{children:e.contact})]})]})]})]})}),(0,s.jsxs)("td",{className:"px-3 sm:px-6 py-3 sm:py-4 whitespace-nowrap hidden md:table-cell",children:[(0,s.jsxs)("div",{className:"text-sm text-foreground flex items-center gap-1",children:[(0,s.jsx)(p.Mail,{className:"w-3 h-3"}),(0,s.jsx)("span",{className:"truncate max-w-[200px]",children:e.email})]}),e.contact&&(0,s.jsxs)("div",{className:"text-sm text-muted-foreground flex items-center gap-1",children:[(0,s.jsx)(x.Phone,{className:"w-3 h-3"}),(0,s.jsx)("span",{children:e.contact})]})]}),(0,s.jsx)("td",{className:"px-3 sm:px-6 py-3 sm:py-4 whitespace-nowrap hidden lg:table-cell",children:(0,s.jsx)("div",{className:"space-y-1",children:e.userrole&&e.userrole.length>0?e.userrole.map((e,t)=>(0,s.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,s.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full w-fit ".concat(eS[e.scope]),children:ew[e.scope]}),e.region&&(0,s.jsxs)("span",{className:"text-xs text-muted-foreground",children:["Region: ",e.region.name]}),e.university&&(0,s.jsxs)("span",{className:"text-xs text-muted-foreground",children:["University: ",e.university.name]}),e.smallgroup&&(0,s.jsxs)("span",{className:"text-xs text-muted-foreground",children:["Small Group: ",e.smallgroup.name]}),e.alumnismallgroup&&(0,s.jsxs)("span",{className:"text-xs text-muted-foreground",children:["Alumni Group: ",e.alumnismallgroup.name]})]},t)):(0,s.jsx)("span",{className:"text-xs text-muted-foreground",children:"No roles assigned"})})}),(0,s.jsx)("td",{className:"px-3 sm:px-6 py-3 sm:py-4",children:(0,s.jsxs)("div",{className:"flex flex-col gap-1 sm:gap-2",children:[(0,s.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full w-fit ".concat(eb[e.status]),children:ey[e.status]}),(0,s.jsxs)("div",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[(0,s.jsx)(h.Calendar,{className:"w-3 h-3"}),(0,s.jsx)("span",{children:new Date(e.createdAt).toLocaleDateString()})]})]})}),(0,s.jsx)("td",{className:"px-3 sm:px-6 py-3 sm:py-4 text-sm font-medium",children:(0,s.jsxs)("div",{className:"flex items-center gap-1 sm:gap-2",children:[(0,s.jsx)("button",{className:"text-primary hover:text-primary/80 p-1 rounded",title:"View",children:(0,s.jsx)(u.Eye,{className:"w-4 h-4"})}),(0,s.jsx)("button",{onClick:()=>{F(e)},className:"text-muted-foreground hover:text-foreground p-1 rounded",title:"Edit",children:(0,s.jsx)(d.Edit,{className:"w-4 h-4"})}),(0,s.jsx)(eg,{userId:e.id,userName:e.name||e.username,onRoleAssigned:G,children:(0,s.jsx)("button",{className:"text-blue-600 hover:text-blue-700 p-1 rounded",title:"Assign Role",children:(0,s.jsx)(f,{className:"w-4 h-4"})})}),(0,s.jsx)("button",{onClick:()=>{k({isOpen:!0,userId:e.id,userName:e.name||e.username})},className:"text-destructive hover:text-destructive/80 p-1 rounded",title:"Delete",children:(0,s.jsx)(c.Trash2,{className:"w-4 h-4"})})]})})]},e.id)})})]})}),!w&&0===_.length&&!I&&(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center py-12",children:[(0,s.jsx)(m.Users,{className:"w-12 h-12 text-muted-foreground mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-medium text-foreground mb-2",children:"No users found"}),(0,s.jsx)("p",{className:"text-muted-foreground text-center mb-4",children:N?"No users match your search criteria.":"No users have been added yet."}),!N&&(0,s.jsx)(E,{onUserAdded:G,children:(0,s.jsxs)("button",{className:"flex items-center gap-2 px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors",children:[(0,s.jsx)(o.UserPlus,{className:"w-4 h-4"}),"Add First User"]})})]})]})]})})]}),(0,s.jsx)(em,{isOpen:R.isOpen,onClose:D,onConfirm:z,userName:R.userName,isLoading:T}),(0,s.jsx)(ep,{user:O,onUserUpdated:G,isOpen:null!==O,onClose:()=>{F(null)}})]}):(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Access Denied"}),(0,s.jsx)("p",{className:"text-muted-foreground mb-4",children:"You need to be logged in to access this page."}),(0,s.jsx)(a.default,{href:"/",className:"text-primary hover:underline",children:"Go to Login"})]})})}}]);