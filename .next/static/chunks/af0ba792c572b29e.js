(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,10133,e=>{"use strict";e.s(["default",()=>F],10133);var t=e.i(43476),s=e.i(71645),a=e.i(7233),r=e.i(87316),l=e.i(16715),n=e.i(60313),i=e.i(70065),d=e.i(62870),c=e.i(10708),o=e.i(46897),u=e.i(7486),m=e.i(61911),x=e.i(32095);function h(e){let{onScopeChange:a}=e,[r,l]=s.useState([]),[n,h]=s.useState([]),[p,g]=s.useState([]),[j,v]=s.useState([]),[f,b]=s.useState(""),[N,S]=s.useState(""),[y,w]=s.useState(""),[C,I]=s.useState("");s.useEffect(()=>{k()},[]),s.useEffect(()=>{f?(E(Number(f)),F(Number(f))):(h([]),v([]),S(""),I(""))},[f]),s.useEffect(()=>{N?A(Number(N)):(g([]),w(""))},[N]),s.useEffect(()=>{a({regionId:f,universityId:N,smallGroupId:y,alumniGroupId:C})},[f,N,y,C,a]);let k=async()=>{try{let e=await fetch("/api/regions"),t=await e.json();l(t)}catch(e){console.error("Error fetching regions:",e)}},E=async e=>{try{let t=await fetch("/api/universities?regionId=".concat(e)),s=await t.json();h(s)}catch(e){console.error("Error fetching universities:",e)}},A=async e=>{try{let t=await fetch("/api/small-groups?universityId=".concat(e)),s=await t.json();g(s)}catch(e){console.error("Error fetching small groups:",e)}},F=async e=>{try{let t=await fetch("/api/alumni-small-groups?regionId=".concat(e)),s=await t.json();v(s)}catch(e){console.error("Error fetching alumni groups:",e)}};return(0,t.jsxs)(i.Card,{className:"mb-6",children:[(0,t.jsx)(i.CardHeader,{className:"pb-4",children:(0,t.jsx)(i.CardTitle,{className:"text-lg font-semibold text-foreground",children:"Super Admin Scope Selection"})}),(0,t.jsx)(i.CardContent,{children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(c.Label,{htmlFor:"region",className:"text-sm font-medium flex items-center gap-2",children:[(0,t.jsx)(o.MapPin,{className:"h-4 w-4"}),"Filter by Region"]}),(0,t.jsxs)(d.Select,{value:f,onValueChange:e=>{b(e),S(""),w(""),I("")},children:[(0,t.jsx)(d.SelectTrigger,{className:"h-11",children:(0,t.jsx)(d.SelectValue,{placeholder:"Select region"})}),(0,t.jsx)(d.SelectContent,{children:r.map(e=>(0,t.jsx)(d.SelectItem,{value:e.id.toString(),children:e.name},e.id))})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(c.Label,{htmlFor:"university",className:"text-sm font-medium flex items-center gap-2",children:[(0,t.jsx)(u.Building2,{className:"h-4 w-4"}),"Filter by University"]}),(0,t.jsxs)(d.Select,{value:N,onValueChange:e=>{S(e),w("")},disabled:!f,children:[(0,t.jsx)(d.SelectTrigger,{className:"h-11",children:(0,t.jsx)(d.SelectValue,{placeholder:f?"Select university":"Select region first"})}),(0,t.jsx)(d.SelectContent,{children:n.map(e=>(0,t.jsx)(d.SelectItem,{value:e.id.toString(),children:e.name},e.id))})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(c.Label,{htmlFor:"smallGroup",className:"text-sm font-medium flex items-center gap-2",children:[(0,t.jsx)(m.Users,{className:"h-4 w-4"}),"Filter by Small Group"]}),(0,t.jsxs)(d.Select,{value:y,onValueChange:e=>{w(e)},disabled:!N,children:[(0,t.jsx)(d.SelectTrigger,{className:"h-11",children:(0,t.jsx)(d.SelectValue,{placeholder:N?"Select small group":"Select university first"})}),(0,t.jsx)(d.SelectContent,{children:p.map(e=>(0,t.jsx)(d.SelectItem,{value:e.id.toString(),children:e.name},e.id))})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(c.Label,{htmlFor:"alumniGroup",className:"text-sm font-medium flex items-center gap-2",children:[(0,t.jsx)(x.GraduationCap,{className:"h-4 w-4"}),"Filter by Alumni Group"]}),(0,t.jsxs)(d.Select,{value:C,onValueChange:e=>{I(e)},disabled:!f,children:[(0,t.jsx)(d.SelectTrigger,{className:"h-11",children:(0,t.jsx)(d.SelectValue,{placeholder:f?"Select alumni group":"Select region first"})}),(0,t.jsx)(d.SelectContent,{children:j.map(e=>(0,t.jsx)(d.SelectItem,{value:e.id.toString(),children:e.name},e.id))})]})]})]})})]})}var p=e.i(70665),g=e.i(81949),j=e.i(69638);let v=(0,e.i(75254).default)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);var f=e.i(67881);function b(e){let{regionId:a,universityId:r,smallGroupId:n,alumniGroupId:o}=e,[u,x]=(0,s.useState)(""),[h,p]=(0,s.useState)([]),[b,N]=(0,s.useState)([]),[S,y]=(0,s.useState)({}),[w,C]=(0,s.useState)(!1),[I,k]=(0,s.useState)(null),[E,A]=(0,s.useState)(null),[F,G]=(0,s.useState)(null),L=[{value:"present",label:"Present"},{value:"absent",label:"Absent"},{value:"excused",label:"Excused"}],T=(0,s.useCallback)(async()=>{try{let e="/api/events",t=new URLSearchParams;a&&t.append("regionId",a),r&&t.append("universityId",r),n&&t.append("smallGroupId",n),o&&t.append("alumniGroupId",o),t.toString()&&(e+="?"+t.toString());let s=await g.default.get(e);p(s.data)}catch(e){console.error("Error fetching events:",e)}},[a,r,n,o]),B=(0,s.useCallback)(async()=>{C(!0),N([]),y({}),k(null);try{let e="/api/members",t=new URLSearchParams;n?t.append("smallGroupId",n):o?t.append("alumniGroupId",o):r?t.append("universityId",r):a&&t.append("regionId",a),t.toString()&&(e+="?"+t.toString());let s=await g.default.get(e),l=s.data.members||s.data;if(Array.isArray(l)){N(l);let e={};l.forEach(t=>{e[t.id]="present"}),y(e)}}catch(e){console.error("Error fetching members:",e),k("Failed to load members")}finally{C(!1)}},[a,r,n,o]);(0,s.useEffect)(()=>{T()},[T]),(0,s.useEffect)(()=>{u?B():(N([]),y({}))},[u,B]);let V=async e=>{if(e.preventDefault(),A(null),G(null),!u)return void G("Please select an event to mark attendance for.");if(0===b.length)return void G("No members found for the selected criteria.");let t=b.map(e=>({memberId:e.id,status:S[e.id]||"present",permanentEventId:parseInt(u)}));try{var s,a,r,l,n;let e=await g.default.post("/api/attendance",t);if(201===e.status&&(null==(s=e.data.results)?void 0:s.every(e=>e.success))){let e=(null==(a=h.find(e=>e.id.toString()===u))?void 0:a.name)||"the selected event",t=b.length;A("Attendance for ".concat(t,' member(s) at "').concat(e,'" has been saved successfully!')),G(null),y({}),N([]),x("")}else{let t=(null==(n=e.data.results)||null==(l=n.filter(e=>!e.success))||null==(r=l.map(e=>"object"==typeof e.error?Object.values(e.error).flat().join(", "):e.error))?void 0:r.join(", "))||"Some attendance records could not be saved.";G(t)}}catch(e){G("Failed to save attendance. "+(e.message||""))}};return(0,t.jsxs)(i.Card,{children:[(0,t.jsx)(i.CardHeader,{children:(0,t.jsxs)(i.CardTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(m.Users,{className:"w-5 h-5"}),"Mark Attendance"]})}),(0,t.jsx)(i.CardContent,{children:(0,t.jsxs)("form",{onSubmit:V,className:"space-y-6",children:[(0,t.jsx)("div",{className:"flex flex-wrap gap-4 items-end mb-4",children:(0,t.jsxs)("div",{className:"flex-1 min-w-[180px]",children:[(0,t.jsx)(c.Label,{htmlFor:"eventId",children:"Event *"}),(0,t.jsxs)(d.Select,{value:u,onValueChange:x,children:[(0,t.jsx)(d.SelectTrigger,{className:"h-11",children:(0,t.jsx)(d.SelectValue,{placeholder:"Select event"})}),(0,t.jsx)(d.SelectContent,{children:h.map(e=>(0,t.jsx)(d.SelectItem,{value:e.id.toString(),children:e.name},e.id))})]})]})}),E&&(0,t.jsx)("div",{className:"mb-4 p-4 bg-green-50 border border-green-200 rounded-lg",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(j.CheckCircle,{className:"h-5 w-5 text-green-400 mr-3"}),(0,t.jsx)("p",{className:"text-sm font-medium text-green-800",children:E})]}),(0,t.jsx)(f.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>{A(null),x("")},children:"Mark Another Attendance"})]})}),F&&(0,t.jsx)("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(v,{className:"h-5 w-5 text-red-400 mr-3"}),(0,t.jsx)("p",{className:"text-sm font-medium text-red-800",children:F})]})}),w?(0,t.jsxs)("div",{className:"mt-8 p-4 bg-muted/50 border rounded text-muted-foreground text-center",children:[(0,t.jsx)(l.RefreshCw,{className:"w-4 h-4 animate-spin mx-auto mb-2"}),"Loading members..."]}):b.length>0?(0,t.jsxs)("div",{className:"overflow-x-auto mt-8",children:[(0,t.jsxs)("table",{className:"min-w-full divide-y divide-border",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-muted-foreground uppercase",children:"Member"}),(0,t.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-muted-foreground uppercase",children:"Attendance"})]})}),(0,t.jsx)("tbody",{className:"divide-y divide-border",children:b.map(e=>(0,t.jsxs)("tr",{children:[(0,t.jsxs)("td",{className:"px-4 py-2 text-foreground",children:[e.firstname," ",e.secondname]}),(0,t.jsx)("td",{className:"px-4 py-2",children:(0,t.jsx)("div",{className:"flex gap-2",children:L.map(s=>(0,t.jsx)(f.Button,{type:"button",variant:S[e.id]===s.value?"default":"outline",size:"sm",className:"px-3 py-1 text-xs transition ".concat(S[e.id]===s.value?"present"===s.value?"bg-green-500 hover:bg-green-600 text-white":"excused"===s.value?"bg-yellow-500 hover:bg-yellow-600 text-white":"bg-red-500 hover:bg-red-600 text-white":"present"===s.value?"border-green-400 text-green-700 hover:bg-green-50":"excused"===s.value?"border-yellow-400 text-yellow-700 hover:bg-yellow-50":"border-red-400 text-red-700 hover:bg-red-50"),onClick:()=>{var t,a;return t=e.id.toString(),a=s.value,void y(e=>({...e,[t]:a}))},children:s.label},s.value))})})]},e.id))})]}),(0,t.jsx)("div",{className:"mt-6 text-right",children:(0,t.jsx)(f.Button,{type:"submit",className:"px-6 py-2",children:"Save Attendance"})})]}):u?(0,t.jsx)("div",{className:"mt-8 p-4 bg-muted/50 border rounded text-muted-foreground text-center",children:"No members found for the selected criteria."}):(0,t.jsx)("div",{className:"mt-8 p-4 bg-blue-50 border border-blue-200 rounded text-blue-600 text-center",children:"Please select an event to mark attendance for."})]})})]})}var N=e.i(55436),S=e.i(40160),y=e.i(63209),w=e.i(23750),C=e.i(63415);function I(e){let{regionId:a,universityId:n,smallGroupId:o,alumniGroupId:u,userScope:m}=e,[x,h]=(0,s.useState)([]),[p,b]=(0,s.useState)(!0),[I,k]=(0,s.useState)(null),[E,A]=(0,s.useState)(""),[F,G]=(0,s.useState)(""),[L,T]=(0,s.useState)(""),[B,V]=(0,s.useState)(""),[M,D]=(0,s.useState)(""),[P,R]=(0,s.useState)(null),[U,z]=(0,s.useState)(""),[O,H]=(0,s.useState)(null),[K,q]=(0,s.useState)(null),[W,J]=(0,s.useState)(!1),[Q,X]=(0,s.useState)(!1),[Y,Z]=(0,s.useState)([]),[$,_]=(0,s.useState)([]),[ee,et]=(0,s.useState)([]),[es,ea]=(0,s.useState)([]),[er,el]=(0,s.useState)(""),[en,ei]=(0,s.useState)(""),[ed,ec]=(0,s.useState)(""),[eo,eu]=(0,s.useState)(""),em=[{value:"present",label:"Present"},{value:"absent",label:"Absent"},{value:"excused",label:"Excused"}],ex=(0,s.useCallback)(async()=>{try{b(!0),k(null);let e=new URLSearchParams;F&&e.append("eventId",F),L&&e.append("status",L),B&&e.append("dateFrom",B),M&&e.append("dateTo",M),er&&e.append("regionId",er),en&&e.append("universityId",en),ed&&e.append("smallGroupId",ed),eo&&e.append("alumniGroupId",eo),a&&e.append("regionId",a),n&&e.append("universityId",n),o&&e.append("smallGroupId",o),u&&e.append("alumniGroupId",u);let t=await g.default.get("/api/attendance?".concat(e.toString()));h(t.data)}catch(e){console.error("Error fetching attendance records:",e),k("Failed to fetch attendance records. Please try again.")}finally{b(!1)}},[F,L,B,M,er,en,ed,eo,a,n,o,u]),eh=(0,s.useCallback)(async()=>{try{let e=await g.default.get("/api/regions");Z(e.data)}catch(e){console.error("Error fetching regions:",e)}},[]),ep=(0,s.useCallback)(async e=>{try{let t=await g.default.get("/api/universities?regionId=".concat(e));_(t.data)}catch(e){console.error("Error fetching universities:",e)}},[]),eg=(0,s.useCallback)(async e=>{try{let t=await g.default.get("/api/small-groups?universityId=".concat(e));et(t.data)}catch(e){console.error("Error fetching small groups:",e)}},[]),ej=(0,s.useCallback)(async e=>{try{let t=await g.default.get("/api/alumni-small-groups?regionId=".concat(e));ea(t.data)}catch(e){console.error("Error fetching alumni groups:",e)}},[]);(0,s.useEffect)(()=>{eh()},[eh]),(0,s.useEffect)(()=>{er?(ep(Number(er)),ej(Number(er))):(_([]),ea([]),ei(""),eu(""))},[er,ep,ej]),(0,s.useEffect)(()=>{en?eg(Number(en)):(et([]),ec(""))},[en,eg]),(0,s.useEffect)(()=>{ex()},[ex]);let ev=()=>{R(null),z(""),H(null),q(null)},ef=async e=>{H(null),q(null);try{let t=await g.default.put("/api/attendance?id=".concat(e.id),{status:U});200===t.status?(H("Attendance updated successfully!"),R(null),z(""),ex()):q(t.data.error||"Failed to update attendance.")}catch(e){q("Failed to update attendance. "+(e.message||""))}},eb=(0,s.useMemo)(()=>{if(!E)return x;let e=E.toLowerCase();return x.filter(t=>{var s,a,r,l,n,i,d,c,o,u,m,x;return null!=(o=null==(a=t.member)||null==(s=a.firstname)?void 0:s.toLowerCase().includes(e))&&o||null!=(u=null==(l=t.member)||null==(r=l.secondname)?void 0:r.toLowerCase().includes(e))&&u||null!=(m=null==(i=t.permanentministryevent)||null==(n=i.name)?void 0:n.toLowerCase().includes(e))&&m||null!=(x=null==(c=t.trainings)||null==(d=c.name)?void 0:d.toLowerCase().includes(e))&&x})},[x,E]),eN=(0,s.useMemo)(()=>eb.length?eb.reduce((e,t)=>(e.total++,"present"===t.status?e.present++:"absent"===t.status?e.absent++:"excused"===t.status&&e.excused++,e),{total:0,present:0,absent:0,excused:0}):{total:0,present:0,absent:0,excused:0},[eb]),eS=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all";J(!0);try{"attendance-records-".concat(e,"-").concat(new Date().toISOString().split("T")[0],".pdf")}catch(e){console.error("Error exporting attendance records:",e),alert("Failed to export attendance records. Please try again.")}finally{J(!1),X(!1)}};return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)(i.Card,{children:(0,t.jsx)(i.CardContent,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex flex-wrap gap-4 items-end",children:[(0,t.jsxs)("div",{className:"min-w-[180px]",children:[(0,t.jsx)(c.Label,{htmlFor:"eventFilter",children:"Event"}),(0,t.jsxs)(d.Select,{value:F,onValueChange:G,children:[(0,t.jsx)(d.SelectTrigger,{className:"h-11",children:(0,t.jsx)(d.SelectValue,{placeholder:"All Events"})}),(0,t.jsx)(d.SelectContent,{})]})]}),(0,t.jsxs)("div",{className:"min-w-[150px]",children:[(0,t.jsx)(c.Label,{htmlFor:"statusFilter",children:"Status"}),(0,t.jsxs)(d.Select,{value:L,onValueChange:T,children:[(0,t.jsx)(d.SelectTrigger,{className:"h-11",children:(0,t.jsx)(d.SelectValue,{placeholder:"All Statuses"})}),(0,t.jsx)(d.SelectContent,{children:em.map(e=>(0,t.jsx)(d.SelectItem,{value:e.value,children:e.label},e.value))})]})]}),(0,t.jsxs)("div",{className:"min-w-[150px]",children:[(0,t.jsx)(c.Label,{htmlFor:"dateFrom",children:"From Date"}),(0,t.jsx)(w.Input,{type:"date",value:B,onChange:e=>V(e.target.value),className:"h-11"})]}),(0,t.jsxs)("div",{className:"min-w-[150px]",children:[(0,t.jsx)(c.Label,{htmlFor:"dateTo",children:"To Date"}),(0,t.jsx)(w.Input,{type:"date",value:M,onChange:e=>D(e.target.value),className:"h-11"})]}),(null==m?void 0:m.scope)==="superadmin"&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"min-w-[180px]",children:[(0,t.jsx)(c.Label,{htmlFor:"regionFilter",children:"Region"}),(0,t.jsxs)(d.Select,{value:er,onValueChange:e=>{el(e),ei(""),ec(""),eu("")},children:[(0,t.jsx)(d.SelectTrigger,{className:"h-11",children:(0,t.jsx)(d.SelectValue,{placeholder:"All Regions"})}),(0,t.jsx)(d.SelectContent,{children:Y.map(e=>(0,t.jsx)(d.SelectItem,{value:e.id.toString(),children:e.name},e.id))})]})]}),(0,t.jsxs)("div",{className:"min-w-[180px]",children:[(0,t.jsx)(c.Label,{htmlFor:"universityFilter",children:"University"}),(0,t.jsxs)(d.Select,{value:en,onValueChange:e=>{ei(e),ec("")},disabled:!er,children:[(0,t.jsx)(d.SelectTrigger,{className:"h-11",children:(0,t.jsx)(d.SelectValue,{placeholder:er?"All Universities":"Select region first"})}),(0,t.jsx)(d.SelectContent,{children:$.map(e=>(0,t.jsx)(d.SelectItem,{value:e.id.toString(),children:e.name},e.id))})]})]}),(0,t.jsxs)("div",{className:"min-w-[180px]",children:[(0,t.jsx)(c.Label,{htmlFor:"smallGroupFilter",children:"Small Group"}),(0,t.jsxs)(d.Select,{value:ed,onValueChange:e=>{ec(e)},disabled:!en,children:[(0,t.jsx)(d.SelectTrigger,{className:"h-11",children:(0,t.jsx)(d.SelectValue,{placeholder:en?"All Small Groups":"Select university first"})}),(0,t.jsx)(d.SelectContent,{children:ee.map(e=>(0,t.jsx)(d.SelectItem,{value:e.id.toString(),children:e.name},e.id))})]})]}),(0,t.jsxs)("div",{className:"min-w-[180px]",children:[(0,t.jsx)(c.Label,{htmlFor:"alumniGroupFilter",children:"Alumni Group"}),(0,t.jsxs)(d.Select,{value:eo,onValueChange:e=>{eu(e)},disabled:!er,children:[(0,t.jsx)(d.SelectTrigger,{className:"h-11",children:(0,t.jsx)(d.SelectValue,{placeholder:er?"All Alumni Groups":"Select region first"})}),(0,t.jsx)(d.SelectContent,{children:es.map(e=>(0,t.jsx)(d.SelectItem,{value:e.id.toString(),children:e.name},e.id))})]})]})]}),(0,t.jsxs)("div",{className:"flex-1 min-w-[200px]",children:[(0,t.jsx)(c.Label,{htmlFor:"search",children:"Search"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(N.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),(0,t.jsx)(w.Input,{type:"text",placeholder:"Search by member or event name...",value:E,onChange:e=>A(e.target.value),className:"pl-10 h-11"})]})]}),(0,t.jsxs)("div",{className:"flex items-end gap-2",children:[(0,t.jsx)(f.Button,{type:"button",variant:"outline",onClick:()=>{G(""),T(""),V(""),D(""),A(""),el(""),ei(""),ec(""),eu("")},className:"h-11",children:"Clear Filters"}),(0,t.jsxs)(C.DropdownMenu,{open:Q,onOpenChange:X,children:[(0,t.jsx)(C.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsxs)(f.Button,{variant:"outline",className:"flex items-center gap-2 h-11",disabled:W,children:[(0,t.jsx)(S.Download,{className:"w-4 h-4"}),W?"Exporting...":"Export Document",(0,t.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),(0,t.jsxs)(C.DropdownMenuContent,{align:"end",className:"w-48",children:[(0,t.jsx)(C.DropdownMenuItem,{onClick:()=>eS("all"),children:"Export All Records"}),(0,t.jsx)(C.DropdownMenuItem,{onClick:()=>eS("present"),children:"Export Present Only"}),(0,t.jsx)(C.DropdownMenuItem,{onClick:()=>eS("absent"),children:"Export Absent Only"}),(0,t.jsx)(C.DropdownMenuItem,{onClick:()=>eS("excused"),children:"Export Excused Only"})]})]})]})]})})}),eb.length>0&&(0,t.jsx)(i.Card,{children:(0,t.jsx)(i.CardContent,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex flex-wrap gap-6 items-center",children:[(0,t.jsxs)("div",{className:"text-sm font-medium text-muted-foreground",children:["Total Records: ",(0,t.jsx)("span",{className:"font-bold text-foreground",children:eN.total})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),(0,t.jsxs)("span",{className:"text-sm text-muted-foreground",children:["Present: ",(0,t.jsx)("span",{className:"font-semibold text-green-600",children:eN.present})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),(0,t.jsxs)("span",{className:"text-sm text-muted-foreground",children:["Absent: ",(0,t.jsx)("span",{className:"font-semibold text-red-600",children:eN.absent})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-3 h-3 bg-yellow-500 rounded-full"}),(0,t.jsxs)("span",{className:"text-sm text-muted-foreground",children:["Excused: ",(0,t.jsx)("span",{className:"font-semibold text-yellow-600",children:eN.excused})]})]}),eN.total>0&&(0,t.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Attendance Rate: ",(0,t.jsxs)("span",{className:"font-semibold text-blue-600",children:[Math.round(eN.present/eN.total*100),"%"]})]})]})})}),(0,t.jsx)(i.Card,{children:(0,t.jsxs)(i.CardContent,{className:"p-0",children:[p?(0,t.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,t.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground",children:[(0,t.jsx)(l.RefreshCw,{className:"w-4 h-4 animate-spin"}),(0,t.jsx)("span",{children:"Loading attendance records..."})]})}):I?(0,t.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(y.AlertCircle,{className:"w-8 h-8 text-destructive mx-auto mb-2"}),(0,t.jsx)("div",{className:"text-destructive text-lg mb-2",children:"Error loading attendance records"}),(0,t.jsx)("p",{className:"text-muted-foreground mb-4",children:I}),(0,t.jsx)(f.Button,{onClick:ex,children:"Retry"})]})}):eb&&0!==eb.length?(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full",children:[(0,t.jsx)("thead",{className:"bg-muted/50 border-b border-border",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Member"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Event"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Status"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Date"})]})}),(0,t.jsx)("tbody",{className:"bg-card divide-y divide-border",children:eb.map(e=>{var s,a,r;return(0,t.jsxs)("tr",{className:"hover:bg-muted/50",children:[(0,t.jsx)("td",{className:"px-6 py-4 text-sm font-medium text-foreground",children:e.member?"".concat(e.member.firstname," ").concat(e.member.secondname):"N/A"}),(0,t.jsx)("td",{className:"px-6 py-4 text-sm text-muted-foreground",children:(null==(s=e.permanentministryevent)?void 0:s.name)||(null==(a=e.trainings)?void 0:a.name)||"N/A"}),(0,t.jsx)("td",{className:"px-6 py-4 text-sm",children:P===e.id?(0,t.jsxs)("div",{className:"flex gap-2",children:[em.map(e=>(0,t.jsx)(f.Button,{type:"button",variant:U===e.value?"default":"outline",size:"sm",className:"px-3 py-1 text-xs ".concat(U===e.value?"present"===e.value?"bg-green-500 hover:bg-green-600 text-white":"excused"===e.value?"bg-yellow-500 hover:bg-yellow-600 text-white":"bg-red-500 hover:bg-red-600 text-white":"present"===e.value?"border-green-400 text-green-700 hover:bg-green-50":"excused"===e.value?"border-yellow-400 text-yellow-700 hover:bg-yellow-50":"border-red-400 text-red-700 hover:bg-red-50"),onClick:()=>z(e.value),children:e.label},e.value)),(0,t.jsx)(f.Button,{type:"button",size:"sm",onClick:()=>ef(e),className:"ml-2 px-3 py-1 bg-green-600 hover:bg-green-700 text-white text-xs",children:"Save"}),(0,t.jsx)(f.Button,{type:"button",variant:"outline",size:"sm",onClick:ev,className:"px-3 py-1 text-xs",children:"Cancel"})]}):(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-semibold ".concat("present"===e.status?"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400":"excused"===e.status?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-400":"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400"),children:e.status.charAt(0).toUpperCase()+e.status.slice(1)}),(0,t.jsx)(f.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>{R(e.id),z(e.status),H(null),q(null)},className:"px-2 py-1 text-xs",children:"Edit"})]})}),(0,t.jsx)("td",{className:"px-6 py-4 text-sm text-muted-foreground",children:(r=e.recordedAt)?new Date(r).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A"})]},e.id)})})]})}):(0,t.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(r.Calendar,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),(0,t.jsx)("div",{className:"text-muted-foreground text-lg mb-2",children:"No attendance records found"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:E?'No results for "'.concat(E,'". Try a different search term.'):"There are no attendance records to display at the moment."})]})}),O&&(0,t.jsx)("div",{className:"p-4 bg-green-50 border-t border-green-200",children:(0,t.jsxs)("div",{className:"flex items-center text-green-800",children:[(0,t.jsx)(j.CheckCircle,{className:"w-4 h-4 mr-2"}),O]})}),K&&(0,t.jsx)("div",{className:"p-4 bg-red-50 border-t border-red-200",children:(0,t.jsxs)("div",{className:"flex items-center text-red-800",children:[(0,t.jsx)(v,{className:"w-4 h-4 mr-2"}),K]})})]})})]})}var k=e.i(75117),E=e.i(69035),A=e.i(11522);function F(){let[e,d]=(0,s.useState)("mark"),{userScope:c,loading:o,getDefaultValues:u}=(0,p.useUserScope)(),[m,x]=(0,s.useState)(""),[g,j]=(0,s.useState)(""),[v,N]=(0,s.useState)(""),[S,y]=(0,s.useState)("");return(0,s.useEffect)(()=>{if(c&&!o){let e=u();x(e.regionId||""),j(e.universityId||""),N(e.smallGroupId||""),y(e.alumniGroupId||"")}},[c,o,u]),(0,t.jsxs)(A.SidebarProvider,{children:[(0,t.jsx)(n.AppSidebar,{}),(0,t.jsxs)(A.SidebarInset,{children:[(0,t.jsx)("header",{className:"flex h-16 shrink-0 items-center gap-2 transition-[width,height] ease-linear group-has-data-[collapsible=icon]/sidebar-wrapper:h-12",children:(0,t.jsxs)("div",{className:"flex items-center gap-2 px-4",children:[(0,t.jsx)(A.SidebarTrigger,{className:"-ml-1"}),(0,t.jsx)(E.Separator,{orientation:"vertical",className:"mr-2 data-[orientation=vertical]:h-4"}),(0,t.jsx)(k.Breadcrumb,{children:(0,t.jsxs)(k.BreadcrumbList,{children:[(0,t.jsx)(k.BreadcrumbItem,{className:"hidden md:block",children:(0,t.jsx)(k.BreadcrumbLink,{href:"/dashboard",children:"Dashboard"})}),(0,t.jsx)(k.BreadcrumbSeparator,{className:"hidden md:block"}),(0,t.jsx)(k.BreadcrumbItem,{children:(0,t.jsx)(k.BreadcrumbLink,{href:"/links/activities",children:"Activities"})}),(0,t.jsx)(k.BreadcrumbSeparator,{}),(0,t.jsx)(k.BreadcrumbItem,{children:(0,t.jsx)(k.BreadcrumbPage,{children:"Attendance Tracking"})})]})})]})}),(0,t.jsx)("div",{className:"flex flex-1 flex-col gap-4 p-2 sm:p-4 pt-0",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto w-full",children:[(0,t.jsxs)("div",{className:"mb-4 sm:mb-6 lg:mb-8",children:[(0,t.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-foreground mb-1 sm:mb-2",children:"Attendance Tracking"}),(0,t.jsx)("p",{className:"text-sm sm:text-base text-muted-foreground",children:"Manage attendance records and mark attendance for events"})]}),(0,t.jsxs)("div",{className:"flex gap-2 mb-6",children:[(0,t.jsxs)(f.Button,{variant:"mark"===e?"default":"outline",onClick:()=>d("mark"),className:"flex items-center gap-2",children:[(0,t.jsx)(a.Plus,{className:"w-4 h-4"}),"Mark Attendance"]}),(0,t.jsxs)(f.Button,{variant:"view"===e?"default":"outline",onClick:()=>d("view"),className:"flex items-center gap-2",children:[(0,t.jsx)(r.Calendar,{className:"w-4 h-4"}),"View Attendance Records"]})]}),(null==c?void 0:c.scope)==="superadmin"&&(0,t.jsx)(h,{onScopeChange:e=>{x(e.regionId||""),j(e.universityId||""),N(e.smallGroupId||""),y(e.alumniGroupId||"")}}),c&&"superadmin"!==c.scope&&!o&&(0,t.jsx)(i.Card,{className:"mb-4",children:(0,t.jsx)(i.CardContent,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,t.jsx)("span",{children:"Current Scope:"}),(0,t.jsx)("span",{className:"font-medium text-foreground capitalize",children:c.scope}),c.region&&(0,t.jsxs)("span",{children:["• ",c.region.name]}),c.university&&(0,t.jsxs)("span",{children:["• ",c.university.name]}),c.smallGroup&&(0,t.jsxs)("span",{children:["• ",c.smallGroup.name]}),c.alumniGroup&&(0,t.jsxs)("span",{children:["• ",c.alumniGroup.name]})]})})}),o&&(0,t.jsx)(i.Card,{className:"mb-4",children:(0,t.jsx)(i.CardContent,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground",children:[(0,t.jsx)(l.RefreshCw,{className:"w-4 h-4 animate-spin"}),(0,t.jsx)("span",{children:"Loading user scope..."})]})})}),"mark"===e&&!o&&(0,t.jsx)(b,{regionId:m,universityId:g,smallGroupId:v,alumniGroupId:S}),"view"===e&&!o&&(0,t.jsx)(I,{regionId:m,universityId:g,smallGroupId:v,alumniGroupId:S,userScope:c})]})})]})]})}}]);