(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,46897,e=>{"use strict";e.s(["MapPin",()=>r],46897);let r=(0,e.i(75254).default)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},61911,e=>{"use strict";e.s(["Users",()=>r],61911);let r=(0,e.i(75254).default)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]])},32095,e=>{"use strict";e.s(["GraduationCap",()=>r],32095);let r=(0,e.i(75254).default)("graduation-cap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]])},18566,(e,r,s)=>{r.exports=e.r(76562)},24931,e=>{"use strict";e.s(["LogoutButton",()=>l]);var r=e.i(43476),s=e.i(26732),t=e.i(67881),a=e.i(92270);function l(){return(0,r.jsxs)(t.Button,{variant:"outline",size:"sm",onClick:()=>{(0,s.signOut)({callbackUrl:"/login"})},className:"flex items-center gap-2",children:[(0,r.jsx)(a.LogOut,{className:"h-4 w-4"}),"Logout"]})}},21218,e=>{"use strict";e.s(["Activity",()=>r],21218);let r=(0,e.i(75254).default)("activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]])},96772,11649,e=>{"use strict";e.s(["Church",()=>r],96772);let r=(0,e.i(75254).default)("church",[["path",{d:"M10 9h4",key:"u4k05v"}],["path",{d:"M12 7v5",key:"ma6bk"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"m18 9 3.52 2.147a1 1 0 0 1 .48.854V19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-6.999a1 1 0 0 1 .48-.854L6 9",key:"flvdwo"}],["path",{d:"M6 21V7a1 1 0 0 1 .376-.782l5-3.999a1 1 0 0 1 1.249.001l5 4A1 1 0 0 1 18 7v14",key:"a5i0n2"}]]);e.s(["AllowOnly",()=>d,"DenyOnly",()=>i],11649);var s=e.i(43476),t=e.i(26732),a=e.i(6482);function l(e){var r;let{children:l,allowedRoles:d,deniedRoles:i,fallback:n=null,loading:o=null}=e,{data:c,status:m}=(0,t.useSession)(),{userScope:u,isLoading:x,userRole:g}=(0,a.useRoleAccess)();return"loading"===m||x?(0,s.jsx)(s.Fragment,{children:o}):(null==c||null==(r=c.user)?void 0:r.id)?u&&g?(console.log("RoleBasedAccess Debug:",{userRole:g,allowedRoles:d,deniedRoles:i,willShow:!(null==i?void 0:i.includes(g))&&(!d||d.includes(g))}),i&&i.includes(g))?(console.log("Access denied: User role is in denied roles"),(0,s.jsx)(s.Fragment,{children:n})):d&&!d.includes(g)?(console.log("Access denied: User role not in allowed roles"),(0,s.jsx)(s.Fragment,{children:n})):(0,s.jsx)(s.Fragment,{children:l}):(console.warn("No user scope found, showing fallback"),(0,s.jsx)(s.Fragment,{children:n})):(0,s.jsx)(s.Fragment,{children:n})}function d(e){let{scopes:r,children:t,fallback:a=null}=e,d=Array.isArray(r)?r:[r];return(0,s.jsx)(l,{allowedRoles:d,fallback:a,children:t})}function i(e){let{scopes:r,children:t,fallback:a=null}=e,d=Array.isArray(r)?r:[r];return(0,s.jsx)(l,{deniedRoles:d,fallback:a,children:t})}},78928,e=>{"use strict";e.s(["default",()=>v],78928);var r=e.i(43476),s=e.i(26732),t=e.i(18566),a=e.i(71645),l=e.i(60313),d=e.i(24931),i=e.i(75117),n=e.i(69035),o=e.i(11522),c=e.i(98919),m=e.i(7486),u=e.i(46897),x=e.i(61911),g=e.i(32095),h=e.i(96772),p=e.i(21218);let b=(0,e.i(75254).default)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]);var j=e.i(87316),f=e.i(11649);function v(){var e,v,N;let{data:y,status:k}=(0,s.useSession)(),w=(0,t.useRouter)(),[A,M]=(0,a.useState)(null),[S,B]=(0,a.useState)(!0),[G,U]=(0,a.useState)([]),[C,R]=(0,a.useState)(!0),[L,F]=(0,a.useState)(null),[O,P]=(0,a.useState)({totalMembers:0,activeMembers:0,newThisMonth:0,recentActivity:0});(0,a.useEffect)(()=>{"unauthenticated"===k&&w.push("/")},[k,w]),(0,a.useEffect)(()=>{(async()=>{var e;if("loading"!==k&&(null==y||null==(e=y.user)?void 0:e.id))try{B(!0);let e=await fetch("/api/members/current-user-scope");if(e.ok){let r=await e.json();M(r.scope)}else console.error("Failed to fetch user scope")}catch(e){console.error("Error fetching user scope:",e)}finally{B(!1)}})()},[y,k]);let T=async()=>{try{R(!0),F(null),console.log("Starting to fetch members...");let[e]=await Promise.all([fetch("/api/members"),new Promise(e=>setTimeout(e,500))]);if(e.ok){let r=await e.json();console.log("Members fetched successfully:",r),U(r.members||[])}else throw Error("Failed to fetch members")}catch(e){console.error("Error fetching members:",e),F("Failed to fetch members. Please try again.")}finally{console.log("Setting loading to false"),R(!1)}};(0,a.useEffect)(()=>{"authenticated"===k&&T()},[k]),(0,a.useEffect)(()=>{if(G.length>0){let e=new Date,r=new Date(e.getFullYear(),e.getMonth(),1),s=new Date(e.getTime()-6048e5),t=G.filter(e=>"active"===e.status).length,a=G.filter(e=>new Date(e.createdAt)>=r).length,l=G.filter(e=>new Date(e.updatedAt)>=s).length;P({totalMembers:G.length,activeMembers:t,newThisMonth:a,recentActivity:l})}},[G]);let D=A?({superadmin:{title:"Super Administrator",subtitle:"Full system access",icon:c.Shield,color:"text-red-600"},national:{title:"National Administrator",subtitle:"National level access",icon:c.Shield,color:"text-blue-600"},region:{title:"Region Administrator",subtitle:A.region?"Region: ".concat(A.region.name):"Region access",icon:u.MapPin,color:"text-green-600"},university:{title:"University Administrator",subtitle:A.university?"".concat(A.university.name):"University access",icon:m.Building2,color:"text-purple-600"},smallgroup:{title:"Small Group Leader",subtitle:A.smallGroup?"".concat(A.smallGroup.name," - ").concat(null==(N=A.university)?void 0:N.name):"Small group access",icon:h.Church,color:"text-orange-600"},alumnismallgroup:{title:"Alumni Group Leader",subtitle:A.alumniGroup?"".concat(A.alumniGroup.name):"Alumni group access",icon:g.GraduationCap,color:"text-indigo-600"}})[A.scope]||{title:"User",subtitle:"Standard access",icon:x.Users,color:"text-muted-foreground"}:{title:"Loading...",subtitle:"",icon:c.Shield,color:"text-muted-foreground"},E=D.icon;return"loading"===k?(0,r.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):"unauthenticated"===k?(0,r.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Redirecting..."}),(0,r.jsx)("p",{className:"text-muted-foreground mb-4",children:"Please wait while we redirect you to the login page."})]})}):(0,r.jsxs)(o.SidebarProvider,{children:[(0,r.jsx)(l.AppSidebar,{}),(0,r.jsxs)(o.SidebarInset,{children:[(0,r.jsxs)("header",{className:"flex h-16 shrink-0 items-center gap-2 transition-[width,height] ease-linear group-has-data-[collapsible=icon]/sidebar-wrapper:h-12",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 px-4",children:[(0,r.jsx)(o.SidebarTrigger,{className:"-ml-1"}),(0,r.jsx)(n.Separator,{orientation:"vertical",className:"mr-2 data-[orientation=vertical]:h-4"}),(0,r.jsx)(i.Breadcrumb,{children:(0,r.jsxs)(i.BreadcrumbList,{children:[(0,r.jsx)(i.BreadcrumbItem,{className:"hidden md:block",children:(0,r.jsx)(i.BreadcrumbLink,{href:"/dashboard",children:"Dashboard"})}),(0,r.jsx)(i.BreadcrumbSeparator,{className:"hidden md:block"}),(0,r.jsx)(i.BreadcrumbItem,{children:(0,r.jsx)(i.BreadcrumbPage,{children:"Welcome"})})]})})]}),(0,r.jsxs)("div",{className:"ml-auto px-4 flex items-center gap-4",children:[!S&&A&&(0,r.jsxs)("div",{className:"hidden sm:flex items-center gap-2 px-3 py-1 bg-muted/50 rounded-lg border border-border/20",children:[(0,r.jsx)(E,{className:"w-4 h-4 ".concat(D.color)}),(0,r.jsx)("span",{className:"text-sm font-medium text-foreground",children:D.title})]}),(0,r.jsx)(d.LogoutButton,{})]})]}),(0,r.jsxs)("div",{className:"flex flex-1 flex-col gap-4 p-4 pt-0",children:[(0,r.jsx)("div",{className:"bg-gradient-to-br from-card via-card to-muted/20 rounded-lg shadow-sm border border-border/50 p-4",children:(0,r.jsxs)("div",{className:"flex flex-col lg:flex-row gap-4",children:[(0,r.jsx)("div",{className:"flex-1",children:(0,r.jsxs)("div",{className:"mb-3",children:[(0,r.jsx)("h1",{className:"text-xl font-bold text-foreground mb-2",children:"Welcome to GBUR Management System"}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"h-8 w-8 rounded-full bg-gradient-to-br from-primary/20 to-primary/10 border border-primary/20 flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-sm font-bold text-primary",children:((null==y||null==(e=y.user)?void 0:e.name)||"U").charAt(0).toUpperCase()})}),(0,r.jsx)("div",{children:(0,r.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Hello, ",(0,r.jsx)("span",{className:"font-semibold text-foreground",children:(null==y||null==(v=y.user)?void 0:v.name)||"User"}),"!"]})})]})]})}),(0,r.jsx)("div",{className:"lg:w-72",children:(0,r.jsxs)("div",{className:"bg-gradient-to-br from-primary/8 via-primary/5 to-primary/10 border border-primary/30 rounded-lg p-3 shadow-sm",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,r.jsx)("div",{className:"p-2 bg-primary/15 rounded-lg border border-primary/20",children:(0,r.jsx)(E,{className:"w-4 h-4 ".concat(D.color)})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-semibold text-foreground text-sm",children:"Your Role"}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Current access level"})]})]}),S?(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("div",{className:"h-4 bg-muted animate-pulse rounded w-3/4"}),(0,r.jsx)("div",{className:"h-3 bg-muted animate-pulse rounded w-1/2"})]}):(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-semibold text-sm ".concat(D.color," mb-1"),children:D.title}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground mb-2",children:D.subtitle}),A&&(0,r.jsxs)("div",{className:"space-y-1",children:[A.region&&(0,r.jsxs)("div",{className:"flex items-center gap-2 text-xs",children:[(0,r.jsx)(u.MapPin,{className:"w-3 h-3 text-muted-foreground"}),(0,r.jsx)("span",{className:"text-foreground",children:A.region.name})]}),A.university&&(0,r.jsxs)("div",{className:"flex items-center gap-2 text-xs",children:[(0,r.jsx)(m.Building2,{className:"w-3 h-3 text-muted-foreground"}),(0,r.jsx)("span",{className:"text-foreground",children:A.university.name})]}),A.smallGroup&&(0,r.jsxs)("div",{className:"flex items-center gap-2 text-xs",children:[(0,r.jsx)(h.Church,{className:"w-3 h-3 text-muted-foreground"}),(0,r.jsx)("span",{className:"text-foreground",children:A.smallGroup.name})]}),A.alumniGroup&&(0,r.jsxs)("div",{className:"flex items-center gap-2 text-xs",children:[(0,r.jsx)(g.GraduationCap,{className:"w-3 h-3 text-muted-foreground"}),(0,r.jsx)("span",{className:"text-foreground",children:A.alumniGroup.name})]})]})]})]})})]})}),(0,r.jsxs)("div",{className:"grid auto-rows-min gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,r.jsx)("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-950/50 dark:to-blue-900/50 border border-blue-200 dark:border-blue-800 rounded-xl p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-blue-600 dark:text-blue-400",children:"Total Members"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-blue-900 dark:text-blue-100",children:O.totalMembers})]}),(0,r.jsx)("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/50 rounded-lg",children:(0,r.jsx)(x.Users,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})})]})}),(0,r.jsx)("div",{className:"bg-gradient-to-br from-green-50 to-green-100 dark:from-green-950/50 dark:to-green-900/50 border border-green-200 dark:border-green-800 rounded-xl p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-green-600 dark:text-green-400",children:"Active Members"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-green-900 dark:text-green-100",children:O.activeMembers})]}),(0,r.jsx)("div",{className:"p-2 bg-green-100 dark:bg-green-900/50 rounded-lg",children:(0,r.jsx)(p.Activity,{className:"w-5 h-5 text-green-600 dark:text-green-400"})})]})}),(0,r.jsx)("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 dark:from-purple-950/50 dark:to-purple-900/50 border border-purple-200 dark:border-purple-800 rounded-xl p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-purple-600 dark:text-purple-400",children:"New This Month"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-purple-900 dark:text-purple-100",children:O.newThisMonth})]}),(0,r.jsx)("div",{className:"p-2 bg-purple-100 dark:bg-purple-900/50 rounded-lg",children:(0,r.jsx)(b,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"})})]})}),(0,r.jsx)("div",{className:"bg-gradient-to-br from-orange-50 to-orange-100 dark:from-orange-950/50 dark:to-orange-900/50 border border-orange-200 dark:border-orange-800 rounded-xl p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-orange-600 dark:text-orange-400",children:"Recent Updates"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-orange-900 dark:text-orange-100",children:O.recentActivity})]}),(0,r.jsx)("div",{className:"p-2 bg-orange-100 dark:bg-orange-900/50 rounded-lg",children:(0,r.jsx)(j.Calendar,{className:"w-5 h-5 text-orange-600 dark:text-orange-400"})})]})})]}),(0,r.jsxs)("div",{className:"bg-card rounded-lg shadow-sm border border-border/50 p-4",children:[(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-foreground mb-2",children:"Quick Actions"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Common tasks based on your access level"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,r.jsx)(f.AllowOnly,{scopes:"superadmin",children:(0,r.jsx)("div",{className:"p-4 border border-border rounded-lg hover:bg-muted/50 transition-colors",children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"p-2 bg-red-100 dark:bg-red-900/50 rounded-lg",children:(0,r.jsx)(c.Shield,{className:"w-5 h-5 text-red-600 dark:text-red-400"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-medium text-foreground",children:"System Administration"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Manage users and system settings"})]})]})})}),(0,r.jsx)(f.AllowOnly,{scopes:["region","university"],children:(0,r.jsx)("div",{className:"p-4 border border-border rounded-lg hover:bg-muted/50 transition-colors",children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/50 rounded-lg",children:(0,r.jsx)(m.Building2,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-medium text-foreground",children:"Manage Organizations"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Add and manage universities/regions"})]})]})})}),(0,r.jsx)(f.AllowOnly,{scopes:"smallgroup",children:(0,r.jsx)("div",{className:"p-4 border border-border rounded-lg hover:bg-muted/50 transition-colors",children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"p-2 bg-orange-100 dark:bg-orange-900/50 rounded-lg",children:(0,r.jsx)(h.Church,{className:"w-5 h-5 text-orange-600 dark:text-orange-400"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-medium text-foreground",children:"Small Group Management"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Manage your small group members"})]})]})})}),(0,r.jsx)(f.AllowOnly,{scopes:"alumnismallgroup",children:(0,r.jsx)("div",{className:"p-4 border border-border rounded-lg hover:bg-muted/50 transition-colors",children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"p-2 bg-indigo-100 dark:bg-indigo-900/50 rounded-lg",children:(0,r.jsx)(g.GraduationCap,{className:"w-5 h-5 text-indigo-600 dark:text-indigo-400"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-medium text-foreground",children:"Alumni Management"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Manage alumni group members"})]})]})})}),(0,r.jsx)("div",{className:"p-4 border border-border rounded-lg hover:bg-muted/50 transition-colors",children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"p-2 bg-green-100 dark:bg-green-900/50 rounded-lg",children:(0,r.jsx)(x.Users,{className:"w-5 h-5 text-green-600 dark:text-green-400"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-medium text-foreground",children:"View Members"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Browse and search member directory"})]})]})}),(0,r.jsx)("div",{className:"p-4 border border-border rounded-lg hover:bg-muted/50 transition-colors",children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"p-2 bg-purple-100 dark:bg-purple-900/50 rounded-lg",children:(0,r.jsx)(p.Activity,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-medium text-foreground",children:"Reports"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Generate and view reports"})]})]})})]})]})]})]})]})}}]);