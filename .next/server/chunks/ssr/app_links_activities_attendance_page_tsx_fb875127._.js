module.exports=[1207,a=>{"use strict";a.s(["default",()=>D],1207);var b=a.i(87924),c=a.i(72131),d=a.i(83490),e=a.i(87532),f=a.i(69520),g=a.i(15618),h=a.i(41675),i=a.i(60246),j=a.i(16201);let k=(0,a.i(70106).default)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);var l=a.i(84505),m=a.i(92e3),n=a.i(37073),o=a.i(39793),p=a.i(3130),q=a.i(87682),r=a.i(17171),s=a.i(24987),t=a.i(67900),u=a.i(69769);function v({onScopeChange:a}){let[d,e]=c.useState([]),[f,g]=c.useState([]),[h,j]=c.useState([]),[k,l]=c.useState([]),[m,n]=c.useState(""),[o,v]=c.useState(""),[w,x]=c.useState(""),[y,z]=c.useState("");c.useEffect(()=>{A()},[]),c.useEffect(()=>{m?(B(Number(m)),D(Number(m))):(g([]),l([]),v(""),z(""))},[m]),c.useEffect(()=>{o?C(Number(o)):(j([]),x(""))},[o]),c.useEffect(()=>{a({regionId:m,universityId:o,smallGroupId:w,alumniGroupId:y})},[m,o,w,y,a]);let A=async()=>{try{let a=await fetch("/api/regions"),b=await a.json();e(b)}catch(a){console.error("Error fetching regions:",a)}},B=async a=>{try{let b=await fetch(`/api/universities?regionId=${a}`),c=await b.json();g(c)}catch(a){console.error("Error fetching universities:",a)}},C=async a=>{try{let b=await fetch(`/api/small-groups?universityId=${a}`),c=await b.json();j(c)}catch(a){console.error("Error fetching small groups:",a)}},D=async a=>{try{let b=await fetch(`/api/alumni-small-groups?regionId=${a}`),c=await b.json();l(c)}catch(a){console.error("Error fetching alumni groups:",a)}};return(0,b.jsxs)(p.Card,{className:"mb-6",children:[(0,b.jsx)(p.CardHeader,{className:"pb-4",children:(0,b.jsx)(p.CardTitle,{className:"text-lg font-semibold text-foreground",children:"Super Admin Scope Selection"})}),(0,b.jsx)(p.CardContent,{children:(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(r.Label,{htmlFor:"region",className:"text-sm font-medium flex items-center gap-2",children:[(0,b.jsx)(s.MapPin,{className:"h-4 w-4"}),"Filter by Region"]}),(0,b.jsxs)(q.Select,{value:m,onValueChange:a=>{n(a),v(""),x(""),z("")},children:[(0,b.jsx)(q.SelectTrigger,{className:"h-11",children:(0,b.jsx)(q.SelectValue,{placeholder:"Select region"})}),(0,b.jsx)(q.SelectContent,{children:d.map(a=>(0,b.jsx)(q.SelectItem,{value:a.id.toString(),children:a.name},a.id))})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(r.Label,{htmlFor:"university",className:"text-sm font-medium flex items-center gap-2",children:[(0,b.jsx)(t.Building2,{className:"h-4 w-4"}),"Filter by University"]}),(0,b.jsxs)(q.Select,{value:o,onValueChange:a=>{v(a),x("")},disabled:!m,children:[(0,b.jsx)(q.SelectTrigger,{className:"h-11",children:(0,b.jsx)(q.SelectValue,{placeholder:m?"Select university":"Select region first"})}),(0,b.jsx)(q.SelectContent,{children:f.map(a=>(0,b.jsx)(q.SelectItem,{value:a.id.toString(),children:a.name},a.id))})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(r.Label,{htmlFor:"smallGroup",className:"text-sm font-medium flex items-center gap-2",children:[(0,b.jsx)(i.Users,{className:"h-4 w-4"}),"Filter by Small Group"]}),(0,b.jsxs)(q.Select,{value:w,onValueChange:a=>{x(a)},disabled:!o,children:[(0,b.jsx)(q.SelectTrigger,{className:"h-11",children:(0,b.jsx)(q.SelectValue,{placeholder:o?"Select small group":"Select university first"})}),(0,b.jsx)(q.SelectContent,{children:h.map(a=>(0,b.jsx)(q.SelectItem,{value:a.id.toString(),children:a.name},a.id))})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(r.Label,{htmlFor:"alumniGroup",className:"text-sm font-medium flex items-center gap-2",children:[(0,b.jsx)(u.GraduationCap,{className:"h-4 w-4"}),"Filter by Alumni Group"]}),(0,b.jsxs)(q.Select,{value:y,onValueChange:a=>{z(a)},disabled:!m,children:[(0,b.jsx)(q.SelectTrigger,{className:"h-11",children:(0,b.jsx)(q.SelectValue,{placeholder:m?"Select alumni group":"Select region first"})}),(0,b.jsx)(q.SelectContent,{children:k.map(a=>(0,b.jsx)(q.SelectItem,{value:a.id.toString(),children:a.name},a.id))})]})]})]})})]})}var w=a.i(12985),x=a.i(42247),y=a.i(7379),z=a.i(14727),A=a.i(5522),B=a.i(40695),C=a.i(76504);function D(){let[a,s]=(0,c.useState)("mark"),{userScope:t,loading:u,getDefaultValues:D}=(0,w.useUserScope)(),[E,F]=(0,c.useState)(""),[G,H]=(0,c.useState)(""),[I,J]=(0,c.useState)(""),[K,L]=(0,c.useState)(""),[M,N]=(0,c.useState)(""),[O,P]=(0,c.useState)([]),[Q,R]=(0,c.useState)([]),[S,T]=(0,c.useState)({}),[U,V]=(0,c.useState)(!1),[W,X]=(0,c.useState)(null),[Y,Z]=(0,c.useState)(null),[$,_]=(0,c.useState)(null),[aa,ab]=(0,c.useState)([]),[ac,ad]=(0,c.useState)(!0),[ae,af]=(0,c.useState)(null),[ag,ah]=(0,c.useState)(""),[ai,aj]=(0,c.useState)(""),[ak,al]=(0,c.useState)(""),[am,an]=(0,c.useState)(""),[ao,ap]=(0,c.useState)(""),[aq,ar]=(0,c.useState)(null),[as,at]=(0,c.useState)(""),[au,av]=(0,c.useState)(null),[aw,ax]=(0,c.useState)(null),[ay,az]=(0,c.useState)(!1),[aA,aB]=(0,c.useState)(!1),[aC,aD]=(0,c.useState)([]),[aE,aF]=(0,c.useState)([]),[aG,aH]=(0,c.useState)([]),[aI,aJ]=(0,c.useState)([]),[aK,aL]=(0,c.useState)(""),[aM,aN]=(0,c.useState)(""),[aO,aP]=(0,c.useState)(""),[aQ,aR]=(0,c.useState)(""),aS=[{value:"present",label:"Present"},{value:"absent",label:"Absent"},{value:"excused",label:"Excused"}];(0,c.useEffect)(()=>{if(t&&!u){let a=D();F(a.regionId||""),H(a.universityId||""),J(a.smallGroupId||""),L(a.alumniGroupId||"")}},[t,u,D]),(0,c.useEffect)(()=>{u||aT()},[u,E,G,I,K,aT]),(0,c.useEffect)(()=>{aU()},[]),(0,c.useEffect)(()=>{aK?(aV(Number(aK)),aX(Number(aK))):(aF([]),aJ([]),aN(""),aR(""))},[aK]),(0,c.useEffect)(()=>{aM?aW(Number(aM)):(aH([]),aP(""))},[aM]),(0,c.useEffect)(()=>{M?aY():(R([]),T({}))},[M,E,G,I,K,aY]),(0,c.useEffect)(()=>{"view"===a&&aZ()},[a,ai,ak,am,ao,E,G,I,K,aK,aM,aO,aQ,aZ]);let aT=async()=>{try{let a="/api/events",b=new URLSearchParams;E&&b.append("regionId",E),G&&b.append("universityId",G),I&&b.append("smallGroupId",I),K&&b.append("alumniGroupId",K),b.toString()&&(a+="?"+b.toString());let c=await d.default.get(a);P(c.data)}catch(a){console.error("Error fetching events:",a)}},aU=async()=>{try{let a=await d.default.get("/api/regions");aD(a.data)}catch(a){console.error("Error fetching regions:",a)}},aV=async a=>{try{let b=await d.default.get(`/api/universities?regionId=${a}`);aF(b.data)}catch(a){console.error("Error fetching universities:",a)}},aW=async a=>{try{let b=await d.default.get(`/api/small-groups?universityId=${a}`);aH(b.data)}catch(a){console.error("Error fetching small groups:",a)}},aX=async a=>{try{let b=await d.default.get(`/api/alumni-small-groups?regionId=${a}`);aJ(b.data)}catch(a){console.error("Error fetching alumni groups:",a)}},aY=async()=>{V(!0),R([]),T({}),X(null);try{let a="/api/members",b=new URLSearchParams;I?b.append("smallGroupId",I):K?b.append("alumniGroupId",K):G?b.append("universityId",G):E&&b.append("regionId",E),b.toString()&&(a+="?"+b.toString());let c=await d.default.get(a),e=c.data.members||c.data;if(Array.isArray(e)){R(e);let a={};e.forEach(b=>{a[b.id]="present"}),T(a)}}catch(a){console.error("Error fetching members:",a),X("Failed to load members")}finally{V(!1)}},aZ=async()=>{try{ad(!0),af(null);let a=new URLSearchParams;ai&&a.append("eventId",ai),ak&&a.append("status",ak),am&&a.append("dateFrom",am),ao&&a.append("dateTo",ao),aK&&a.append("regionId",aK),aM&&a.append("universityId",aM),aO&&a.append("smallGroupId",aO),aQ&&a.append("alumniGroupId",aQ),E&&a.append("regionId",E),G&&a.append("universityId",G),I&&a.append("smallGroupId",I),K&&a.append("alumniGroupId",K);let b=await d.default.get(`/api/attendance?${a.toString()}`);ab(b.data)}catch(a){console.error("Error fetching attendance records:",a),af("Failed to fetch attendance records. Please try again.")}finally{ad(!1)}},a$=async a=>{if(a.preventDefault(),Z(null),_(null),!M)return void _("Please select an event to mark attendance for.");if(0===Q.length)return void _("No members found for the selected criteria.");let b=Q.map(a=>({memberId:a.id,status:S[a.id]||"present",permanentEventId:parseInt(M)}));try{let a=await d.default.post("/api/attendance",b);if(201===a.status&&a.data.results?.every(a=>a.success)){let a=O.find(a=>a.id.toString()===M)?.name||"the selected event",b=Q.length;Z(`Attendance for ${b} member(s) at "${a}" has been saved successfully!`),_(null),T({}),R([]),N("")}else{let b=a.data.results?.filter(a=>!a.success)?.map(a=>"object"==typeof a.error?Object.values(a.error).flat().join(", "):a.error)?.join(", ")||"Some attendance records could not be saved.";_(b)}}catch(a){_("Failed to save attendance. "+(a.message||""))}},a_=()=>{ar(null),at(""),av(null),ax(null)},a0=async a=>{av(null),ax(null);try{let b=await d.default.put(`/api/attendance?id=${a.id}`,{status:as});200===b.status?(av("Attendance updated successfully!"),ar(null),at(""),aZ()):ax(b.data.error||"Failed to update attendance.")}catch(a){ax("Failed to update attendance. "+(a.message||""))}},a1=(0,c.useMemo)(()=>{if(!ag)return aa;let a=ag.toLowerCase();return aa.filter(b=>(b.member?.firstname?.toLowerCase().includes(a)??!1)||(b.member?.secondname?.toLowerCase().includes(a)??!1)||(b.permanentministryevent?.name?.toLowerCase().includes(a)??!1)||(b.trainings?.name?.toLowerCase().includes(a)??!1))},[aa,ag]),a2=(0,c.useMemo)(()=>a1.length?a1.reduce((a,b)=>(a.total++,"present"===b.status?a.present++:"absent"===b.status?a.absent++:"excused"===b.status&&a.excused++,a),{total:0,present:0,absent:0,excused:0}):{total:0,present:0,absent:0,excused:0},[a1]),a3=async(a="all")=>{try{let b=new URLSearchParams;return ai&&b.append("eventId",ai),am&&b.append("dateFrom",am),ao&&b.append("dateTo",ao),E&&b.append("regionId",E),G&&b.append("universityId",G),I&&b.append("smallGroupId",I),K&&b.append("alumniGroupId",K),aK&&b.append("regionId",aK),aM&&b.append("universityId",aM),aO&&b.append("smallGroupId",aO),aQ&&b.append("alumniGroupId",aQ),"all"!==a&&b.append("status",a),(await d.default.get(`/api/attendance/export-details?${b.toString()}`)).data}catch(a){throw console.error("Error fetching attendance export details:",a),a}},a4=async(a="all")=>{az(!0);try{let{attendanceDetails:b,totalCount:c,appliedFilters:d}=await a3(a),e=new n.default("p","mm","a4"),f=e.internal.pageSize.getWidth(),g=e.internal.pageSize.getHeight();if(e.setFontSize(20),e.setFont("helvetica","bold"),e.text("Ministry Management System",f/2,20,{align:"center"}),e.setFontSize(16),e.setFont("helvetica","normal"),e.text("Attendance Records Report",f/2,30,{align:"center"}),e.setFontSize(10),e.text(`Generated on: ${new Date().toLocaleDateString()}`,20,45),e.text(`Total Records: ${c}`,20,50),"all"!==a&&e.text(`Status Filter: ${a.charAt(0).toUpperCase()+a.slice(1)}`,20,55),d.dateFrom||d.dateTo){let b=`${d.dateFrom||"Start"} to ${d.dateTo||"End"}`;e.text(`Date Range: ${b}`,20,"all"!==a?60:55)}if(b.length>0){let a=b.reduce((a,b)=>(a.total++,"present"===b.attendanceStatus?a.present++:"absent"===b.attendanceStatus?a.absent++:"excused"===b.attendanceStatus&&a.excused++,a),{total:0,present:0,absent:0,excused:0}),c=d.dateFrom||d.dateTo?70:65;if(e.setFontSize(12),e.setFont("helvetica","bold"),e.text("Summary Statistics",20,c),e.setFontSize(10),e.setFont("helvetica","normal"),e.text(`Total Records: ${a.total}`,20,c+8),e.text(`Present: ${a.present}`,20,c+13),e.text(`Absent: ${a.absent}`,20,c+18),e.text(`Excused: ${a.excused}`,20,c+23),a.total>0){let b=Math.round(a.present/a.total*100);e.text(`Attendance Rate: ${b}%`,20,c+28)}}if(b.length>0){let a=d.dateFrom||d.dateTo?110:100;e.setFontSize(10),e.setFont("helvetica","bold"),e.text("Member Name",20,a),e.text("Event",60,a),e.text("Status",100,a),e.text("Date",130,a),e.text("Region",160,a),e.line(20,a+2,190,a+2),a+=8,e.setFont("helvetica","normal"),e.setFontSize(8),b.forEach((b,c)=>{a>g-20&&(e.addPage(),a=20);let d=b.memberName.length>25?b.memberName.substring(0,22)+"...":b.memberName,f=b.eventName.length>20?b.eventName.substring(0,17)+"...":b.eventName,h=b.region.length>15?b.region.substring(0,12)+"...":b.region;e.text(d,20,a),e.text(f,60,a),e.text(b.attendanceStatus.charAt(0).toUpperCase()+b.attendanceStatus.slice(1),100,a),e.text(new Date(b.recordedAt).toLocaleDateString(),130,a),e.text(h,160,a),a+=5})}else e.setFontSize(12),e.setFont("helvetica","normal"),e.text("No attendance records found for the selected criteria.",20,80);let h=`attendance-records-${a}-${new Date().toISOString().split("T")[0]}.pdf`;e.save(h)}catch(a){console.error("Error exporting attendance records:",a),alert("Failed to export attendance records. Please try again.")}finally{az(!1),aB(!1)}};return(0,b.jsxs)(z.SidebarProvider,{children:[(0,b.jsx)(o.AppSidebar,{}),(0,b.jsxs)(z.SidebarInset,{children:[(0,b.jsx)("header",{className:"flex h-16 shrink-0 items-center gap-2 transition-[width,height] ease-linear group-has-data-[collapsible=icon]/sidebar-wrapper:h-12",children:(0,b.jsxs)("div",{className:"flex items-center gap-2 px-4",children:[(0,b.jsx)(z.SidebarTrigger,{className:"-ml-1"}),(0,b.jsx)(y.Separator,{orientation:"vertical",className:"mr-2 data-[orientation=vertical]:h-4"}),(0,b.jsx)(x.Breadcrumb,{children:(0,b.jsxs)(x.BreadcrumbList,{children:[(0,b.jsx)(x.BreadcrumbItem,{className:"hidden md:block",children:(0,b.jsx)(x.BreadcrumbLink,{href:"/dashboard",children:"Dashboard"})}),(0,b.jsx)(x.BreadcrumbSeparator,{className:"hidden md:block"}),(0,b.jsx)(x.BreadcrumbItem,{children:(0,b.jsx)(x.BreadcrumbLink,{href:"/links/activities",children:"Activities"})}),(0,b.jsx)(x.BreadcrumbSeparator,{}),(0,b.jsx)(x.BreadcrumbItem,{children:(0,b.jsx)(x.BreadcrumbPage,{children:"Attendance Tracking"})})]})})]})}),(0,b.jsx)("div",{className:"flex flex-1 flex-col gap-4 p-2 sm:p-4 pt-0",children:(0,b.jsxs)("div",{className:"max-w-7xl mx-auto w-full",children:[(0,b.jsxs)("div",{className:"mb-4 sm:mb-6 lg:mb-8",children:[(0,b.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-foreground mb-1 sm:mb-2",children:"Attendance Tracking"}),(0,b.jsx)("p",{className:"text-sm sm:text-base text-muted-foreground",children:"Manage attendance records and mark attendance for events"})]}),(0,b.jsxs)("div",{className:"flex gap-2 mb-6",children:[(0,b.jsxs)(B.Button,{variant:"mark"===a?"default":"outline",onClick:()=>s("mark"),className:"flex items-center gap-2",children:[(0,b.jsx)(g.Plus,{className:"w-4 h-4"}),"Mark Attendance"]}),(0,b.jsxs)(B.Button,{variant:"view"===a?"default":"outline",onClick:()=>s("view"),className:"flex items-center gap-2",children:[(0,b.jsx)(h.Calendar,{className:"w-4 h-4"}),"View Attendance Records"]})]}),t?.scope==="superadmin"&&(0,b.jsx)(v,{onScopeChange:a=>{F(a.regionId||""),H(a.universityId||""),J(a.smallGroupId||""),L(a.alumniGroupId||"")}}),t&&"superadmin"!==t.scope&&!u&&(0,b.jsx)(p.Card,{className:"mb-4",children:(0,b.jsx)(p.CardContent,{className:"p-4",children:(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,b.jsx)("span",{children:"Current Scope:"}),(0,b.jsx)("span",{className:"font-medium text-foreground capitalize",children:t.scope}),t.region&&(0,b.jsxs)("span",{children:["• ",t.region.name]}),t.university&&(0,b.jsxs)("span",{children:["• ",t.university.name]}),t.smallGroup&&(0,b.jsxs)("span",{children:["• ",t.smallGroup.name]}),t.alumniGroup&&(0,b.jsxs)("span",{children:["• ",t.alumniGroup.name]})]})})}),u&&(0,b.jsx)(p.Card,{className:"mb-4",children:(0,b.jsx)(p.CardContent,{className:"p-4",children:(0,b.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground",children:[(0,b.jsx)(f.RefreshCw,{className:"w-4 h-4 animate-spin"}),(0,b.jsx)("span",{children:"Loading user scope..."})]})})}),"mark"===a&&!u&&(0,b.jsxs)(p.Card,{children:[(0,b.jsx)(p.CardHeader,{children:(0,b.jsxs)(p.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(i.Users,{className:"w-5 h-5"}),"Mark Attendance"]})}),(0,b.jsx)(p.CardContent,{children:(0,b.jsxs)("form",{onSubmit:a$,className:"space-y-6",children:[(0,b.jsx)("div",{className:"flex flex-wrap gap-4 items-end mb-4",children:(0,b.jsxs)("div",{className:"flex-1 min-w-[180px]",children:[(0,b.jsx)(r.Label,{htmlFor:"eventId",children:"Event *"}),(0,b.jsxs)(q.Select,{value:M,onValueChange:N,children:[(0,b.jsx)(q.SelectTrigger,{className:"h-11",children:(0,b.jsx)(q.SelectValue,{placeholder:"Select event"})}),(0,b.jsx)(q.SelectContent,{children:O.map(a=>(0,b.jsx)(q.SelectItem,{value:a.id.toString(),children:a.name},a.id))})]})]})}),Y&&(0,b.jsx)("div",{className:"mb-4 p-4 bg-green-50 border border-green-200 rounded-lg",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)(j.CheckCircle,{className:"h-5 w-5 text-green-400 mr-3"}),(0,b.jsx)("p",{className:"text-sm font-medium text-green-800",children:Y})]}),(0,b.jsx)(B.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>{Z(null),N("")},children:"Mark Another Attendance"})]})}),$&&(0,b.jsx)("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)(k,{className:"h-5 w-5 text-red-400 mr-3"}),(0,b.jsx)("p",{className:"text-sm font-medium text-red-800",children:$})]})}),U?(0,b.jsxs)("div",{className:"mt-8 p-4 bg-muted/50 border rounded text-muted-foreground text-center",children:[(0,b.jsx)(f.RefreshCw,{className:"w-4 h-4 animate-spin mx-auto mb-2"}),"Loading members..."]}):Q.length>0?(0,b.jsxs)("div",{className:"overflow-x-auto mt-8",children:[(0,b.jsxs)("table",{className:"min-w-full divide-y divide-border",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-muted-foreground uppercase",children:"Member"}),(0,b.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-muted-foreground uppercase",children:"Attendance"})]})}),(0,b.jsx)("tbody",{className:"divide-y divide-border",children:Q.map(a=>(0,b.jsxs)("tr",{children:[(0,b.jsxs)("td",{className:"px-4 py-2 text-foreground",children:[a.firstname," ",a.secondname]}),(0,b.jsx)("td",{className:"px-4 py-2",children:(0,b.jsx)("div",{className:"flex gap-2",children:aS.map(c=>(0,b.jsx)(B.Button,{type:"button",variant:S[a.id]===c.value?"default":"outline",size:"sm",className:`px-3 py-1 text-xs transition ${S[a.id]===c.value?"present"===c.value?"bg-green-500 hover:bg-green-600 text-white":"excused"===c.value?"bg-yellow-500 hover:bg-yellow-600 text-white":"bg-red-500 hover:bg-red-600 text-white":"present"===c.value?"border-green-400 text-green-700 hover:bg-green-50":"excused"===c.value?"border-yellow-400 text-yellow-700 hover:bg-yellow-50":"border-red-400 text-red-700 hover:bg-red-50"}`,onClick:()=>{var b,d;return b=a.id.toString(),d=c.value,void T(a=>({...a,[b]:d}))},children:c.label},c.value))})})]},a.id))})]}),(0,b.jsx)("div",{className:"mt-6 text-right",children:(0,b.jsx)(B.Button,{type:"submit",className:"px-6 py-2",children:"Save Attendance"})})]}):M?(0,b.jsx)("div",{className:"mt-8 p-4 bg-muted/50 border rounded text-muted-foreground text-center",children:"No members found for the selected criteria."}):(0,b.jsx)("div",{className:"mt-8 p-4 bg-blue-50 border border-blue-200 rounded text-blue-600 text-center",children:"Please select an event to mark attendance for."})]})})]}),"view"===a&&!u&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)(p.Card,{children:(0,b.jsx)(p.CardContent,{className:"p-4",children:(0,b.jsxs)("div",{className:"flex flex-wrap gap-4 items-end",children:[(0,b.jsxs)("div",{className:"min-w-[180px]",children:[(0,b.jsx)(r.Label,{htmlFor:"eventFilter",children:"Event"}),(0,b.jsxs)(q.Select,{value:ai,onValueChange:aj,children:[(0,b.jsx)(q.SelectTrigger,{className:"h-11",children:(0,b.jsx)(q.SelectValue,{placeholder:"All Events"})}),(0,b.jsx)(q.SelectContent,{children:O.map(a=>(0,b.jsx)(q.SelectItem,{value:a.id.toString(),children:a.name},a.id))})]})]}),(0,b.jsxs)("div",{className:"min-w-[150px]",children:[(0,b.jsx)(r.Label,{htmlFor:"statusFilter",children:"Status"}),(0,b.jsxs)(q.Select,{value:ak,onValueChange:al,children:[(0,b.jsx)(q.SelectTrigger,{className:"h-11",children:(0,b.jsx)(q.SelectValue,{placeholder:"All Statuses"})}),(0,b.jsx)(q.SelectContent,{children:aS.map(a=>(0,b.jsx)(q.SelectItem,{value:a.value,children:a.label},a.value))})]})]}),(0,b.jsxs)("div",{className:"min-w-[150px]",children:[(0,b.jsx)(r.Label,{htmlFor:"dateFrom",children:"From Date"}),(0,b.jsx)(A.Input,{type:"date",value:am,onChange:a=>an(a.target.value),className:"h-11"})]}),(0,b.jsxs)("div",{className:"min-w-[150px]",children:[(0,b.jsx)(r.Label,{htmlFor:"dateTo",children:"To Date"}),(0,b.jsx)(A.Input,{type:"date",value:ao,onChange:a=>ap(a.target.value),className:"h-11"})]}),t?.scope==="superadmin"&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"min-w-[180px]",children:[(0,b.jsx)(r.Label,{htmlFor:"regionFilter",children:"Region"}),(0,b.jsxs)(q.Select,{value:aK,onValueChange:a=>{aL(a),aN(""),aP(""),aR("")},children:[(0,b.jsx)(q.SelectTrigger,{className:"h-11",children:(0,b.jsx)(q.SelectValue,{placeholder:"All Regions"})}),(0,b.jsx)(q.SelectContent,{children:aC.map(a=>(0,b.jsx)(q.SelectItem,{value:a.id.toString(),children:a.name},a.id))})]})]}),(0,b.jsxs)("div",{className:"min-w-[180px]",children:[(0,b.jsx)(r.Label,{htmlFor:"universityFilter",children:"University"}),(0,b.jsxs)(q.Select,{value:aM,onValueChange:a=>{aN(a),aP("")},disabled:!aK,children:[(0,b.jsx)(q.SelectTrigger,{className:"h-11",children:(0,b.jsx)(q.SelectValue,{placeholder:aK?"All Universities":"Select region first"})}),(0,b.jsx)(q.SelectContent,{children:aE.map(a=>(0,b.jsx)(q.SelectItem,{value:a.id.toString(),children:a.name},a.id))})]})]}),(0,b.jsxs)("div",{className:"min-w-[180px]",children:[(0,b.jsx)(r.Label,{htmlFor:"smallGroupFilter",children:"Small Group"}),(0,b.jsxs)(q.Select,{value:aO,onValueChange:a=>{aP(a)},disabled:!aM,children:[(0,b.jsx)(q.SelectTrigger,{className:"h-11",children:(0,b.jsx)(q.SelectValue,{placeholder:aM?"All Small Groups":"Select university first"})}),(0,b.jsx)(q.SelectContent,{children:aG.map(a=>(0,b.jsx)(q.SelectItem,{value:a.id.toString(),children:a.name},a.id))})]})]}),(0,b.jsxs)("div",{className:"min-w-[180px]",children:[(0,b.jsx)(r.Label,{htmlFor:"alumniGroupFilter",children:"Alumni Group"}),(0,b.jsxs)(q.Select,{value:aQ,onValueChange:a=>{aR(a)},disabled:!aK,children:[(0,b.jsx)(q.SelectTrigger,{className:"h-11",children:(0,b.jsx)(q.SelectValue,{placeholder:aK?"All Alumni Groups":"Select region first"})}),(0,b.jsx)(q.SelectContent,{children:aI.map(a=>(0,b.jsx)(q.SelectItem,{value:a.id.toString(),children:a.name},a.id))})]})]})]}),(0,b.jsxs)("div",{className:"flex-1 min-w-[200px]",children:[(0,b.jsx)(r.Label,{htmlFor:"search",children:"Search"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(e.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),(0,b.jsx)(A.Input,{type:"text",placeholder:"Search by member or event name...",value:ag,onChange:a=>ah(a.target.value),className:"pl-10 h-11"})]})]}),(0,b.jsxs)("div",{className:"flex items-end gap-2",children:[(0,b.jsx)(B.Button,{type:"button",variant:"outline",onClick:()=>{aj(""),al(""),an(""),ap(""),ah(""),aL(""),aN(""),aP(""),aR("")},className:"h-11",children:"Clear Filters"}),(0,b.jsxs)(C.DropdownMenu,{open:aA,onOpenChange:aB,children:[(0,b.jsx)(C.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsxs)(B.Button,{variant:"outline",className:"flex items-center gap-2 h-11",disabled:ay,children:[(0,b.jsx)(l.Download,{className:"w-4 h-4"}),ay?"Exporting...":"Export Document",(0,b.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),(0,b.jsxs)(C.DropdownMenuContent,{align:"end",className:"w-48",children:[(0,b.jsx)(C.DropdownMenuItem,{onClick:()=>a4("all"),children:"Export All Records"}),(0,b.jsx)(C.DropdownMenuItem,{onClick:()=>a4("present"),children:"Export Present Only"}),(0,b.jsx)(C.DropdownMenuItem,{onClick:()=>a4("absent"),children:"Export Absent Only"}),(0,b.jsx)(C.DropdownMenuItem,{onClick:()=>a4("excused"),children:"Export Excused Only"})]})]})]})]})})}),a1.length>0&&(0,b.jsx)(p.Card,{children:(0,b.jsx)(p.CardContent,{className:"p-4",children:(0,b.jsxs)("div",{className:"flex flex-wrap gap-6 items-center",children:[(0,b.jsxs)("div",{className:"text-sm font-medium text-muted-foreground",children:["Total Records: ",(0,b.jsx)("span",{className:"font-bold text-foreground",children:a2.total})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),(0,b.jsxs)("span",{className:"text-sm text-muted-foreground",children:["Present: ",(0,b.jsx)("span",{className:"font-semibold text-green-600",children:a2.present})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),(0,b.jsxs)("span",{className:"text-sm text-muted-foreground",children:["Absent: ",(0,b.jsx)("span",{className:"font-semibold text-red-600",children:a2.absent})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"w-3 h-3 bg-yellow-500 rounded-full"}),(0,b.jsxs)("span",{className:"text-sm text-muted-foreground",children:["Excused: ",(0,b.jsx)("span",{className:"font-semibold text-yellow-600",children:a2.excused})]})]}),a2.total>0&&(0,b.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Attendance Rate: ",(0,b.jsxs)("span",{className:"font-semibold text-blue-600",children:[Math.round(a2.present/a2.total*100),"%"]})]})]})})}),(0,b.jsx)(p.Card,{children:(0,b.jsxs)(p.CardContent,{className:"p-0",children:[ac?(0,b.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,b.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground",children:[(0,b.jsx)(f.RefreshCw,{className:"w-4 h-4 animate-spin"}),(0,b.jsx)("span",{children:"Loading attendance records..."})]})}):ae?(0,b.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)(m.AlertCircle,{className:"w-8 h-8 text-destructive mx-auto mb-2"}),(0,b.jsx)("div",{className:"text-destructive text-lg mb-2",children:"Error loading attendance records"}),(0,b.jsx)("p",{className:"text-muted-foreground mb-4",children:ae}),(0,b.jsx)(B.Button,{onClick:aZ,children:"Retry"})]})}):a1&&0!==a1.length?(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"w-full",children:[(0,b.jsx)("thead",{className:"bg-muted/50 border-b border-border",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Member"}),(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Event"}),(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Status"}),(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Date"})]})}),(0,b.jsx)("tbody",{className:"bg-card divide-y divide-border",children:a1.map(a=>{var c;return(0,b.jsxs)("tr",{className:"hover:bg-muted/50",children:[(0,b.jsx)("td",{className:"px-6 py-4 text-sm font-medium text-foreground",children:a.member?`${a.member.firstname} ${a.member.secondname}`:"N/A"}),(0,b.jsx)("td",{className:"px-6 py-4 text-sm text-muted-foreground",children:a.permanentministryevent?.name||a.trainings?.name||"N/A"}),(0,b.jsx)("td",{className:"px-6 py-4 text-sm",children:aq===a.id?(0,b.jsxs)("div",{className:"flex gap-2",children:[aS.map(a=>(0,b.jsx)(B.Button,{type:"button",variant:as===a.value?"default":"outline",size:"sm",className:`px-3 py-1 text-xs ${as===a.value?"present"===a.value?"bg-green-500 hover:bg-green-600 text-white":"excused"===a.value?"bg-yellow-500 hover:bg-yellow-600 text-white":"bg-red-500 hover:bg-red-600 text-white":"present"===a.value?"border-green-400 text-green-700 hover:bg-green-50":"excused"===a.value?"border-yellow-400 text-yellow-700 hover:bg-yellow-50":"border-red-400 text-red-700 hover:bg-red-50"}`,onClick:()=>at(a.value),children:a.label},a.value)),(0,b.jsx)(B.Button,{type:"button",size:"sm",onClick:()=>a0(a),className:"ml-2 px-3 py-1 bg-green-600 hover:bg-green-700 text-white text-xs",children:"Save"}),(0,b.jsx)(B.Button,{type:"button",variant:"outline",size:"sm",onClick:a_,className:"px-3 py-1 text-xs",children:"Cancel"})]}):(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:`px-3 py-1 rounded-full text-xs font-semibold ${"present"===a.status?"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400":"excused"===a.status?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-400":"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400"}`,children:a.status.charAt(0).toUpperCase()+a.status.slice(1)}),(0,b.jsx)(B.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>{ar(a.id),at(a.status),av(null),ax(null)},className:"px-2 py-1 text-xs",children:"Edit"})]})}),(0,b.jsx)("td",{className:"px-6 py-4 text-sm text-muted-foreground",children:(c=a.recordedAt)?new Date(c).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A"})]},a.id)})})]})}):(0,b.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)(h.Calendar,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),(0,b.jsx)("div",{className:"text-muted-foreground text-lg mb-2",children:"No attendance records found"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:ag?`No results for "${ag}". Try a different search term.`:"There are no attendance records to display at the moment."})]})}),au&&(0,b.jsx)("div",{className:"p-4 bg-green-50 border-t border-green-200",children:(0,b.jsxs)("div",{className:"flex items-center text-green-800",children:[(0,b.jsx)(j.CheckCircle,{className:"w-4 h-4 mr-2"}),au]})}),aw&&(0,b.jsx)("div",{className:"p-4 bg-red-50 border-t border-red-200",children:(0,b.jsxs)("div",{className:"flex items-center text-red-800",children:[(0,b.jsx)(k,{className:"w-4 h-4 mr-2"}),aw]})})]})})]})]})})]})]})}}];

//# sourceMappingURL=app_links_activities_attendance_page_tsx_fb875127._.js.map