module.exports=[18622,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},20635,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},24725,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},29173,(e,t,r)=>{t.exports=e.x("@prisma/client",()=>require("@prisma/client"))},70406,(e,t,r)=>{t.exports=e.x("next/dist/compiled/@opentelemetry/api",()=>require("next/dist/compiled/@opentelemetry/api"))},93695,(e,t,r)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},61724,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-route-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-route-turbo.runtime.prod.js"))},19478,(e,t,r)=>{},16471,e=>{"use strict";e.s(["handler",()=>C,"patchFetch",()=>M,"routeModule",()=>v,"serverHooks",()=>_,"workAsyncStorage",()=>R,"workUnitAsyncStorage",()=>E],16471);var t=e.i(47909),r=e.i(74017),a=e.i(96250),n=e.i(59756),i=e.i(61916),o=e.i(69741),s=e.i(16795),l=e.i(87718),u=e.i(95169),d=e.i(47587),p=e.i(66012),c=e.i(70101),m=e.i(26937),h=e.i(10372),g=e.i(93695);e.i(52474);var w=e.i(220);e.s(["GET",()=>x],28946);var b=e.i(89171),f=e.i(15270);async function x(e){try{let{searchParams:t}=new URL(e.url),r=t.get("regionId"),a=t.get("universityId"),n=t.get("smallGroupId"),i=t.get("alumniGroupId"),o=t.get("dateFrom"),s=t.get("dateTo"),l=t.get("memberType"),u=t.get("memberStatus"),d=t.get("gender"),p=t.get("ageFrom"),c=t.get("ageTo"),m=t.get("profession"),h=t.get("faculty"),g=t.get("placeOfBirthProvince"),w=t.get("placeOfBirthDistrict"),x=t.get("graduationYear"),y={};if(r&&"all"!==r&&(y.regionId=Number(r)),a&&"all"!==a&&(y.universityId=Number(a)),n&&"all"!==n&&(y.smallGroupId=Number(n)),i&&"all"!==i&&(y.alumniGroupId=Number(i)),o||s){if(y.createdAt={},o){let e=new Date(o);e.setHours(0,0,0,0),y.createdAt.gte=e}if(s){let e=new Date(s);e.setHours(23,59,59,999),y.createdAt.lte=e}}if(l&&"all"!==l&&(y.type=l),u&&"all"!==u&&(y.status=u),d&&"all"!==d&&(y.gender=d),m&&"all"!==m&&(y.professionalism={contains:m,mode:"insensitive"}),h&&"all"!==h&&(y.faculty={contains:h,mode:"insensitive"}),g&&"all"!==g&&(y.placeOfBirthProvince={contains:g,mode:"insensitive"}),w&&"all"!==w&&(y.placeOfBirthDistrict={contains:w,mode:"insensitive"}),x&&"all"!==x){let e=parseInt(x),t=new Date(e,0,1),r=new Date(e,11,31);y.graduationDate={gte:t,lte:r}}if(p&&"all"!==p){let e=parseInt(p),t=new Date;t.setFullYear(t.getFullYear()-e),y.birthdate={lte:t}}if(c&&"all"!==c){let e=parseInt(c),t=new Date;t.setFullYear(t.getFullYear()-e-1),y.birthdate={gte:t}}let v=await f.prisma.member.count({where:y}),R=await f.prisma.member.groupBy({by:["type"],where:y,_count:{id:!0}}),E=await f.prisma.member.groupBy({by:["gender"],where:{...y,gender:{not:null}},_count:{id:!0}}),_=await f.prisma.member.groupBy({by:["regionId"],where:{...y,regionId:{not:null}},_count:{id:!0}}),M=_.map(e=>e.regionId).filter(e=>null!==e),C=await f.prisma.region.findMany({where:{id:{in:M}},select:{id:!0,name:!0}}),D=[],A=new Date;for(let e=11;e>=0;e--){let t=new Date(A.getFullYear(),A.getMonth()-e,1),r=new Date(A.getFullYear(),A.getMonth()-e+1,0,23,59,59,999),a={...y,createdAt:{gte:t,lte:r}},n=await f.prisma.member.count({where:a}),i=await f.prisma.member.count({where:{...y,status:"graduate",updatedAt:{gte:t,lte:r}}}),o=await f.prisma.member.count({where:{...y,createdAt:{lte:r}}});D.push({month:t.toLocaleDateString("en-US",{month:"short"}),newMembers:n,graduatedMembers:i,totalMembers:o,netGrowth:n-i})}let I=new Date;I.setDate(I.getDate()-30);let N=await f.prisma.member.count({where:{...y,createdAt:{gte:I}}}),O=await f.prisma.member.groupBy({by:["status"],where:y,_count:{id:!0}}),T=await f.prisma.member.groupBy({by:["professionalism"],where:{...y,professionalism:{not:null}},_count:{id:!0}}),P=await f.prisma.member.groupBy({by:["faculty"],where:{...y,faculty:{not:null}},_count:{id:!0}}),k=await f.prisma.member.groupBy({by:["placeOfBirthProvince"],where:{...y,placeOfBirthProvince:{not:null}},_count:{id:!0}}),B=await f.prisma.member.findMany({where:{...y,birthdate:{not:null}},select:{birthdate:!0}}),F={"18-25":0,"26-35":0,"36-45":0,"46-55":0,"56+":0};B.forEach(e=>{if(e.birthdate){let t=new Date().getFullYear()-new Date(e.birthdate).getFullYear();t>=18&&t<=25?F["18-25"]++:t>=26&&t<=35?F["26-35"]++:t>=36&&t<=45?F["36-45"]++:t>=46&&t<=55?F["46-55"]++:t>=56&&F["56+"]++}});let j=await f.prisma.member.count({where:{...y,status:"active"}}),q=v>0?Math.round(j/v*100):0,U={keyMetrics:{totalMembers:v,newMembersThisMonth:D[D.length-1]?.newMembers||0,graduatedMembersThisMonth:D[D.length-1]?.graduatedMembers||0,netGrowth:D[D.length-1]?.netGrowth||0,retentionRate:q,recentActivity:N},memberTypeDistribution:R.map(e=>({name:e.type.charAt(0).toUpperCase()+e.type.slice(1)+"s",value:Math.round(e._count.id/v*100),count:e._count.id,color:({student:"#3B82F6",graduate:"#10B981",alumni:"#F59E0B",staff:"#8B5CF6",volunteer:"#EF4444"})[e.type]||"#6B7280"})),genderDistribution:E.map(e=>({name:"male"===e.gender?"Male":"Female",value:Math.round(e._count.id/v*100),count:e._count.id,color:"male"===e.gender?"#3B82F6":"#EC4899"})),regionalDistribution:_.map(e=>{let t=C.find(t=>t.id===e.regionId);return{region:t?.name||"Unknown",members:e._count.id,growth:Math.floor(20*Math.random())+1,universities:Math.floor(10*Math.random())+1}}),monthlyGrowth:D,memberStatusDistribution:O.map(e=>({status:e.status,count:e._count.id,percentage:Math.round(e._count.id/v*100)})),professionDistribution:T.map(e=>({profession:e.professionalism||"Unknown",count:e._count.id,percentage:Math.round(e._count.id/v*100)})),facultyDistribution:P.map(e=>({faculty:e.faculty||"Unknown",count:e._count.id,percentage:Math.round(e._count.id/v*100)})),birthProvinceDistribution:k.map(e=>({province:e.placeOfBirthProvince||"Unknown",count:e._count.id,percentage:Math.round(e._count.id/v*100)})),ageDistribution:Object.entries(F).map(([e,t])=>({ageGroup:e,count:t,percentage:Math.round(t/v*100)}))};return b.NextResponse.json(U,{status:200})}catch(e){return console.error("Error fetching membership analytics:",e),b.NextResponse.json({error:"Failed to fetch membership analytics"},{status:500})}}var y=e.i(28946);let v=new t.AppRouteRouteModule({definition:{kind:r.RouteKind.APP_ROUTE,page:"/api/members/analytics/route",pathname:"/api/members/analytics",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/app/api/members/analytics/route.ts",nextConfigOutput:"standalone",userland:y}),{workAsyncStorage:R,workUnitAsyncStorage:E,serverHooks:_}=v;function M(){return(0,a.patchFetch)({workAsyncStorage:R,workUnitAsyncStorage:E})}async function C(e,t,a){var b;let f="/api/members/analytics/route";f=f.replace(/\/index$/,"")||"/";let x=await v.prepare(e,t,{srcPage:f,multiZoneDraftMode:!1});if(!x)return t.statusCode=400,t.end("Bad Request"),null==a.waitUntil||a.waitUntil.call(a,Promise.resolve()),null;let{buildId:y,params:R,nextConfig:E,isDraftMode:_,prerenderManifest:M,routerServerContext:C,isOnDemandRevalidate:D,revalidateOnlyGenerated:A,resolvedPathname:I}=x,N=(0,o.normalizeAppPath)(f),O=!!(M.dynamicRoutes[N]||M.routes[I]);if(O&&!_){let e=!!M.routes[I],t=M.dynamicRoutes[N];if(t&&!1===t.fallback&&!e)throw new g.NoFallbackError}let T=null;!O||v.isDev||_||(T="/index"===(T=I)?"/":T);let P=!0===v.isDev||!O,k=O&&!P,B=e.method||"GET",F=(0,i.getTracer)(),j=F.getActiveScopeSpan(),q={params:R,prerenderManifest:M,renderOpts:{experimental:{cacheComponents:!!E.experimental.cacheComponents,authInterrupts:!!E.experimental.authInterrupts},supportsDynamicResponse:P,incrementalCache:(0,n.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:null==(b=E.experimental)?void 0:b.cacheLife,isRevalidate:k,waitUntil:a.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,a)=>v.onRequestError(e,t,a,C)},sharedContext:{buildId:y}},U=new s.NodeNextRequest(e),S=new s.NodeNextResponse(t),H=l.NextRequestAdapter.fromNodeNextRequest(U,(0,l.signalFromNodeResponse)(t));try{let o=async r=>v.handle(H,q).finally(()=>{if(!r)return;r.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let a=F.getRootSpanAttributes();if(!a)return;if(a.get("next.span_type")!==u.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${a.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let n=a.get("next.route");if(n){let e=`${B} ${n}`;r.setAttributes({"next.route":n,"http.route":n,"next.span_name":e}),r.updateName(e)}else r.updateName(`${B} ${e.url}`)}),s=async i=>{var s,l;let u=async({previousCacheEntry:r})=>{try{if(!(0,n.getRequestMeta)(e,"minimalMode")&&D&&A&&!r)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let s=await o(i);e.fetchMetrics=q.renderOpts.fetchMetrics;let l=q.renderOpts.pendingWaitUntil;l&&a.waitUntil&&(a.waitUntil(l),l=void 0);let u=q.renderOpts.collectedTags;if(!O)return await (0,p.sendResponse)(U,S,s,q.renderOpts.pendingWaitUntil),null;{let e=await s.blob(),t=(0,c.toNodeOutgoingHttpHeaders)(s.headers);u&&(t[h.NEXT_CACHE_TAGS_HEADER]=u),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==q.renderOpts.collectedRevalidate&&!(q.renderOpts.collectedRevalidate>=h.INFINITE_CACHE)&&q.renderOpts.collectedRevalidate,a=void 0===q.renderOpts.collectedExpire||q.renderOpts.collectedExpire>=h.INFINITE_CACHE?void 0:q.renderOpts.collectedExpire;return{value:{kind:w.CachedRouteKind.APP_ROUTE,status:s.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:a}}}}catch(t){throw(null==r?void 0:r.isStale)&&await v.onRequestError(e,t,{routerKind:"App Router",routePath:f,routeType:"route",revalidateReason:(0,d.getRevalidateReason)({isRevalidate:k,isOnDemandRevalidate:D})},C),t}},g=await v.handleResponse({req:e,nextConfig:E,cacheKey:T,routeKind:r.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:M,isRoutePPREnabled:!1,isOnDemandRevalidate:D,revalidateOnlyGenerated:A,responseGenerator:u,waitUntil:a.waitUntil});if(!O)return null;if((null==g||null==(s=g.value)?void 0:s.kind)!==w.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==g||null==(l=g.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});(0,n.getRequestMeta)(e,"minimalMode")||t.setHeader("x-nextjs-cache",D?"REVALIDATED":g.isMiss?"MISS":g.isStale?"STALE":"HIT"),_&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let b=(0,c.fromNodeOutgoingHttpHeaders)(g.value.headers);return(0,n.getRequestMeta)(e,"minimalMode")&&O||b.delete(h.NEXT_CACHE_TAGS_HEADER),!g.cacheControl||t.getHeader("Cache-Control")||b.get("Cache-Control")||b.set("Cache-Control",(0,m.getCacheControlHeader)(g.cacheControl)),await (0,p.sendResponse)(U,S,new Response(g.value.body,{headers:b,status:g.value.status||200})),null};j?await s(j):await F.withPropagatedContext(e.headers,()=>F.trace(u.BaseServerSpan.handleRequest,{spanName:`${B} ${e.url}`,kind:i.SpanKind.SERVER,attributes:{"http.method":B,"http.target":e.url}},s))}catch(t){if(j||t instanceof g.NoFallbackError||await v.onRequestError(e,t,{routerKind:"App Router",routePath:N,routeType:"route",revalidateReason:(0,d.getRevalidateReason)({isRevalidate:k,isOnDemandRevalidate:D})}),O)throw t;return await (0,p.sendResponse)(U,S,new Response(null,{status:500})),null}}}];

//# sourceMappingURL=%5Broot-of-the-server%5D__ae6e0834._.js.map