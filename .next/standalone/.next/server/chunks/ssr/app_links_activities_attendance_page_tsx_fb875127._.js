module.exports=[1207,a=>{"use strict";a.s(["default",()=>E],1207);var b=a.i(87924),c=a.i(72131),d=a.i(15618),e=a.i(41675),f=a.i(69520),g=a.i(39793),h=a.i(3130),i=a.i(87682),j=a.i(17171),k=a.i(24987),l=a.i(67900),m=a.i(60246),n=a.i(69769);function o({onScopeChange:a}){let[d,e]=c.useState([]),[f,g]=c.useState([]),[o,p]=c.useState([]),[q,r]=c.useState([]),[s,t]=c.useState(""),[u,v]=c.useState(""),[w,x]=c.useState(""),[y,z]=c.useState("");c.useEffect(()=>{A()},[]),c.useEffect(()=>{s?(B(Number(s)),D(Number(s))):(g([]),r([]),v(""),z(""))},[s]),c.useEffect(()=>{u?C(Number(u)):(p([]),x(""))},[u]),c.useEffect(()=>{a({regionId:s,universityId:u,smallGroupId:w,alumniGroupId:y})},[s,u,w,y,a]);let A=async()=>{try{let a=await fetch("/api/regions"),b=await a.json();e(b)}catch(a){console.error("Error fetching regions:",a)}},B=async a=>{try{let b=await fetch(`/api/universities?regionId=${a}`),c=await b.json();g(c)}catch(a){console.error("Error fetching universities:",a)}},C=async a=>{try{let b=await fetch(`/api/small-groups?universityId=${a}`),c=await b.json();p(c)}catch(a){console.error("Error fetching small groups:",a)}},D=async a=>{try{let b=await fetch(`/api/alumni-small-groups?regionId=${a}`),c=await b.json();r(c)}catch(a){console.error("Error fetching alumni groups:",a)}};return(0,b.jsxs)(h.Card,{className:"mb-6",children:[(0,b.jsx)(h.CardHeader,{className:"pb-4",children:(0,b.jsx)(h.CardTitle,{className:"text-lg font-semibold text-foreground",children:"Super Admin Scope Selection"})}),(0,b.jsx)(h.CardContent,{children:(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(j.Label,{htmlFor:"region",className:"text-sm font-medium flex items-center gap-2",children:[(0,b.jsx)(k.MapPin,{className:"h-4 w-4"}),"Filter by Region"]}),(0,b.jsxs)(i.Select,{value:s,onValueChange:a=>{t(a),v(""),x(""),z("")},children:[(0,b.jsx)(i.SelectTrigger,{className:"h-11",children:(0,b.jsx)(i.SelectValue,{placeholder:"Select region"})}),(0,b.jsx)(i.SelectContent,{children:d.map(a=>(0,b.jsx)(i.SelectItem,{value:a.id.toString(),children:a.name},a.id))})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(j.Label,{htmlFor:"university",className:"text-sm font-medium flex items-center gap-2",children:[(0,b.jsx)(l.Building2,{className:"h-4 w-4"}),"Filter by University"]}),(0,b.jsxs)(i.Select,{value:u,onValueChange:a=>{v(a),x("")},disabled:!s,children:[(0,b.jsx)(i.SelectTrigger,{className:"h-11",children:(0,b.jsx)(i.SelectValue,{placeholder:s?"Select university":"Select region first"})}),(0,b.jsx)(i.SelectContent,{children:f.map(a=>(0,b.jsx)(i.SelectItem,{value:a.id.toString(),children:a.name},a.id))})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(j.Label,{htmlFor:"smallGroup",className:"text-sm font-medium flex items-center gap-2",children:[(0,b.jsx)(m.Users,{className:"h-4 w-4"}),"Filter by Small Group"]}),(0,b.jsxs)(i.Select,{value:w,onValueChange:a=>{x(a)},disabled:!u,children:[(0,b.jsx)(i.SelectTrigger,{className:"h-11",children:(0,b.jsx)(i.SelectValue,{placeholder:u?"Select small group":"Select university first"})}),(0,b.jsx)(i.SelectContent,{children:o.map(a=>(0,b.jsx)(i.SelectItem,{value:a.id.toString(),children:a.name},a.id))})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(j.Label,{htmlFor:"alumniGroup",className:"text-sm font-medium flex items-center gap-2",children:[(0,b.jsx)(n.GraduationCap,{className:"h-4 w-4"}),"Filter by Alumni Group"]}),(0,b.jsxs)(i.Select,{value:y,onValueChange:a=>{z(a)},disabled:!s,children:[(0,b.jsx)(i.SelectTrigger,{className:"h-11",children:(0,b.jsx)(i.SelectValue,{placeholder:s?"Select alumni group":"Select region first"})}),(0,b.jsx)(i.SelectContent,{children:q.map(a=>(0,b.jsx)(i.SelectItem,{value:a.id.toString(),children:a.name},a.id))})]})]})]})})]})}var p=a.i(12985),q=a.i(83490),r=a.i(16201);let s=(0,a.i(70106).default)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);var t=a.i(40695);function u({regionId:a,universityId:d,smallGroupId:e,alumniGroupId:g}){let[k,l]=(0,c.useState)(""),[n,o]=(0,c.useState)([]),[p,u]=(0,c.useState)([]),[v,w]=(0,c.useState)({}),[x,y]=(0,c.useState)(!1),[z,A]=(0,c.useState)(null),[B,C]=(0,c.useState)(null),[D,E]=(0,c.useState)(null),F=[{value:"present",label:"Present"},{value:"absent",label:"Absent"},{value:"excused",label:"Excused"}],G=(0,c.useCallback)(async()=>{try{let b="/api/events",c=new URLSearchParams;a&&c.append("regionId",a),d&&c.append("universityId",d),e&&c.append("smallGroupId",e),g&&c.append("alumniGroupId",g),c.toString()&&(b+="?"+c.toString());let f=await q.default.get(b);o(f.data)}catch(a){console.error("Error fetching events:",a)}},[a,d,e,g]),H=(0,c.useCallback)(async()=>{y(!0),u([]),w({}),A(null);try{let b="/api/members",c=new URLSearchParams;e?c.append("smallGroupId",e):g?c.append("alumniGroupId",g):d?c.append("universityId",d):a&&c.append("regionId",a),c.toString()&&(b+="?"+c.toString());let f=await q.default.get(b),h=f.data.members||f.data;if(Array.isArray(h)){u(h);let a={};h.forEach(b=>{a[b.id]="present"}),w(a)}}catch(a){console.error("Error fetching members:",a),A("Failed to load members")}finally{y(!1)}},[a,d,e,g]);(0,c.useEffect)(()=>{G()},[G]),(0,c.useEffect)(()=>{k?H():(u([]),w({}))},[k,H]);let I=async a=>{if(a.preventDefault(),C(null),E(null),!k)return void E("Please select an event to mark attendance for.");if(0===p.length)return void E("No members found for the selected criteria.");let b=p.map(a=>({memberId:a.id,status:v[a.id]||"present",permanentEventId:parseInt(k)}));try{let a=await q.default.post("/api/attendance",b);if(201===a.status&&a.data.results?.every(a=>a.success)){let a=n.find(a=>a.id.toString()===k)?.name||"the selected event",b=p.length;C(`Attendance for ${b} member(s) at "${a}" has been saved successfully!`),E(null),w({}),u([]),l("")}else{let b=a.data.results?.filter(a=>!a.success)?.map(a=>"object"==typeof a.error?Object.values(a.error).flat().join(", "):a.error)?.join(", ")||"Some attendance records could not be saved.";E(b)}}catch(a){E("Failed to save attendance. "+(a.message||""))}};return(0,b.jsxs)(h.Card,{children:[(0,b.jsx)(h.CardHeader,{children:(0,b.jsxs)(h.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(m.Users,{className:"w-5 h-5"}),"Mark Attendance"]})}),(0,b.jsx)(h.CardContent,{children:(0,b.jsxs)("form",{onSubmit:I,className:"space-y-6",children:[(0,b.jsx)("div",{className:"flex flex-wrap gap-4 items-end mb-4",children:(0,b.jsxs)("div",{className:"flex-1 min-w-[180px]",children:[(0,b.jsx)(j.Label,{htmlFor:"eventId",children:"Event *"}),(0,b.jsxs)(i.Select,{value:k,onValueChange:l,children:[(0,b.jsx)(i.SelectTrigger,{className:"h-11",children:(0,b.jsx)(i.SelectValue,{placeholder:"Select event"})}),(0,b.jsx)(i.SelectContent,{children:n.map(a=>(0,b.jsx)(i.SelectItem,{value:a.id.toString(),children:a.name},a.id))})]})]})}),B&&(0,b.jsx)("div",{className:"mb-4 p-4 bg-green-50 border border-green-200 rounded-lg",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)(r.CheckCircle,{className:"h-5 w-5 text-green-400 mr-3"}),(0,b.jsx)("p",{className:"text-sm font-medium text-green-800",children:B})]}),(0,b.jsx)(t.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>{C(null),l("")},children:"Mark Another Attendance"})]})}),D&&(0,b.jsx)("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)(s,{className:"h-5 w-5 text-red-400 mr-3"}),(0,b.jsx)("p",{className:"text-sm font-medium text-red-800",children:D})]})}),x?(0,b.jsxs)("div",{className:"mt-8 p-4 bg-muted/50 border rounded text-muted-foreground text-center",children:[(0,b.jsx)(f.RefreshCw,{className:"w-4 h-4 animate-spin mx-auto mb-2"}),"Loading members..."]}):p.length>0?(0,b.jsxs)("div",{className:"overflow-x-auto mt-8",children:[(0,b.jsxs)("table",{className:"min-w-full divide-y divide-border",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-muted-foreground uppercase",children:"Member"}),(0,b.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-muted-foreground uppercase",children:"Attendance"})]})}),(0,b.jsx)("tbody",{className:"divide-y divide-border",children:p.map(a=>(0,b.jsxs)("tr",{children:[(0,b.jsxs)("td",{className:"px-4 py-2 text-foreground",children:[a.firstname," ",a.secondname]}),(0,b.jsx)("td",{className:"px-4 py-2",children:(0,b.jsx)("div",{className:"flex gap-2",children:F.map(c=>(0,b.jsx)(t.Button,{type:"button",variant:v[a.id]===c.value?"default":"outline",size:"sm",className:`px-3 py-1 text-xs transition ${v[a.id]===c.value?"present"===c.value?"bg-green-500 hover:bg-green-600 text-white":"excused"===c.value?"bg-yellow-500 hover:bg-yellow-600 text-white":"bg-red-500 hover:bg-red-600 text-white":"present"===c.value?"border-green-400 text-green-700 hover:bg-green-50":"excused"===c.value?"border-yellow-400 text-yellow-700 hover:bg-yellow-50":"border-red-400 text-red-700 hover:bg-red-50"}`,onClick:()=>{var b,d;return b=a.id.toString(),d=c.value,void w(a=>({...a,[b]:d}))},children:c.label},c.value))})})]},a.id))})]}),(0,b.jsx)("div",{className:"mt-6 text-right",children:(0,b.jsx)(t.Button,{type:"submit",className:"px-6 py-2",children:"Save Attendance"})})]}):k?(0,b.jsx)("div",{className:"mt-8 p-4 bg-muted/50 border rounded text-muted-foreground text-center",children:"No members found for the selected criteria."}):(0,b.jsx)("div",{className:"mt-8 p-4 bg-blue-50 border border-blue-200 rounded text-blue-600 text-center",children:"Please select an event to mark attendance for."})]})})]})}var v=a.i(87532),w=a.i(84505),x=a.i(92e3),y=a.i(5522),z=a.i(76504);function A({regionId:a,universityId:d,smallGroupId:g,alumniGroupId:k,userScope:l}){let[m,n]=(0,c.useState)([]),[o,p]=(0,c.useState)(!0),[u,A]=(0,c.useState)(null),[B,C]=(0,c.useState)(""),[D,E]=(0,c.useState)(""),[F,G]=(0,c.useState)(""),[H,I]=(0,c.useState)(""),[J,K]=(0,c.useState)(""),[L,M]=(0,c.useState)(null),[N,O]=(0,c.useState)(""),[P,Q]=(0,c.useState)(null),[R,S]=(0,c.useState)(null),[T,U]=(0,c.useState)(!1),[V,W]=(0,c.useState)(!1),[X,Y]=(0,c.useState)([]),[Z,$]=(0,c.useState)([]),[_,aa]=(0,c.useState)([]),[ab,ac]=(0,c.useState)([]),[ad,ae]=(0,c.useState)(""),[af,ag]=(0,c.useState)(""),[ah,ai]=(0,c.useState)(""),[aj,ak]=(0,c.useState)(""),al=[{value:"present",label:"Present"},{value:"absent",label:"Absent"},{value:"excused",label:"Excused"}],am=(0,c.useCallback)(async()=>{try{p(!0),A(null);let b=new URLSearchParams;D&&b.append("eventId",D),F&&b.append("status",F),H&&b.append("dateFrom",H),J&&b.append("dateTo",J),ad&&b.append("regionId",ad),af&&b.append("universityId",af),ah&&b.append("smallGroupId",ah),aj&&b.append("alumniGroupId",aj),a&&b.append("regionId",a),d&&b.append("universityId",d),g&&b.append("smallGroupId",g),k&&b.append("alumniGroupId",k);let c=await q.default.get(`/api/attendance?${b.toString()}`);n(c.data)}catch(a){console.error("Error fetching attendance records:",a),A("Failed to fetch attendance records. Please try again.")}finally{p(!1)}},[D,F,H,J,ad,af,ah,aj,a,d,g,k]),an=(0,c.useCallback)(async()=>{try{let a=await q.default.get("/api/regions");Y(a.data)}catch(a){console.error("Error fetching regions:",a)}},[]),ao=(0,c.useCallback)(async a=>{try{let b=await q.default.get(`/api/universities?regionId=${a}`);$(b.data)}catch(a){console.error("Error fetching universities:",a)}},[]),ap=(0,c.useCallback)(async a=>{try{let b=await q.default.get(`/api/small-groups?universityId=${a}`);aa(b.data)}catch(a){console.error("Error fetching small groups:",a)}},[]),aq=(0,c.useCallback)(async a=>{try{let b=await q.default.get(`/api/alumni-small-groups?regionId=${a}`);ac(b.data)}catch(a){console.error("Error fetching alumni groups:",a)}},[]);(0,c.useEffect)(()=>{an()},[an]),(0,c.useEffect)(()=>{ad?(ao(Number(ad)),aq(Number(ad))):($([]),ac([]),ag(""),ak(""))},[ad,ao,aq]),(0,c.useEffect)(()=>{af?ap(Number(af)):(aa([]),ai(""))},[af,ap]),(0,c.useEffect)(()=>{am()},[am]);let ar=()=>{M(null),O(""),Q(null),S(null)},as=async a=>{Q(null),S(null);try{let b=await q.default.put(`/api/attendance?id=${a.id}`,{status:N});200===b.status?(Q("Attendance updated successfully!"),M(null),O(""),am()):S(b.data.error||"Failed to update attendance.")}catch(a){S("Failed to update attendance. "+(a.message||""))}},at=(0,c.useMemo)(()=>{if(!B)return m;let a=B.toLowerCase();return m.filter(b=>(b.member?.firstname?.toLowerCase().includes(a)??!1)||(b.member?.secondname?.toLowerCase().includes(a)??!1)||(b.permanentministryevent?.name?.toLowerCase().includes(a)??!1)||(b.trainings?.name?.toLowerCase().includes(a)??!1))},[m,B]),au=(0,c.useMemo)(()=>at.length?at.reduce((a,b)=>(a.total++,"present"===b.status?a.present++:"absent"===b.status?a.absent++:"excused"===b.status&&a.excused++,a),{total:0,present:0,absent:0,excused:0}):{total:0,present:0,absent:0,excused:0},[at]),av=async(a="all")=>{U(!0);try{new Date().toISOString().split("T")[0]}catch(a){console.error("Error exporting attendance records:",a),alert("Failed to export attendance records. Please try again.")}finally{U(!1),W(!1)}};return(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)(h.Card,{children:(0,b.jsx)(h.CardContent,{className:"p-4",children:(0,b.jsxs)("div",{className:"flex flex-wrap gap-4 items-end",children:[(0,b.jsxs)("div",{className:"min-w-[180px]",children:[(0,b.jsx)(j.Label,{htmlFor:"eventFilter",children:"Event"}),(0,b.jsxs)(i.Select,{value:D,onValueChange:E,children:[(0,b.jsx)(i.SelectTrigger,{className:"h-11",children:(0,b.jsx)(i.SelectValue,{placeholder:"All Events"})}),(0,b.jsx)(i.SelectContent,{})]})]}),(0,b.jsxs)("div",{className:"min-w-[150px]",children:[(0,b.jsx)(j.Label,{htmlFor:"statusFilter",children:"Status"}),(0,b.jsxs)(i.Select,{value:F,onValueChange:G,children:[(0,b.jsx)(i.SelectTrigger,{className:"h-11",children:(0,b.jsx)(i.SelectValue,{placeholder:"All Statuses"})}),(0,b.jsx)(i.SelectContent,{children:al.map(a=>(0,b.jsx)(i.SelectItem,{value:a.value,children:a.label},a.value))})]})]}),(0,b.jsxs)("div",{className:"min-w-[150px]",children:[(0,b.jsx)(j.Label,{htmlFor:"dateFrom",children:"From Date"}),(0,b.jsx)(y.Input,{type:"date",value:H,onChange:a=>I(a.target.value),className:"h-11"})]}),(0,b.jsxs)("div",{className:"min-w-[150px]",children:[(0,b.jsx)(j.Label,{htmlFor:"dateTo",children:"To Date"}),(0,b.jsx)(y.Input,{type:"date",value:J,onChange:a=>K(a.target.value),className:"h-11"})]}),l?.scope==="superadmin"&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"min-w-[180px]",children:[(0,b.jsx)(j.Label,{htmlFor:"regionFilter",children:"Region"}),(0,b.jsxs)(i.Select,{value:ad,onValueChange:a=>{ae(a),ag(""),ai(""),ak("")},children:[(0,b.jsx)(i.SelectTrigger,{className:"h-11",children:(0,b.jsx)(i.SelectValue,{placeholder:"All Regions"})}),(0,b.jsx)(i.SelectContent,{children:X.map(a=>(0,b.jsx)(i.SelectItem,{value:a.id.toString(),children:a.name},a.id))})]})]}),(0,b.jsxs)("div",{className:"min-w-[180px]",children:[(0,b.jsx)(j.Label,{htmlFor:"universityFilter",children:"University"}),(0,b.jsxs)(i.Select,{value:af,onValueChange:a=>{ag(a),ai("")},disabled:!ad,children:[(0,b.jsx)(i.SelectTrigger,{className:"h-11",children:(0,b.jsx)(i.SelectValue,{placeholder:ad?"All Universities":"Select region first"})}),(0,b.jsx)(i.SelectContent,{children:Z.map(a=>(0,b.jsx)(i.SelectItem,{value:a.id.toString(),children:a.name},a.id))})]})]}),(0,b.jsxs)("div",{className:"min-w-[180px]",children:[(0,b.jsx)(j.Label,{htmlFor:"smallGroupFilter",children:"Small Group"}),(0,b.jsxs)(i.Select,{value:ah,onValueChange:a=>{ai(a)},disabled:!af,children:[(0,b.jsx)(i.SelectTrigger,{className:"h-11",children:(0,b.jsx)(i.SelectValue,{placeholder:af?"All Small Groups":"Select university first"})}),(0,b.jsx)(i.SelectContent,{children:_.map(a=>(0,b.jsx)(i.SelectItem,{value:a.id.toString(),children:a.name},a.id))})]})]}),(0,b.jsxs)("div",{className:"min-w-[180px]",children:[(0,b.jsx)(j.Label,{htmlFor:"alumniGroupFilter",children:"Alumni Group"}),(0,b.jsxs)(i.Select,{value:aj,onValueChange:a=>{ak(a)},disabled:!ad,children:[(0,b.jsx)(i.SelectTrigger,{className:"h-11",children:(0,b.jsx)(i.SelectValue,{placeholder:ad?"All Alumni Groups":"Select region first"})}),(0,b.jsx)(i.SelectContent,{children:ab.map(a=>(0,b.jsx)(i.SelectItem,{value:a.id.toString(),children:a.name},a.id))})]})]})]}),(0,b.jsxs)("div",{className:"flex-1 min-w-[200px]",children:[(0,b.jsx)(j.Label,{htmlFor:"search",children:"Search"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(v.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),(0,b.jsx)(y.Input,{type:"text",placeholder:"Search by member or event name...",value:B,onChange:a=>C(a.target.value),className:"pl-10 h-11"})]})]}),(0,b.jsxs)("div",{className:"flex items-end gap-2",children:[(0,b.jsx)(t.Button,{type:"button",variant:"outline",onClick:()=>{E(""),G(""),I(""),K(""),C(""),ae(""),ag(""),ai(""),ak("")},className:"h-11",children:"Clear Filters"}),(0,b.jsxs)(z.DropdownMenu,{open:V,onOpenChange:W,children:[(0,b.jsx)(z.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsxs)(t.Button,{variant:"outline",className:"flex items-center gap-2 h-11",disabled:T,children:[(0,b.jsx)(w.Download,{className:"w-4 h-4"}),T?"Exporting...":"Export Document",(0,b.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),(0,b.jsxs)(z.DropdownMenuContent,{align:"end",className:"w-48",children:[(0,b.jsx)(z.DropdownMenuItem,{onClick:()=>av("all"),children:"Export All Records"}),(0,b.jsx)(z.DropdownMenuItem,{onClick:()=>av("present"),children:"Export Present Only"}),(0,b.jsx)(z.DropdownMenuItem,{onClick:()=>av("absent"),children:"Export Absent Only"}),(0,b.jsx)(z.DropdownMenuItem,{onClick:()=>av("excused"),children:"Export Excused Only"})]})]})]})]})})}),at.length>0&&(0,b.jsx)(h.Card,{children:(0,b.jsx)(h.CardContent,{className:"p-4",children:(0,b.jsxs)("div",{className:"flex flex-wrap gap-6 items-center",children:[(0,b.jsxs)("div",{className:"text-sm font-medium text-muted-foreground",children:["Total Records: ",(0,b.jsx)("span",{className:"font-bold text-foreground",children:au.total})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),(0,b.jsxs)("span",{className:"text-sm text-muted-foreground",children:["Present: ",(0,b.jsx)("span",{className:"font-semibold text-green-600",children:au.present})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),(0,b.jsxs)("span",{className:"text-sm text-muted-foreground",children:["Absent: ",(0,b.jsx)("span",{className:"font-semibold text-red-600",children:au.absent})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"w-3 h-3 bg-yellow-500 rounded-full"}),(0,b.jsxs)("span",{className:"text-sm text-muted-foreground",children:["Excused: ",(0,b.jsx)("span",{className:"font-semibold text-yellow-600",children:au.excused})]})]}),au.total>0&&(0,b.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Attendance Rate: ",(0,b.jsxs)("span",{className:"font-semibold text-blue-600",children:[Math.round(au.present/au.total*100),"%"]})]})]})})}),(0,b.jsx)(h.Card,{children:(0,b.jsxs)(h.CardContent,{className:"p-0",children:[o?(0,b.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,b.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground",children:[(0,b.jsx)(f.RefreshCw,{className:"w-4 h-4 animate-spin"}),(0,b.jsx)("span",{children:"Loading attendance records..."})]})}):u?(0,b.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)(x.AlertCircle,{className:"w-8 h-8 text-destructive mx-auto mb-2"}),(0,b.jsx)("div",{className:"text-destructive text-lg mb-2",children:"Error loading attendance records"}),(0,b.jsx)("p",{className:"text-muted-foreground mb-4",children:u}),(0,b.jsx)(t.Button,{onClick:am,children:"Retry"})]})}):at&&0!==at.length?(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"w-full",children:[(0,b.jsx)("thead",{className:"bg-muted/50 border-b border-border",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Member"}),(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Event"}),(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Status"}),(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Date"})]})}),(0,b.jsx)("tbody",{className:"bg-card divide-y divide-border",children:at.map(a=>{var c;return(0,b.jsxs)("tr",{className:"hover:bg-muted/50",children:[(0,b.jsx)("td",{className:"px-6 py-4 text-sm font-medium text-foreground",children:a.member?`${a.member.firstname} ${a.member.secondname}`:"N/A"}),(0,b.jsx)("td",{className:"px-6 py-4 text-sm text-muted-foreground",children:a.permanentministryevent?.name||a.trainings?.name||"N/A"}),(0,b.jsx)("td",{className:"px-6 py-4 text-sm",children:L===a.id?(0,b.jsxs)("div",{className:"flex gap-2",children:[al.map(a=>(0,b.jsx)(t.Button,{type:"button",variant:N===a.value?"default":"outline",size:"sm",className:`px-3 py-1 text-xs ${N===a.value?"present"===a.value?"bg-green-500 hover:bg-green-600 text-white":"excused"===a.value?"bg-yellow-500 hover:bg-yellow-600 text-white":"bg-red-500 hover:bg-red-600 text-white":"present"===a.value?"border-green-400 text-green-700 hover:bg-green-50":"excused"===a.value?"border-yellow-400 text-yellow-700 hover:bg-yellow-50":"border-red-400 text-red-700 hover:bg-red-50"}`,onClick:()=>O(a.value),children:a.label},a.value)),(0,b.jsx)(t.Button,{type:"button",size:"sm",onClick:()=>as(a),className:"ml-2 px-3 py-1 bg-green-600 hover:bg-green-700 text-white text-xs",children:"Save"}),(0,b.jsx)(t.Button,{type:"button",variant:"outline",size:"sm",onClick:ar,className:"px-3 py-1 text-xs",children:"Cancel"})]}):(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:`px-3 py-1 rounded-full text-xs font-semibold ${"present"===a.status?"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400":"excused"===a.status?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-400":"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400"}`,children:a.status.charAt(0).toUpperCase()+a.status.slice(1)}),(0,b.jsx)(t.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>{M(a.id),O(a.status),Q(null),S(null)},className:"px-2 py-1 text-xs",children:"Edit"})]})}),(0,b.jsx)("td",{className:"px-6 py-4 text-sm text-muted-foreground",children:(c=a.recordedAt)?new Date(c).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A"})]},a.id)})})]})}):(0,b.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)(e.Calendar,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),(0,b.jsx)("div",{className:"text-muted-foreground text-lg mb-2",children:"No attendance records found"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:B?`No results for "${B}". Try a different search term.`:"There are no attendance records to display at the moment."})]})}),P&&(0,b.jsx)("div",{className:"p-4 bg-green-50 border-t border-green-200",children:(0,b.jsxs)("div",{className:"flex items-center text-green-800",children:[(0,b.jsx)(r.CheckCircle,{className:"w-4 h-4 mr-2"}),P]})}),R&&(0,b.jsx)("div",{className:"p-4 bg-red-50 border-t border-red-200",children:(0,b.jsxs)("div",{className:"flex items-center text-red-800",children:[(0,b.jsx)(s,{className:"w-4 h-4 mr-2"}),R]})})]})})]})}var B=a.i(42247),C=a.i(7379),D=a.i(14727);function E(){let[a,i]=(0,c.useState)("mark"),{userScope:j,loading:k,getDefaultValues:l}=(0,p.useUserScope)(),[m,n]=(0,c.useState)(""),[q,r]=(0,c.useState)(""),[s,v]=(0,c.useState)(""),[w,x]=(0,c.useState)("");return(0,c.useEffect)(()=>{if(j&&!k){let a=l();n(a.regionId||""),r(a.universityId||""),v(a.smallGroupId||""),x(a.alumniGroupId||"")}},[j,k,l]),(0,b.jsxs)(D.SidebarProvider,{children:[(0,b.jsx)(g.AppSidebar,{}),(0,b.jsxs)(D.SidebarInset,{children:[(0,b.jsx)("header",{className:"flex h-16 shrink-0 items-center gap-2 transition-[width,height] ease-linear group-has-data-[collapsible=icon]/sidebar-wrapper:h-12",children:(0,b.jsxs)("div",{className:"flex items-center gap-2 px-4",children:[(0,b.jsx)(D.SidebarTrigger,{className:"-ml-1"}),(0,b.jsx)(C.Separator,{orientation:"vertical",className:"mr-2 data-[orientation=vertical]:h-4"}),(0,b.jsx)(B.Breadcrumb,{children:(0,b.jsxs)(B.BreadcrumbList,{children:[(0,b.jsx)(B.BreadcrumbItem,{className:"hidden md:block",children:(0,b.jsx)(B.BreadcrumbLink,{href:"/dashboard",children:"Dashboard"})}),(0,b.jsx)(B.BreadcrumbSeparator,{className:"hidden md:block"}),(0,b.jsx)(B.BreadcrumbItem,{children:(0,b.jsx)(B.BreadcrumbLink,{href:"/links/activities",children:"Activities"})}),(0,b.jsx)(B.BreadcrumbSeparator,{}),(0,b.jsx)(B.BreadcrumbItem,{children:(0,b.jsx)(B.BreadcrumbPage,{children:"Attendance Tracking"})})]})})]})}),(0,b.jsx)("div",{className:"flex flex-1 flex-col gap-4 p-2 sm:p-4 pt-0",children:(0,b.jsxs)("div",{className:"max-w-7xl mx-auto w-full",children:[(0,b.jsxs)("div",{className:"mb-4 sm:mb-6 lg:mb-8",children:[(0,b.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-foreground mb-1 sm:mb-2",children:"Attendance Tracking"}),(0,b.jsx)("p",{className:"text-sm sm:text-base text-muted-foreground",children:"Manage attendance records and mark attendance for events"})]}),(0,b.jsxs)("div",{className:"flex gap-2 mb-6",children:[(0,b.jsxs)(t.Button,{variant:"mark"===a?"default":"outline",onClick:()=>i("mark"),className:"flex items-center gap-2",children:[(0,b.jsx)(d.Plus,{className:"w-4 h-4"}),"Mark Attendance"]}),(0,b.jsxs)(t.Button,{variant:"view"===a?"default":"outline",onClick:()=>i("view"),className:"flex items-center gap-2",children:[(0,b.jsx)(e.Calendar,{className:"w-4 h-4"}),"View Attendance Records"]})]}),j?.scope==="superadmin"&&(0,b.jsx)(o,{onScopeChange:a=>{n(a.regionId||""),r(a.universityId||""),v(a.smallGroupId||""),x(a.alumniGroupId||"")}}),j&&"superadmin"!==j.scope&&!k&&(0,b.jsx)(h.Card,{className:"mb-4",children:(0,b.jsx)(h.CardContent,{className:"p-4",children:(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,b.jsx)("span",{children:"Current Scope:"}),(0,b.jsx)("span",{className:"font-medium text-foreground capitalize",children:j.scope}),j.region&&(0,b.jsxs)("span",{children:["• ",j.region.name]}),j.university&&(0,b.jsxs)("span",{children:["• ",j.university.name]}),j.smallGroup&&(0,b.jsxs)("span",{children:["• ",j.smallGroup.name]}),j.alumniGroup&&(0,b.jsxs)("span",{children:["• ",j.alumniGroup.name]})]})})}),k&&(0,b.jsx)(h.Card,{className:"mb-4",children:(0,b.jsx)(h.CardContent,{className:"p-4",children:(0,b.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground",children:[(0,b.jsx)(f.RefreshCw,{className:"w-4 h-4 animate-spin"}),(0,b.jsx)("span",{children:"Loading user scope..."})]})})}),"mark"===a&&!k&&(0,b.jsx)(u,{regionId:m,universityId:q,smallGroupId:s,alumniGroupId:w}),"view"===a&&!k&&(0,b.jsx)(A,{regionId:m,universityId:q,smallGroupId:s,alumniGroupId:w,userScope:j})]})})]})]})}}];

//# sourceMappingURL=app_links_activities_attendance_page_tsx_fb875127._.js.map